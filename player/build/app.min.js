/*

uses binary base64 library by beatgammit
https://github.com/beatgammit/base64-js
MIT licensed
*/
var PS={};
(function(a){function b(h,e){var k=this;k.audio=e;window.addEventListener("touchstart",function(){h.resume()});k.playFrom=function(d,m){if(d<k.audio.duration){var q=h.createBufferSource(e);q.buffer=e;q.connect(h.destination);k.stop=function(){q.stop()};q.start(0,d)}else k.stop=function(){};m()}}var c=function(){function h(p){var C=p.length;if(0<C%4)throw Error("Invalid string. Length must be a multiple of 4");p=p.indexOf("=");-1===p&&(p=C);return[p,p===C?0:4-p%4]}function e(p,C,t){for(var v=[],G=
C;G<t;G+=3)C=(p[G]<<16&16711680)+(p[G+1]<<8&65280)+(p[G+2]&255),v.push(k[C>>18&63]+k[C>>12&63]+k[C>>6&63]+k[C&63]);return v.join("")}for(var k=[],d=[],m="undefined"!==typeof Uint8Array?Uint8Array:Array,q=0;64>q;++q)k[q]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[q],d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(q)]=q;d[45]=62;d[95]=63;return{byteLength:function(p){p=h(p);var C=p[1];return 3*(p[0]+C)/4-C},toByteArray:function(p){var C=h(p);var t=
C[0];C=C[1];for(var v=new m(3*(t+C)/4-C),G=0,D=0<C?t-4:t,n=0;n<D;n+=4)t=d[p.charCodeAt(n)]<<18|d[p.charCodeAt(n+1)]<<12|d[p.charCodeAt(n+2)]<<6|d[p.charCodeAt(n+3)],v[G++]=t>>16&255,v[G++]=t>>8&255,v[G++]=t&255;2===C&&(t=d[p.charCodeAt(n)]<<2|d[p.charCodeAt(n+1)]>>4,v[G++]=t&255);1===C&&(t=d[p.charCodeAt(n)]<<10|d[p.charCodeAt(n+1)]<<4|d[p.charCodeAt(n+2)]>>2,v[G++]=t>>8&255,v[G++]=t&255);return v},fromByteArray:function(p){for(var C=p.length,t=C%3,v=[],G=0,D=C-t;G<D;G+=16383)v.push(e(p,G,G+16383>
D?D:G+16383));1===t?(p=p[C-1],v.push(k[p>>2]+k[p<<4&63]+"==")):2===t&&(p=(p[C-2]<<8)+p[C-1],v.push(k[p>>10]+k[p>>4&63]+k[p<<2&63]+"="));return v.join("")}}}();a.loadAudio=function(h){return function(){var e=new (window.AudioContext||window.webkitAudioContext||!1),k=c.toByteArray(window.audioBin);e.decodeAudioData(k.buffer,function(d){h(new b(e,d))()},function(){})}};a.playFrom=function(h){return function(e){return function(k){return function(){h.playFrom(e,k)}}}};a.stop=function(h){return function(){h.stop()}}})(PS.Audio=
PS.Audio||{});(function(a){a.Audio=a.Audio||{};var b=a.Audio;a=a.Audio;b.loadAudio=a.loadAudio;b.playFrom=a.playFrom;b.stop=a.stop})(PS);(function(a){a.arrayMap=function(b){return function(c){for(var h=c.length,e=Array(h),k=0;k<h;k++)e[k]=b(c[k]);return e}}})(PS["Data.Functor"]=PS["Data.Functor"]||{});
(function(a){a["Control.Semigroupoid"]=a["Control.Semigroupoid"]||{};a=a["Control.Semigroupoid"];var b=function(h){this.compose=h},c=new b(function(h){return function(e){return function(k){return h(e(k))}}});a.compose=function(h){return h.compose};a.Semigroupoid=b;a.semigroupoidFn=c})(PS);(function(a){a["Data.Function"]=a["Data.Function"]||{};a=a["Data.Function"];a.flip=function(b){return function(c){return function(h){return b(h)(c)}}};a["const"]=function(b){return function(c){return b}}})(PS);
(function(a){a.unit={}})(PS["Data.Unit"]=PS["Data.Unit"]||{});(function(a){a["Data.Unit"]=a["Data.Unit"]||{};a["Data.Unit"].unit=a["Data.Unit"].unit})(PS);
(function(a){a["Data.Functor"]=a["Data.Functor"]||{};var b=a["Data.Functor"],c=a["Data.Functor"],h=a["Control.Semigroupoid"],e=a["Data.Function"],k=a["Data.Unit"];a=function(d){this.map=d};h=new a(h.compose(h.semigroupoidFn));c=new a(c.arrayMap);b.Functor=a;b.map=function(d){return d.map};b["void"]=function(d){return(0,d.map)(e["const"](k.unit))};b.functorFn=h;b.functorArray=c})(PS);
(function(a){a.concatString=function(b){return function(c){return b+c}};a.concatArray=function(b){return function(c){return 0===b.length?c:0===c.length?b:b.concat(c)}}})(PS["Data.Semigroup"]=PS["Data.Semigroup"]||{});
(function(a){a["Data.Semigroup"]=a["Data.Semigroup"]||{};var b=a["Data.Semigroup"],c=a["Data.Semigroup"],h=a["Data.Unit"];a=function(d){this.append=d};var e=new a(function(d){return function(m){return h.unit}}),k=new a(c.concatString);c=new a(c.concatArray);b.Semigroup=a;b.append=function(d){return d.append};b.semigroupString=k;b.semigroupUnit=e;b.semigroupArray=c})(PS);
(function(a){a["Control.Alt"]=a["Control.Alt"]||{};var b=a["Control.Alt"],c=a["Data.Functor"],h=a["Data.Semigroup"];a=function(e,k){this.Functor0=e;this.alt=k};h=new a(function(){return c.functorArray},h.append(h.semigroupArray));b.Alt=a;b.alt=function(e){return e.alt};b.altArray=h})(PS);
(function(a){a.arrayApply=function(b){return function(c){for(var h=b.length,e=c.length,k=Array(h*e),d=0,m=0;m<h;m++)for(var q=b[m],p=0;p<e;p++)k[d++]=q(c[p]);return k}}})(PS["Control.Apply"]=PS["Control.Apply"]||{});
(function(a){a["Control.Category"]=a["Control.Category"]||{};var b=a["Control.Category"],c=a["Control.Semigroupoid"];a=function(e,k){this.Semigroupoid0=e;this.identity=k};var h=new a(function(){return c.semigroupoidFn},function(e){return e});b.Category=a;b.identity=function(e){return e.identity};b.categoryFn=h})(PS);
(function(a){a["Control.Apply"]=a["Control.Apply"]||{};var b=a["Control.Apply"],c=a["Control.Category"],h=a["Data.Function"],e=a["Data.Functor"],k=function(d,m){this.Functor0=d;this.apply=m};a=new k(function(){return e.functorArray},a["Control.Apply"].arrayApply);b.Apply=k;b.apply=function(d){return d.apply};b.applySecond=function(d){return function(m){return function(q){return(0,d.apply)(e.map(d.Functor0())(h["const"](c.identity(c.categoryFn)))(m))(q)}}};b.lift2=function(d){return function(m){return function(q){return function(p){return(0,d.apply)(e.map(d.Functor0())(m)(q))(p)}}}};
b.applyArray=a})(PS);
(function(a){a["Control.Applicative"]=a["Control.Applicative"]||{};var b=a["Control.Applicative"],c=a["Control.Apply"],h=a["Data.Unit"];a=function(k,d){this.Apply0=k;this.pure=d};var e=new a(function(){return c.applyArray},function(k){return[k]});b.Applicative=a;b.pure=function(k){return k.pure};b.liftA1=function(k){return function(d){return function(m){return c.apply(k.Apply0())((0,k.pure)(d))(m)}}};b.unless=function(k){return function(d){return function(m){if(!d)return m;if(d)return(0,k.pure)(h.unit);throw Error("Control.Applicative (62:1-62:65): "+
[d.constructor.name,m.constructor.name]);}}};b.when=function(k){return function(d){return function(m){if(d)return m;if(!d)return(0,k.pure)(h.unit);throw Error("Control.Applicative (57:1-57:63): "+[d.constructor.name,m.constructor.name]);}}};b.applicativeArray=e})(PS);
(function(a){a["Control.Plus"]=a["Control.Plus"]||{};var b=a["Control.Plus"],c=a["Control.Alt"];a=function(e,k){this.Alt0=e;this.empty=k};var h=new a(function(){return c.altArray},[]);b.Plus=a;b.empty=function(e){return e.empty};b.plusArray=h})(PS);
(function(a){a["Control.Alternative"]=a["Control.Alternative"]||{};var b=a["Control.Alternative"],c=a["Control.Applicative"],h=a["Control.Plus"];a=function(k,d){this.Applicative0=k;this.Plus1=d};var e=new a(function(){return c.applicativeArray},function(){return h.plusArray});b.Alternative=a;b.alternativeArray=e})(PS);
(function(a){a.arrayBind=function(b){return function(c){for(var h=[],e=0,k=b.length;e<k;e++)Array.prototype.push.apply(h,c(b[e]));return h}}})(PS["Control.Bind"]=PS["Control.Bind"]||{});
(function(a){a["Control.Bind"]=a["Control.Bind"]||{};var b=a["Control.Bind"],c=a["Control.Apply"],h=function(d){this.discard=d},e=function(d,m){this.Apply0=d;this.bind=m};a=new e(function(){return c.applyArray},a["Control.Bind"].arrayBind);var k=new h(function(d){return d.bind});b.Bind=e;b.bind=function(d){return d.bind};b.Discard=h;b.discard=function(d){return d.discard};b.bindArray=a;b.discardUnit=k})(PS);
(function(a){a["Control.Monad"]=a["Control.Monad"]||{};var b=a["Control.Monad"],c=a["Control.Applicative"],h=a["Control.Bind"];a=function(k,d){this.Applicative0=k;this.Bind1=d};var e=new a(function(){return c.applicativeArray},function(){return h.bindArray});b.Monad=a;b.ap=function(k){return function(d){return function(m){return h.bind(k.Bind1())(d)(function(q){return h.bind(k.Bind1())(m)(function(p){return c.pure(k.Applicative0())(q(p))})})}}};b.monadArray=e})(PS);
(function(a){a["Control.Monad.Cont.Trans"]=a["Control.Monad.Cont.Trans"]||{};var b=a["Control.Monad.Cont.Trans"],c=a["Control.Applicative"],h=a["Control.Apply"],e=a["Control.Bind"],k=a["Control.Monad"],d=a["Data.Functor"],m=function(t){return new d.Functor(function(v){return function(G){return function(D){return G(function(n){return D(v(n))})}}})},q=function(t){return new h.Apply(function(){return m(t.Functor0())},function(v){return function(G){return function(D){return v(function(n){return G(function(y){return D(n(y))})})}}})},
p=function(t){return new e.Bind(function(){return q(t.Apply0())},function(v){return function(G){return function(D){return v(function(n){return G(n)(D)})}}})},C=function(t){return new c.Applicative(function(){return q(t.Apply0())},function(v){return function(G){return G(v)}})};b.ContT=function(t){return t};b.runContT=function(t){return function(v){return t(v)}};b.functorContT=m;b.applyContT=q;b.applicativeContT=C;b.bindContT=p;b.monadContT=function(t){return new k.Monad(function(){return C(t.Applicative0())},
function(){return p(t.Bind1())})}})(PS);(function(a){a["Control.Monad.Error.Class"]=a["Control.Monad.Error.Class"]||{};a=a["Control.Monad.Error.Class"];a.throwError=function(b){return b.throwError};a.MonadThrow=function(b,c){this.Monad0=b;this.throwError=c}})(PS);
(function(a){a["Data.Either"]=a["Data.Either"]||{};var b=a["Data.Either"],c=a["Control.Applicative"],h=a["Control.Apply"],e=a["Data.Functor"],k=function(){function p(C){this.value0=C}p.create=function(C){return new p(C)};return p}(),d=function(){function p(C){this.value0=C}p.create=function(C){return new p(C)};return p}(),m=new e.Functor(function(p){return function(C){if(C instanceof k)return new k(C.value0);if(C instanceof d)return new d(p(C.value0));throw Error("Data.Either (38:8-38:52): "+[C.constructor.name]);
}}),q=new h.Apply(function(){return m},function(p){return function(C){if(p instanceof k)return new k(p.value0);if(p instanceof d)return e.map(m)(p.value0)(C);throw Error("Data.Either (82:1-82:41): "+[p.constructor.name,C.constructor.name]);}});a=new c.Applicative(function(){return q},d.create);b.Left=k;b.Right=d;b.either=function(p){return function(C){return function(t){if(t instanceof k)return p(t.value0);if(t instanceof d)return C(t.value0);throw Error("Data.Either (238:1-238:64): "+[p.constructor.name,
C.constructor.name,t.constructor.name]);}}};b.functorEither=m;b.applyEither=q;b.applicativeEither=a})(PS);
(function(a){a["Control.Monad.Except.Trans"]=a["Control.Monad.Except.Trans"]||{};var b=a["Control.Monad.Except.Trans"],c=a["Control.Applicative"],h=a["Control.Apply"],e=a["Control.Bind"],k=a["Control.Monad"],d=a["Control.Monad.Error.Class"],m=a["Data.Either"],q=a["Data.Functor"],p=function(n){return function(y){return n(y)}},C=function(n){return new q.Functor(function(y){return p(q.map(n)(q.map(m.functorEither)(y)))})},t=function(n){return new k.Monad(function(){return D(n)},function(){return v(n)})},
v=function(n){return new e.Bind(function(){return G(n)},function(y){return function(K){return e.bind(n.Bind1())(y)(m.either(function(g){return c.pure(n.Applicative0())(m.Left.create(g))})(function(g){return K(g)}))}})},G=function(n){return new h.Apply(function(){return C(n.Bind1().Apply0().Functor0())},k.ap(t(n)))},D=function(n){return new c.Applicative(function(){return G(n)},function(y){return c.pure(n.Applicative0())(m.Right.create(y))})};b.ExceptT=function(n){return n};b.runExceptT=function(n){return n};
b.mapExceptT=p;b.functorExceptT=C;b.applyExceptT=G;b.applicativeExceptT=D;b.bindExceptT=v;b.monadExceptT=t;b.monadThrowExceptT=function(n){return new d.MonadThrow(function(){return t(n)},function(y){return c.pure(n.Applicative0())(m.Left.create(y))})}})(PS);(function(a){a.boolConj=function(b){return function(c){return b&&c}};a.boolDisj=function(b){return function(c){return b||c}};a.boolNot=function(b){return!b}})(PS["Data.HeytingAlgebra"]=PS["Data.HeytingAlgebra"]||{});
(function(a){a["Data.HeytingAlgebra"]=a["Data.HeytingAlgebra"]||{};var b=a["Data.HeytingAlgebra"];a=a["Data.HeytingAlgebra"];var c=function(e,k,d,m,q,p){this.conj=e;this.disj=k;this.ff=d;this.implies=m;this.not=q;this.tt=p},h=new c(a.boolConj,a.boolDisj,!1,function(e){return function(k){return(0,h.disj)((0,h.not)(e))(k)}},a.boolNot,!0);b.HeytingAlgebra=c;b.tt=function(e){return e.tt};b.ff=function(e){return e.ff};b.implies=function(e){return e.implies};b.conj=function(e){return e.conj};b.disj=function(e){return e.disj};
b.not=function(e){return e.not};b.heytingAlgebraBoolean=h})(PS);(function(a){a["Data.Monoid"]=a["Data.Monoid"]||{};var b=a["Data.Monoid"],c=a["Data.Semigroup"],h=function(k,d){this.Semigroup0=k;this.mempty=d};a=new h(function(){return c.semigroupUnit},a["Data.Unit"].unit);var e=new h(function(){return c.semigroupString},"");b.Monoid=h;b.mempty=function(k){return k.mempty};b.monoidUnit=a;b.monoidString=e})(PS);
(function(a){a["Data.Monoid.Disj"]=a["Data.Monoid.Disj"]||{};var b=a["Data.Monoid.Disj"],c=a["Data.HeytingAlgebra"],h=a["Data.Monoid"],e=a["Data.Semigroup"],k=function(d){return new e.Semigroup(function(m){return function(q){return c.disj(d)(m)(q)}})};b.Disj=function(d){return d};b.semigroupDisj=k;b.monoidDisj=function(d){return new h.Monoid(function(){return k(d)},c.ff(d))}})(PS);
(function(a){a["Data.Monoid.Dual"]=a["Data.Monoid.Dual"]||{};var b=a["Data.Monoid.Dual"],c=a["Data.Monoid"],h=a["Data.Semigroup"],e=function(k){return new h.Semigroup(function(d){return function(m){return h.append(k)(m)(d)}})};b.Dual=function(k){return k};b.semigroupDual=e;b.monoidDual=function(k){return new c.Monoid(function(){return e(k.Semigroup0())},c.mempty(k))}})(PS);
(function(a){a["Data.Monoid.Endo"]=a["Data.Monoid.Endo"]||{};var b=a["Data.Monoid.Endo"],c=a["Control.Category"],h=a["Control.Semigroupoid"],e=a["Data.Monoid"],k=a["Data.Semigroup"],d=function(m){return new k.Semigroup(function(q){return function(p){return h.compose(m)(q)(p)}})};b.Endo=function(m){return m};b.semigroupEndo=d;b.monoidEndo=function(m){return new e.Monoid(function(){return d(m.Semigroupoid0())},c.identity(m))}})(PS);
(function(a){a["Data.Newtype"]=a["Data.Newtype"]||{};var b=a["Data.Newtype"],c=a["Data.Functor"],h=a["Data.Monoid.Disj"],e=a["Data.Monoid.Dual"],k=function(d,m){this.unwrap=d;this.wrap=m};a=new k(function(d){return d},a["Data.Monoid.Endo"].Endo);e=new k(function(d){return d},e.Dual);h=new k(function(d){return d},h.Disj);b.unwrap=function(d){return d.unwrap};b.wrap=function(d){return d.wrap};b.Newtype=k;b.alaF=function(d){return function(m){return function(q){return function(p){return function(C){return function(t){return function(v){return c.map(m)(p.unwrap)(t(c.map(d)(q.wrap)(v)))}}}}}}};
b.over=function(d){return function(m){return function(q){return function(p){return function(C){return(0,m.wrap)(p((0,d.unwrap)(C)))}}}}};b.newtypeDisj=h;b.newtypeDual=e;b.newtypeEndo=a})(PS);
(function(a){a["Data.Identity"]=a["Data.Identity"]||{};var b=a["Data.Identity"],c=a["Control.Applicative"],h=a["Control.Apply"],e=a["Control.Bind"],k=a["Control.Monad"],d=a["Data.Functor"],m=function(v){return v};a=new a["Data.Newtype"].Newtype(function(v){return v},m);var q=new d.Functor(function(v){return function(G){return v(G)}}),p=new h.Apply(function(){return q},function(v){return function(G){return v(G)}}),C=new e.Bind(function(){return p},function(v){return function(G){return G(v)}}),t=new c.Applicative(function(){return p},
m);c=new k.Monad(function(){return t},function(){return C});b.Identity=m;b.newtypeIdentity=a;b.functorIdentity=q;b.applyIdentity=p;b.applicativeIdentity=t;b.bindIdentity=C;b.monadIdentity=c})(PS);(function(a){a["Control.Monad.Except"]=a["Control.Monad.Except"]||{};var b=a["Control.Monad.Except"],c=a["Control.Monad.Except.Trans"],h=a["Data.Identity"],e=a["Data.Newtype"];b.runExcept=function(k){return e.unwrap(h.newtypeIdentity)(c.runExceptT(k))};b.mapExcept=function(k){return c.mapExceptT(function(d){return h.Identity(k(e.unwrap(h.newtypeIdentity)(d)))})}})(PS);
(function(a){a.map_=function(b){return function(c){return function(){return b(c())}}};a.pure_=function(b){return function(){return b}};a.bind_=function(b){return function(c){return function(){return c(b())()}}}})(PS["Control.Monad.ST.Internal"]=PS["Control.Monad.ST.Internal"]||{});
(function(a){a["Control.Monad.ST.Internal"]=a["Control.Monad.ST.Internal"]||{};var b=a["Control.Monad.ST.Internal"],c=a["Control.Monad.ST.Internal"],h=a["Control.Applicative"],e=a["Control.Apply"],k=a["Control.Bind"],d=a["Control.Monad"],m=new a["Data.Functor"].Functor(c.map_);a=new d.Monad(function(){return C},function(){return q});var q=new k.Bind(function(){return p},c.bind_),p=new e.Apply(function(){return m},d.ap(a)),C=new h.Applicative(function(){return p},c.pure_);b.functorST=m;b.applyST=p;
b.applicativeST=C;b.bindST=q;b.monadST=a})(PS);(function(a){a["Data.Tuple"]=a["Data.Tuple"]||{};var b=a["Data.Tuple"];a=a["Data.Functor"];var c=function(){function h(e,k){this.value0=e;this.value1=k}h.create=function(e){return function(k){return new h(e,k)}};return h}();a=new a.Functor(function(h){return function(e){return new c(e.value0,h(e.value1))}});b.Tuple=c;b.fst=function(h){return h.value0};b.snd=function(h){return h.value1};b.functorTuple=a})(PS);
(function(a){a["Control.Monad.State.Class"]=a["Control.Monad.State.Class"]||{};var b=a["Control.Monad.State.Class"],c=a["Data.Tuple"];b.state=function(h){return h.state};b.MonadState=function(h,e){this.Monad0=h;this.state=e};b.get=function(h){return(0,h.state)(function(e){return new c.Tuple(e,e)})};b.modify=function(h){return function(e){return(0,h.state)(function(k){k=e(k);return new c.Tuple(k,k)})}}})(PS);
(function(a){a["Control.Monad.Trans.Class"]=a["Control.Monad.Trans.Class"]||{};a=a["Control.Monad.Trans.Class"];a.lift=function(b){return b.lift};a.MonadTrans=function(b){this.lift=b}})(PS);
(function(a){a["Control.Monad.State.Trans"]=a["Control.Monad.State.Trans"]||{};var b=a["Control.Monad.State.Trans"],c=a["Control.Applicative"],h=a["Control.Apply"],e=a["Control.Bind"],k=a["Control.Monad"],d=a["Control.Monad.State.Class"],m=a["Data.Functor"],q=a["Data.Tuple"];a=new a["Control.Monad.Trans.Class"].MonadTrans(function(D){return function(n){return function(y){return e.bind(D.Bind1())(n)(function(K){return c.pure(D.Applicative0())(new q.Tuple(K,y))})}}});var p=function(D){return new m.Functor(function(n){return function(y){return function(K){return m.map(D)(function(g){return new q.Tuple(n(g.value0),
g.value1)})(y(K))}}})},C=function(D){return new k.Monad(function(){return G(D)},function(){return t(D)})},t=function(D){return new e.Bind(function(){return v(D)},function(n){return function(y){return function(K){return e.bind(D.Bind1())(n(K))(function(g){return y(g.value0)(g.value1)})}}})},v=function(D){return new h.Apply(function(){return p(D.Bind1().Apply0().Functor0())},k.ap(C(D)))},G=function(D){return new c.Applicative(function(){return v(D)},function(n){return function(y){return c.pure(D.Applicative0())(new q.Tuple(n,
y))}})};b.StateT=function(D){return D};b.evalStateT=function(D){return function(n){return function(y){return m.map(D)(q.fst)(n(y))}}};b.functorStateT=p;b.applyStateT=v;b.applicativeStateT=G;b.bindStateT=t;b.monadStateT=C;b.monadTransStateT=a;b.monadStateStateT=function(D){return new d.MonadState(function(){return C(D)},function(n){return function(y){return c.pure(D.Applicative0())(n(y))}})}})(PS);
(function(a){a["Control.MonadZero"]=a["Control.MonadZero"]||{};var b=a["Control.MonadZero"],c=a["Control.Alternative"],h=a["Control.Applicative"],e=a["Control.Monad"],k=a["Control.Plus"],d=a["Data.Unit"];a=function(q,p){this.Alternative1=q;this.Monad0=p};var m=new a(function(){return c.alternativeArray},function(){return e.monadArray});b.MonadZero=a;b.guard=function(q){return function(p){if(p)return h.pure(q.Alternative1().Applicative0())(d.unit);if(!p)return k.empty(q.Alternative1().Plus1());throw Error("Control.MonadZero (54:1-54:52): "+
[p.constructor.name]);}};b.monadZeroArray=m})(PS);(function(a){a.refEq=function(b){return function(c){return b===c}}})(PS["Data.Eq"]=PS["Data.Eq"]||{});(function(a){a["Data.Symbol"]=a["Data.Symbol"]||{};a=a["Data.Symbol"];var b=function(){function c(){}c.value=new c;return c}();a.IsSymbol=function(c){this.reflectSymbol=c};a.reflectSymbol=function(c){return c.reflectSymbol};a.SProxy=b})(PS);
(function(a){a.unsafeGet=function(b){return function(c){return c[b]}}})(PS["Record.Unsafe"]=PS["Record.Unsafe"]||{});(function(a){a["Record.Unsafe"]=a["Record.Unsafe"]||{};a["Record.Unsafe"].unsafeGet=a["Record.Unsafe"].unsafeGet})(PS);(function(a){a["Type.Data.RowList"]=a["Type.Data.RowList"]||{};a=a["Type.Data.RowList"];var b=function(){function c(){}c.value=new c;return c}();a.RLProxy=b})(PS);
(function(a){a["Data.Eq"]=a["Data.Eq"]||{};var b=a["Data.Eq"],c=a["Data.Eq"],h=a["Data.Symbol"],e=a["Record.Unsafe"],k=a["Type.Data.RowList"],d=function(G){this.eqRecord=G},m=function(G){this.eq=G};a=new m(c.refEq);var q=new d(function(G){return function(D){return function(n){return!0}}}),p=new m(c.refEq),C=new m(c.refEq),t=new m(c.refEq),v=new m(c.refEq);b.Eq=m;b.eq=function(G){return G.eq};b.notEq=function(G){return function(D){return function(n){return(0,v.eq)((0,G.eq)(D)(n))(!1)}}};b.EqRecord=
d;b.eqRecord=function(G){return G.eqRecord};b.eqBoolean=v;b.eqInt=C;b.eqNumber=p;b.eqChar=t;b.eqString=a;b.eqRec=function(G){return function(D){return new m((0,D.eqRecord)(k.RLProxy.value))}};b.eqRowNil=q;b.eqRowCons=function(G){return function(D){return function(n){return function(y){return new d(function(K){return function(g){return function(U){var H=(0,G.eqRecord)(k.RLProxy.value)(g)(U),z=h.reflectSymbol(n)(h.SProxy.value);z=e.unsafeGet(z);return(0,y.eq)(z(g))(z(U))&&H}}})}}}}})(PS);
(function(a){a["Data.Maybe"]=a["Data.Maybe"]||{};var b=a["Data.Maybe"],c=a["Control.Apply"],h=a["Control.Bind"],e=a["Control.Category"],k=a["Data.Eq"],d=a["Data.Function"],m=a["Data.Functor"],q=function(){function G(){}G.value=new G;return G}(),p=function(){function G(D){this.value0=D}G.create=function(D){return new G(D)};return G}(),C=function(G){return function(D){return function(n){if(n instanceof q)return G;if(n instanceof p)return D(n.value0);throw Error("Data.Maybe (217:1-217:51): "+[G.constructor.name,
D.constructor.name,n.constructor.name]);}}};a=C(!0)(d["const"](!1));d=C(!1)(d["const"](!0));var t=new m.Functor(function(G){return function(D){return D instanceof p?new p(G(D.value0)):q.value}}),v=new c.Apply(function(){return t},function(G){return function(D){if(G instanceof p)return m.map(t)(G.value0)(D);if(G instanceof q)return q.value;throw Error("Data.Maybe (67:1-67:35): "+[G.constructor.name,D.constructor.name]);}});c=new h.Bind(function(){return v},function(G){return function(D){if(G instanceof
p)return D(G.value0);if(G instanceof q)return q.value;throw Error("Data.Maybe (125:1-125:33): "+[G.constructor.name,D.constructor.name]);}});b.Nothing=q;b.Just=p;b.maybe=C;b.fromMaybe=function(G){return C(G)(e.identity(e.categoryFn))};b.isJust=d;b.isNothing=a;b.fromJust=function(G){return function(D){if(D instanceof p)return D.value0;throw Error("Data.Maybe (268:1-268:46): "+[D.constructor.name]);}};b.functorMaybe=t;b.applyMaybe=v;b.bindMaybe=c;b.eqMaybe=function(G){return new k.Eq(function(D){return function(n){return D instanceof
q&&n instanceof q?!0:D instanceof p&&n instanceof p?k.eq(G)(D.value0)(n.value0):!1}})}})(PS);(function(a){a.pureE=function(b){return function(){return b}};a.bindE=function(b){return function(c){return function(){return c(b())()}}}})(PS.Effect=PS.Effect||{});
(function(a){a.Effect=a.Effect||{};var b=a.Effect,c=a.Effect,h=a["Control.Applicative"],e=a["Control.Apply"],k=a["Control.Bind"],d=a["Control.Monad"];a=a["Data.Functor"];var m=new d.Monad(function(){return C},function(){return q}),q=new k.Bind(function(){return p},c.bindE),p=new e.Apply(function(){return t},d.ap(m)),C=new h.Applicative(function(){return p},c.pureE),t=new a.Functor(h.liftA1(C));b.functorEffect=t;b.applyEffect=p;b.applicativeEffect=C;b.bindEffect=q;b.monadEffect=m})(PS);
(function(a){a["Effect.Class"]=a["Effect.Class"]||{};var b=a["Effect.Class"],c=a["Control.Category"],h=a.Effect;a=function(e,k){this.Monad0=e;this.liftEffect=k};c=new a(function(){return h.monadEffect},c.identity(c.categoryFn));b.liftEffect=function(e){return e.liftEffect};b.MonadEffect=a;b.monadEffectEffect=c})(PS);
(function(a){a.new=function(b){return function(){return{value:b}}};a.read=function(b){return function(){return b.value}};a["modify'"]=function(b){return function(c){return function(){var h=b(c.value);c.value=h.state;return h.value}}};a.write=function(b){return function(c){return function(){c.value=b;return{}}}}})(PS["Effect.Ref"]=PS["Effect.Ref"]||{});
(function(a){a["Effect.Ref"]=a["Effect.Ref"]||{};var b=a["Effect.Ref"],c=a["Effect.Ref"],h=a["Data.Functor"],e=a.Effect,k=function(d){return c["modify'"](function(m){m=d(m);return{state:m,value:m}})};b.modify=k;b.modify_=function(d){return function(m){return h["void"](e.functorEffect)(k(d)(m))}};b["new"]=c["new"];b.read=c.read;b["modify'"]=c["modify'"];b.write=c.write})(PS);
(function(a){a["Control.Parallel.Class"]=a["Control.Parallel.Class"]||{};var b=a["Control.Parallel.Class"],c=a["Control.Applicative"],h=a["Control.Apply"],e=a["Control.Bind"],k=a["Control.Monad.Cont.Trans"],d=a["Data.Functor"],m=a["Data.Maybe"],q=a["Effect.Class"],p=a["Effect.Ref"],C=function(y){return y},t=function(y,K,g,U){this.Applicative1=y;this.Monad0=K;this.parallel=g;this.sequential=U},v=function(y){return new t(function(){return n(y)},function(){return k.monadContT(y.Monad0())},C,function(K){return K})},
G=function(y){return new d.Functor(function(K){return function(g){return(0,v(y).parallel)(d.map(k.functorContT(y.Monad0().Bind1().Apply0().Functor0()))(K)((0,v(y).sequential)(g)))}})},D=function(y){return new h.Apply(function(){return G(y)},function(K){return function(g){return function(U){return e.bind(y.Monad0().Bind1())(q.liftEffect(y)(p["new"](m.Nothing.value)))(function(H){return e.bind(y.Monad0().Bind1())(q.liftEffect(y)(p["new"](m.Nothing.value)))(function(z){return e.discard(e.discardUnit)(y.Monad0().Bind1())(k.runContT(K)(function(F){return e.bind(y.Monad0().Bind1())(q.liftEffect(y)(p.read(z)))(function(N){if(N instanceof
m.Nothing)return q.liftEffect(y)(p.write(new m.Just(F))(H));if(N instanceof m.Just)return U(F(N.value0));throw Error("Control.Parallel.Class (71:7-73:26): "+[N.constructor.name]);})}))(function(){return k.runContT(g)(function(F){return e.bind(y.Monad0().Bind1())(q.liftEffect(y)(p.read(H)))(function(N){if(N instanceof m.Nothing)return q.liftEffect(y)(p.write(new m.Just(F))(z));if(N instanceof m.Just)return U(N.value0(F));throw Error("Control.Parallel.Class (77:7-79:26): "+[N.constructor.name]);})})})})})}}})},
n=function(y){return new c.Applicative(function(){return D(y)},function(K){return(0,v(y).parallel)(c.pure(k.applicativeContT(y.Monad0().Applicative0()))(K))})};b.parallel=function(y){return y.parallel};b.sequential=function(y){return y.sequential};b.Parallel=t;b.ParCont=C;b.functorParCont=G;b.applyParCont=D;b.applicativeParCont=n;b.monadParParCont=v})(PS);
(function(a){a.traverseArrayImpl=function(){function b(k){return[k]}function c(k){return function(d){return[k,d]}}function h(k){return function(d){return function(m){return[k,d,m]}}}function e(k){return function(d){return k.concat(d)}}return function(k){return function(d){return function(m){return function(q){return function(p){function C(t,v){switch(v-t){case 0:return m([]);case 1:return d(b)(q(p[t]));case 2:return k(d(c)(q(p[t])))(q(p[t+1]));case 3:return k(k(d(h)(q(p[t])))(q(p[t+1])))(q(p[t+2]));
default:var G=t+2*Math.floor((v-t)/4);return k(d(e)(C(t,G)))(C(G,v))}}return C(0,p.length)}}}}}}()})(PS["Data.Traversable"]=PS["Data.Traversable"]||{});(function(a){a.foldrArray=function(b){return function(c){return function(h){for(var e=c,k=h.length-1;0<=k;k--)e=b(h[k])(e);return e}}};a.foldlArray=function(b){return function(c){return function(h){for(var e=c,k=h.length,d=0;d<k;d++)e=b(e)(h[d]);return e}}}})(PS["Data.Foldable"]=PS["Data.Foldable"]||{});
(function(a){a.unsafeCompareImpl=function(b){return function(c){return function(h){return function(e){return function(k){return e<k?b:e===k?c:h}}}}}})(PS["Data.Ord.Unsafe"]=PS["Data.Ord.Unsafe"]||{});
(function(a){a["Data.Ordering"]=a["Data.Ordering"]||{};var b=a["Data.Ordering"];a=a["Data.Eq"];var c=function(){function k(){}k.value=new k;return k}(),h=function(){function k(){}k.value=new k;return k}(),e=function(){function k(){}k.value=new k;return k}();a=new a.Eq(function(k){return function(d){return k instanceof c&&d instanceof c||k instanceof h&&d instanceof h||k instanceof e&&d instanceof e?!0:!1}});b.LT=c;b.GT=h;b.EQ=e;b.eqOrdering=a})(PS);
(function(a){a["Data.Ord.Unsafe"]=a["Data.Ord.Unsafe"]||{};var b=a["Data.Ord.Unsafe"],c=a["Data.Ordering"];a=a["Data.Ord.Unsafe"].unsafeCompareImpl(c.LT.value)(c.EQ.value)(c.GT.value);b.unsafeCompare=a})(PS);
(function(a){a["Data.Ord"]=a["Data.Ord"]||{};var b=a["Data.Ord"],c=a["Data.Eq"],h=a["Data.Ord.Unsafe"],e=a["Data.Ordering"];a=function(m,q){this.Eq0=m;this.compare=q};var k=new a(function(){return c.eqNumber},h.unsafeCompare),d=new a(function(){return c.eqInt},h.unsafeCompare);h=new a(function(){return c.eqChar},h.unsafeCompare);b.Ord=a;b.compare=function(m){return m.compare};b.lessThan=function(m){return function(q){return function(p){return(0,m.compare)(q)(p)instanceof e.LT?!0:!1}}};b.lessThanOrEq=
function(m){return function(q){return function(p){return(0,m.compare)(q)(p)instanceof e.GT?!1:!0}}};b.greaterThan=function(m){return function(q){return function(p){return(0,m.compare)(q)(p)instanceof e.GT?!0:!1}}};b.greaterThanOrEq=function(m){return function(q){return function(p){return(0,m.compare)(q)(p)instanceof e.LT?!1:!0}}};b.min=function(m){return function(q){return function(p){var C=(0,m.compare)(q)(p);if(C instanceof e.LT||C instanceof e.EQ)return q;if(C instanceof e.GT)return p;throw Error("Data.Ord (119:3-122:12): "+
[C.constructor.name]);}}};b.max=function(m){return function(q){return function(p){var C=(0,m.compare)(q)(p);if(C instanceof e.LT)return p;if(C instanceof e.EQ||C instanceof e.GT)return q;throw Error("Data.Ord (128:3-131:12): "+[C.constructor.name]);}}};b.ordInt=d;b.ordNumber=k;b.ordChar=h})(PS);
(function(a){a.intAdd=function(b){return function(c){return b+c|0}};a.intMul=function(b){return function(c){return b*c|0}};a.numAdd=function(b){return function(c){return b+c}};a.numMul=function(b){return function(c){return b*c}}})(PS["Data.Semiring"]=PS["Data.Semiring"]||{});
(function(a){a["Data.Semiring"]=a["Data.Semiring"]||{};var b=a["Data.Semiring"],c=a["Data.Semiring"];a=function(e,k,d,m){this.add=e;this.mul=k;this.one=d;this.zero=m};var h=new a(c.numAdd,c.numMul,1,0);c=new a(c.intAdd,c.intMul,1,0);b.Semiring=a;b.add=function(e){return e.add};b.zero=function(e){return e.zero};b.mul=function(e){return e.mul};b.one=function(e){return e.one};b.semiringInt=c;b.semiringNumber=h})(PS);
(function(a){a["Data.Foldable"]=a["Data.Foldable"]||{};var b=a["Data.Foldable"],c=a["Data.Foldable"],h=a["Control.Applicative"],e=a["Control.Apply"],k=a["Control.Category"],d=a["Data.Eq"],m=a["Data.Function"],q=a["Data.Functor"],p=a["Data.HeytingAlgebra"],C=a["Data.Maybe"],t=a["Data.Monoid"],v=a["Data.Monoid.Disj"],G=a["Data.Monoid.Dual"],D=a["Data.Monoid.Endo"],n=a["Data.Newtype"],y=a["Data.Ord"],K=a["Data.Ordering"],g=a["Data.Semigroup"],U=a["Data.Semiring"],H=a["Data.Unit"];a=function(u,Q,R){this.foldMap=
u;this.foldl=Q;this.foldr=R};var z=function(u){return function(Q){return function(R){return(0,Q.foldr)(function(w){return e.applySecond(u.Apply0())(R(w))})(h.pure(u)(H.unit))}}},F=function(u){return function(Q){return(0,u.foldl)(function(R){return function(w){if(R instanceof C.Nothing)return new C.Just(w);if(R instanceof C.Just){var L=C.Just;w=d.eq(K.eqOrdering)(Q(R.value0)(w))(K.GT.value)?R.value0:w;return new L(w)}throw Error("Data.Foldable (389:3-389:27): "+[R.constructor.name,w.constructor.name]);
}})(C.Nothing.value)}},N=new a(function(u){return function(Q){return function(R){if(R instanceof C.Nothing)return t.mempty(u);if(R instanceof C.Just)return Q(R.value0);throw Error("Data.Foldable (129:1-129:41): "+[Q.constructor.name,R.constructor.name]);}}},function(u){return function(Q){return function(R){if(R instanceof C.Nothing)return Q;if(R instanceof C.Just)return u(Q)(R.value0);throw Error("Data.Foldable (129:1-129:41): "+[u.constructor.name,Q.constructor.name,R.constructor.name]);}}},function(u){return function(Q){return function(R){if(R instanceof
C.Nothing)return Q;if(R instanceof C.Just)return u(R.value0)(Q);throw Error("Data.Foldable (129:1-129:41): "+[u.constructor.name,Q.constructor.name,R.constructor.name]);}}}),r=function(u){return function(Q){return function(R){return(0,u.foldr)(function(w){return function(L){return g.append(Q.Semigroup0())(R(w))(L)}})(t.mempty(Q))}}},J=new a(function(u){return r(J)(u)},c.foldlArray,c.foldrArray),ba=function(u){return function(Q){return n.alaF(q.functorFn)(q.functorFn)(n.newtypeDisj)(n.newtypeDisj)(v.Disj)((0,u.foldMap)(v.monoidDisj(Q)))}};
b.Foldable=a;b.foldr=function(u){return u.foldr};b.foldl=function(u){return u.foldl};b.foldMap=function(u){return u.foldMap};b.foldrDefault=function(u){return function(Q){return function(R){return function(w){return n.unwrap(n.newtypeEndo)((0,u.foldMap)(D.monoidEndo(k.categoryFn))(function(L){return D.Endo(Q(L))})(w))(R)}}}};b.foldlDefault=function(u){return function(Q){return function(R){return function(w){return n.unwrap(n.newtypeEndo)(n.unwrap(n.newtypeDual)((0,u.foldMap)(G.monoidDual(D.monoidEndo(k.categoryFn)))(function(L){return G.Dual(D.Endo(m.flip(Q)(L)))})(w)))(R)}}}};
b.foldMapDefaultR=r;b.traverse_=z;b.for_=function(u){return function(Q){return m.flip(z(u)(Q))}};b.intercalate=function(u){return function(Q){return function(R){return function(w){return(0,u.foldl)(function(L){return function(T){return L.init?{init:!1,acc:T}:{init:!1,acc:g.append(Q.Semigroup0())(L.acc)(g.append(Q.Semigroup0())(R)(T))}}})({init:!0,acc:t.mempty(Q)})(w).acc}}}};b.any=ba;b.sum=function(u){return function(Q){return(0,u.foldl)(U.add(Q))(U.zero(Q))}};b.elem=function(u){return function(Q){return function(R){return ba(u)(p.heytingAlgebraBoolean)(d.eq(Q)(R))}}};
b.maximum=function(u){return function(Q){return F(Q)(y.compare(u))}};b.maximumBy=F;b.foldableArray=J;b.foldableMaybe=N})(PS);
(function(a){a["Data.Traversable"]=a["Data.Traversable"]||{};var b=a["Data.Traversable"],c=a["Data.Traversable"],h=a["Control.Applicative"],e=a["Control.Apply"],k=a["Control.Category"],d=a["Data.Foldable"],m=a["Data.Functor"],q=a["Data.Maybe"];a=function(v,G,D,n){this.Foldable1=v;this.Functor0=G;this.sequence=D;this.traverse=n};var p=new a(function(){return d.foldableMaybe},function(){return q.functorMaybe},function(v){return function(G){if(G instanceof q.Nothing)return h.pure(v)(q.Nothing.value);
if(G instanceof q.Just)return m.map(v.Apply0().Functor0())(q.Just.create)(G.value0);throw Error("Data.Traversable (86:1-86:47): "+[G.constructor.name]);}},function(v){return function(G){return function(D){if(D instanceof q.Nothing)return h.pure(v)(q.Nothing.value);if(D instanceof q.Just)return m.map(v.Apply0().Functor0())(q.Just.create)(G(D.value0));throw Error("Data.Traversable (86:1-86:47): "+[G.constructor.name,D.constructor.name]);}}}),C=function(v){return function(G){return(0,v.traverse)(G)(k.identity(k.categoryFn))}},
t=new a(function(){return d.foldableArray},function(){return m.functorArray},function(v){return C(t)(v)},function(v){return c.traverseArrayImpl(e.apply(v.Apply0()))(m.map(v.Apply0().Functor0()))(h.pure(v))});b.Traversable=a;b.traverse=function(v){return v.traverse};b.sequence=function(v){return v.sequence};b.sequenceDefault=C;b["for"]=function(v){return function(G){return function(D){return function(n){return(0,G.traverse)(v)(n)(D)}}}};b.traversableArray=t;b.traversableMaybe=p})(PS);
(function(a){a["Control.Parallel"]=a["Control.Parallel"]||{};var b=a["Control.Parallel.Class"],c=a["Data.Traversable"];a["Control.Parallel"].parTraverse=function(h){return function(e){return function(k){return function(d){return b.sequential(h)(c.traverse(e)(h.Applicative1())(function(m){return b.parallel(h)(k(m))})(d))}}}}})(PS);
(function(a){a.range=function(b){return function(c){for(var h=b>c?-1:1,e=Array(h*(c-b)+1),k=b,d=0;k!==c;)e[d++]=k,k+=h;e[d]=k;return e}};a.length=function(b){return b.length};a.cons=function(b){return function(c){return[b].concat(c)}};a.snoc=function(b){return function(c){var h=b.slice();h.push(c);return h}};a["uncons'"]=function(b){return function(c){return function(h){return 0===h.length?b({}):c(h[0])(h.slice(1))}}};a.indexImpl=function(b){return function(c){return function(h){return function(e){return 0>
e||e>=h.length?c:b(h[e])}}}};a.concat=function(b){if(1E4>=b.length)return Array.prototype.concat.apply([],b);for(var c=[],h=0,e=b.length;h<e;h++)for(var k=b[h],d=0,m=k.length;d<m;d++)c.push(k[d]);return c};a.slice=function(b){return function(c){return function(h){return h.slice(b,c)}}};a.take=function(b){return function(c){return 1>b?[]:c.slice(0,b)}};a.drop=function(b){return function(c){return 1>b?c:c.slice(b)}};a.zipWith=function(b){return function(c){return function(h){for(var e=c.length<h.length?
c.length:h.length,k=Array(e),d=0;d<e;d++)k[d]=b(c[d])(h[d]);return k}}}})(PS["Data.Array"]=PS["Data.Array"]||{});(function(a){a["Data.Boolean"]=a["Data.Boolean"]||{};a["Data.Boolean"].otherwise=!0})(PS);
(function(a){a["Data.Array"]=a["Data.Array"]||{};var b=a["Data.Array"],c=a["Data.Array"],h=a["Control.Apply"],e=a["Control.Bind"],k=a["Data.Boolean"],d=a["Data.Function"],m=a["Data.Functor"],q=a["Data.Maybe"];a=c.zipWith(a["Data.Tuple"].Tuple.create);var p=c["uncons'"](d["const"](q.Nothing.value))(function(G){return function(D){return new q.Just({head:G,tail:D})}}),C=function(G){if(0===c.length(G))return q.Nothing.value;if(k.otherwise)return new q.Just(c.slice(0)(c.length(G)-1|0)(G));throw Error("Data.Array (323:1-323:45): "+
[G.constructor.name]);},t=c.indexImpl(q.Just.create)(q.Nothing.value),v=function(G){return t(G)(c.length(G)-1|0)};e=d.flip(e.bind(e.bindArray));b.last=v;b.init=C;b.uncons=p;b.unsnoc=function(G){return h.apply(q.applyMaybe)(m.map(q.functorMaybe)(function(D){return function(n){return{init:D,last:n}}})(C(G)))(v(G))};b.index=t;b.concatMap=e;b.zip=a;b.range=c.range;b.length=c.length;b.cons=c.cons;b.snoc=c.snoc;b.concat=c.concat;b.take=c.take;b.drop=c.drop})(PS);
(function(a){a.empty=function(){return[]};a.pushAll=function(b){return function(c){return function(){return c.push.apply(c,b)}}};a.copyImpl=function(b){return function(){return b.slice()}}})(PS["Data.Array.ST"]=PS["Data.Array.ST"]||{});(function(a){a["Data.Array.ST"]=a["Data.Array.ST"]||{};var b=a["Data.Array.ST"],c=a["Data.Array.ST"];a=c.copyImpl;b.push=function(h){return c.pushAll([h])};b.freeze=a;b.empty=c.empty})(PS);
(function(a){a.topInt=2147483647;a.bottomInt=-2147483648;a.topChar=String.fromCharCode(65535);a.bottomChar=String.fromCharCode(0)})(PS["Data.Bounded"]=PS["Data.Bounded"]||{});
(function(a){a["Data.Bounded"]=a["Data.Bounded"]||{};var b=a["Data.Bounded"],c=a["Data.Bounded"],h=a["Data.Ord"];a=function(k,d,m){this.Ord0=k;this.bottom=d;this.top=m};var e=new a(function(){return h.ordInt},c.bottomInt,c.topInt);c=new a(function(){return h.ordChar},c.bottomChar,c.topChar);b.Bounded=a;b.bottom=function(k){return k.bottom};b.top=function(k){return k.top};b.boundedInt=e;b.boundedChar=c})(PS);
(function(a){a.intSub=function(b){return function(c){return b-c|0}};a.numSub=function(b){return function(c){return b-c}}})(PS["Data.Ring"]=PS["Data.Ring"]||{});
(function(a){a["Data.Ring"]=a["Data.Ring"]||{};var b=a["Data.Ring"],c=a["Data.Ring"],h=a["Data.Semiring"];a=function(k,d){this.Semiring0=k;this.sub=d};var e=new a(function(){return h.semiringNumber},c.numSub);c=new a(function(){return h.semiringInt},c.intSub);b.Ring=a;b.sub=function(k){return k.sub};b.negate=function(k){return function(d){return(0,k.sub)(h.zero(k.Semiring0()))(d)}};b.ringInt=c;b.ringNumber=e})(PS);
(function(a){a["Data.CommutativeRing"]=a["Data.CommutativeRing"]||{};var b=a["Data.CommutativeRing"],c=a["Data.Ring"];a=function(e){this.Ring0=e};var h=new a(function(){return c.ringInt});b.CommutativeRing=a;b.commutativeRingInt=h})(PS);(function(a){a.toCharCode=function(b){return b.charCodeAt(0)};a.fromCharCode=function(b){return String.fromCharCode(b)}})(PS["Data.Enum"]=PS["Data.Enum"]||{});
(function(a){a["Data.Enum"]=a["Data.Enum"]||{};var b=a["Data.Enum"],c=a["Data.Enum"],h=a["Data.Bounded"],e=a["Data.Maybe"],k=a["Data.Ord"];a=function(t,v,G){this.Ord0=t;this.pred=v;this.succ=G};var d=function(t,v,G,D,n){this.Bounded0=t;this.Enum1=v;this.cardinality=G;this.fromEnum=D;this.toEnum=n},m=function(t){return function(v){return function(G){return t(v(G)+1|0)}}},q=function(t){return function(v){return function(G){return t(v(G)-1|0)}}},p=function(t){return t>=h.bottom(h.boundedInt)&&t<=h.top(h.boundedInt)?
new e.Just(c.fromCharCode(t)):e.Nothing.value},C=new a(function(){return k.ordChar},q(p)(c.toCharCode),m(p)(c.toCharCode));p=new d(function(){return h.boundedChar},function(){return C},c.toCharCode(h.top(h.boundedChar))-c.toCharCode(h.bottom(h.boundedChar))|0,c.toCharCode,p);b.Enum=a;b.succ=function(t){return t.succ};b.pred=function(t){return t.pred};b.BoundedEnum=d;b.cardinality=function(t){return t.cardinality};b.toEnum=function(t){return t.toEnum};b.fromEnum=function(t){return t.fromEnum};b.toEnumWithDefaults=
function(t){return function(v){return function(G){return function(D){var n=(0,t.toEnum)(D);if(n instanceof e.Just)return n.value0;if(n instanceof e.Nothing)return D<(0,t.fromEnum)(h.bottom(t.Bounded0()))?v:G;throw Error("Data.Enum (158:33-160:62): "+[n.constructor.name]);}}}};b.defaultSucc=m;b.defaultPred=q;b.enumChar=C;b.boundedEnumChar=p})(PS);
(function(a){a.intDegree=function(b){return Math.min(Math.abs(b),2147483647)};a.intDiv=function(b){return function(c){return 0===c?0:0<c?Math.floor(b/c):-Math.floor(b/-c)}};a.intMod=function(b){return function(c){if(0===c)return 0;c=Math.abs(c);return(b%c+c)%c}}})(PS["Data.EuclideanRing"]=PS["Data.EuclideanRing"]||{});
(function(a){a["Data.EuclideanRing"]=a["Data.EuclideanRing"]||{};var b=a["Data.EuclideanRing"],c=a["Data.EuclideanRing"],h=a["Data.CommutativeRing"];a=function(e,k,d,m){this.CommutativeRing0=e;this.degree=k;this.div=d;this.mod=m};c=new a(function(){return h.commutativeRingInt},c.intDegree,c.intDiv,c.intMod);b.EuclideanRing=a;b.degree=function(e){return e.degree};b.div=function(e){return e.div};b.mod=function(e){return e.mod};b.euclideanRingInt=c})(PS);
(function(a){a["Data.Functor.App"]=a["Data.Functor.App"]||{};var b=a["Data.Functor.App"],c=a["Control.Applicative"],h=a["Control.Apply"],e=a["Data.Monoid"],k=a["Data.Semigroup"],d=function(m){return function(q){return new k.Semigroup(function(p){return function(C){return h.lift2(m)(k.append(q))(p)(C)}})}};b.App=function(m){return m};b.semigroupApp=d;b.monoidApp=function(m){return function(q){return new e.Monoid(function(){return d(m.Apply0())(q.Semigroup0())},c.pure(m)(e.mempty(q)))}}})(PS);
(function(a){a["Data.FunctorWithIndex"]=a["Data.FunctorWithIndex"]||{};a=a["Data.FunctorWithIndex"];a.FunctorWithIndex=function(b,c){this.Functor0=b;this.mapWithIndex=c};a.mapWithIndex=function(b){return b.mapWithIndex}})(PS);
(function(a){a.fromNumberImpl=function(b){return function(c){return function(h){return(h|0)===h?b(h):c}}};a.toNumber=function(b){return b};a.fromStringAsImpl=function(b){return function(c){return function(h){var e=11>h?"[0-"+(h-1).toString()+"]":11===h?"[0-9a]":"[0-9a-"+String.fromCharCode(86+h)+"]";var k=new RegExp("^[\\+\\-]?"+e+"+$","i");return function(d){return k.test(d)?(d=parseInt(d,h),(d|0)===d?b(d):c):c}}}};a.quot=function(b){return function(c){return b/c|0}}})(PS["Data.Int"]=PS["Data.Int"]||
{});(function(a){a.infinity=Infinity})(PS.Global=PS.Global||{});(function(a){a.Global=a.Global||{};a.Global.infinity=a.Global.infinity})(PS);(function(a){a.ceil=Math.ceil;a.floor=Math.floor;a.round=Math.round;a.pi=Math.PI})(PS.Math=PS.Math||{});(function(a){a.Math=a.Math||{};var b=a.Math;a=a.Math;b.ceil=a.ceil;b.floor=a.floor;b.round=a.round;b.pi=a.pi})(PS);
(function(a){a["Data.Int"]=a["Data.Int"]||{};var b=a["Data.Int"],c=a["Data.Int"],h=a["Data.Boolean"],e=a["Data.Bounded"],k=a["Data.Maybe"],d=a.Global,m=a.Math;a=c.fromStringAsImpl(k.Just.create)(k.Nothing.value);var q=a(10),p=c.fromNumberImpl(k.Just.create)(k.Nothing.value),C=function(t){if(t===d.infinity||t===-d.infinity)return 0;if(t>=c.toNumber(e.top(e.boundedInt)))return e.top(e.boundedInt);if(t<=c.toNumber(e.bottom(e.boundedInt)))return e.bottom(e.boundedInt);if(h.otherwise)return k.fromMaybe(0)(p(t));
throw Error("Data.Int (66:1-66:29): "+[t.constructor.name]);};b.fromNumber=p;b.ceil=function(t){return C(m.ceil(t))};b.floor=function(t){return C(m.floor(t))};b.round=function(t){return C(m.round(t))};b.fromString=q;b.fromStringAs=a;b.toNumber=c.toNumber;b.quot=c.quot})(PS);
(function(a){a.showIntImpl=function(b){return b.toString()};a.showNumberImpl=function(b){b=b.toString();return isNaN(b+".0")?b:b+".0"};a.showCharImpl=function(b){var c=b.charCodeAt(0);if(32>c||127===c){switch(b){case "\u0007":return"'\\a'";case "\b":return"'\\b'";case "\f":return"'\\f'";case "\n":return"'\\n'";case "\r":return"'\\r'";case "\t":return"'\\t'";case "\v":return"'\\v'"}return"'\\"+c.toString(10)+"'"}return"'"===b||"\\"===b?"'\\"+b+"'":"'"+b+"'"};a.showStringImpl=function(b){var c=b.length;
return'"'+b.replace(/[\0-\x1F\x7F"\\]/g,function(h,e){switch(h){case '"':case "\\":return"\\"+h;case "\u0007":return"\\a";case "\b":return"\\b";case "\f":return"\\f";case "\n":return"\\n";case "\r":return"\\r";case "\t":return"\\t";case "\v":return"\\v"}e+=1;e=e<c&&"0"<=b[e]&&"9">=b[e]?"\\&":"";return"\\"+h.charCodeAt(0).toString(10)+e})+'"'}})(PS["Data.Show"]=PS["Data.Show"]||{});
(function(a){a["Data.Show"]=a["Data.Show"]||{};var b=a["Data.Show"],c=a["Data.Show"];a=function(d){this.show=d};var h=new a(c.showStringImpl),e=new a(c.showNumberImpl),k=new a(c.showIntImpl);c=new a(c.showCharImpl);b.Show=a;b.show=function(d){return d.show};b.showInt=k;b.showNumber=e;b.showChar=c;b.showString=h})(PS);
(function(a){a["Data.NonEmpty"]=a["Data.NonEmpty"]||{};var b=a["Data.NonEmpty"],c=a["Control.Plus"],h=a["Data.Functor"],e=a["Data.Show"],k=function(){function d(m,q){this.value0=m;this.value1=q}d.create=function(m){return function(q){return new d(m,q)}};return d}();b.NonEmpty=k;b.singleton=function(d){return function(m){return new k(m,c.empty(d))}};b.showNonEmpty=function(d){return function(m){return new e.Show(function(q){return"(NonEmpty "+(e.show(d)(q.value0)+(" "+(e.show(m)(q.value1)+")")))})}};
b.functorNonEmpty=function(d){return new h.Functor(function(m){return function(q){return new k(m(q.value0),h.map(d)(m)(q.value1))}})}})(PS);(function(a){a.unfoldrArrayImpl=function(b){return function(c){return function(h){return function(e){return function(k){return function(d){for(var m=[];;){d=k(d);if(b(d))return m;d=c(d);m.push(h(d));d=e(d)}}}}}}}})(PS["Data.Unfoldable"]=PS["Data.Unfoldable"]||{});
(function(a){a.unfoldr1ArrayImpl=function(b){return function(c){return function(h){return function(e){return function(k){return function(d){for(var m=[];;){d=k(d);m.push(h(d));d=e(d);if(b(d))return m;d=c(d)}}}}}}}})(PS["Data.Unfoldable1"]=PS["Data.Unfoldable1"]||{});
(function(a){a["Data.Unfoldable1"]=a["Data.Unfoldable1"]||{};var b=a["Data.Unfoldable1"],c=a["Data.Maybe"],h=a["Data.Tuple"],e=function(k){this.unfoldr1=k};a=new e(a["Data.Unfoldable1"].unfoldr1ArrayImpl(c.isNothing)(c.fromJust())(h.fst)(h.snd));b.Unfoldable1=e;b.unfoldr1=function(k){return k.unfoldr1};b.unfoldable1Array=a})(PS);
(function(a){a["Data.Unfoldable"]=a["Data.Unfoldable"]||{};var b=a["Data.Unfoldable"],c=a["Data.Maybe"],h=a["Data.Tuple"],e=a["Data.Unfoldable1"],k=function(d,m){this.Unfoldable10=d;this.unfoldr=m};a=new k(function(){return e.unfoldable1Array},a["Data.Unfoldable"].unfoldrArrayImpl(c.isNothing)(c.fromJust())(h.fst)(h.snd));b.Unfoldable=k;b.unfoldr=function(d){return d.unfoldr};b.unfoldableArray=a})(PS);
(function(a){a["Data.List.Types"]=a["Data.List.Types"]||{};var b=a["Data.List.Types"],c=a["Control.Alt"],h=a["Control.Applicative"],e=a["Control.Apply"],k=a["Control.Category"],d=a["Control.Plus"],m=a["Data.Foldable"],q=a["Data.Function"],p=a["Data.Functor"],C=a["Data.Maybe"],t=a["Data.Monoid"],v=a["Data.NonEmpty"],G=a["Data.Semigroup"],D=a["Data.Show"],n=a["Data.Traversable"],y=a["Data.Unfoldable"];a=a["Data.Unfoldable1"];var K=function(){function w(){}w.value=new w;return w}(),g=function(){function w(L,
T){this.value0=L;this.value1=T}w.create=function(L){return function(T){return new w(L,T)}};return w}(),U=new p.Functor(function(w){return function(L){return function(T){function Z(pa,ea){if(ea instanceof g&&ea.value1 instanceof g&&ea.value1.value1 instanceof g)la=new g(ea,pa),T=ea.value1.value1.value1;else return aa=!0,function(I){return function(ma){for(var va=I,fa=!1,ua;!fa;){ua=va;var B=ma;ua instanceof g&&ua.value0 instanceof g&&ua.value0.value1 instanceof g&&ua.value0.value1.value1 instanceof
g?(va=ua.value1,ma=new g(w(ua.value0.value0),new g(w(ua.value0.value1.value0),new g(w(ua.value0.value1.value1.value0),B))),ua=void 0):(fa=!0,ua=B)}return ua}}(pa)(function(I){return I instanceof g&&I.value1 instanceof g&&I.value1.value1 instanceof K?new g(w(I.value0),new g(w(I.value1.value0),K.value)):I instanceof g&&I.value1 instanceof K?new g(w(I.value0),K.value):K.value}(ea))}for(var la=L,aa=!1,X;!aa;)X=Z(la,T);return X}}(K.value)}),H=v.functorNonEmpty(U),z=new m.Foldable(function(w){return function(L){return m.foldl(z)(function(T){return function(Z){return G.append(w.Semigroup0())(T)(L(Z))}})(t.mempty(w))}},
function(w){return function(L){return function(T){for(var Z=L,la=!1,aa;!la;){aa=Z;var X=T;if(X instanceof K)la=!0;else{if(X instanceof g)Z=w(aa)(X.value0),T=X.value1;else throw Error("Data.List.Types (109:12-111:30): "+[X.constructor.name]);aa=void 0}}return aa}}},function(w){return function(L){var T=m.foldl(z)(q.flip(g.create))(K.value);return function(Z){return m.foldl(z)(q.flip(w))(L)(T(Z))}}}),F=new G.Semigroup(function(w){return function(L){return m.foldr(z)(g.create)(L)(w)}}),N=function(w){return new D.Show(function(L){return L instanceof
K?"Nil":"("+(m.intercalate(z)(t.monoidString)(" : ")(p.map(U)(D.show(w))(L))+" : Nil)")})},r=new n.Traversable(function(){return z},function(){return U},function(w){return n.traverse(r)(w)(k.identity(k.categoryFn))},function(w){return function(L){return function(T){return p.map(w.Apply0().Functor0())(m.foldl(z)(q.flip(g.create))(K.value))(m.foldl(z)(function(Z){return function(la){return e.lift2(w.Apply0())(q.flip(g.create))(Z)(L(la))}})(h.pure(w)(K.value))(T))}}}),J=new a.Unfoldable1(function(w){return function(L){return function(T){return function(Z){for(var la=
T,aa=!1,X;!aa;){X=Z;var pa=w(la);if(pa.value1 instanceof C.Just)la=pa.value1.value0,Z=new g(pa.value0,X),X=void 0;else if(pa.value1 instanceof C.Nothing)aa=!0,X=m.foldl(z)(q.flip(g.create))(K.value)(new g(pa.value0,X));else throw Error("Data.List.Types (133:22-135:61): "+[pa.constructor.name]);}return X}}(L)(K.value)}});y=new y.Unfoldable(function(){return J},function(w){return function(L){return function(T){return function(Z){for(var la=T,aa=!1,X;!aa;){X=Z;var pa=w(la);if(pa instanceof C.Nothing)aa=
!0,X=m.foldl(z)(q.flip(g.create))(K.value)(X);else{if(pa instanceof C.Just)la=pa.value0.value1,Z=new g(pa.value0.value0,X);else throw Error("Data.List.Types (140:22-142:52): "+[pa.constructor.name]);X=void 0}}return X}}(L)(K.value)}});var ba=new e.Apply(function(){return U},function(w){return function(L){if(w instanceof K)return K.value;if(w instanceof g)return G.append(F)(p.map(U)(w.value0)(L))(e.apply(ba)(w.value1)(L));throw Error("Data.List.Types (155:1-155:33): "+[w.constructor.name,L.constructor.name]);
}}),u=new e.Apply(function(){return H},function(w){return function(L){return new v.NonEmpty(w.value0(L.value0),G.append(F)(e.apply(ba)(w.value1)(new g(L.value0,K.value)))(e.apply(ba)(new g(w.value0,w.value1))(L.value1)))}});a=new h.Applicative(function(){return ba},function(w){return new g(w,K.value)});var Q=new c.Alt(function(){return U},G.append(F)),R=new d.Plus(function(){return Q},K.value);c=new h.Applicative(function(){return u},function(w){return v.singleton(R)(w)});b.Nil=K;b.Cons=g;b.NonEmptyList=
function(w){return w};b.showList=N;b.semigroupList=F;b.functorList=U;b.foldableList=z;b.unfoldable1List=J;b.unfoldableList=y;b.traversableList=r;b.applyList=ba;b.applicativeList=a;b.altList=Q;b.plusList=R;b.showNonEmptyList=function(w){return new D.Show(function(L){return"(NonEmptyList "+(D.show(v.showNonEmpty(w)(N(w)))(L)+")")})};b.functorNonEmptyList=H;b.applyNonEmptyList=u;b.applicativeNonEmptyList=c})(PS);
(function(a){a["Data.List"]=a["Data.List"]||{};var b=a["Data.List"],c=a["Data.Foldable"],h=a["Data.Functor"],e=a["Data.List.Types"],k=a["Data.Maybe"],d=a["Data.Tuple"],m=a["Data.Unfoldable"],q=function(t){if(t instanceof e.Nil)return k.Nothing.value;if(t instanceof e.Cons)return new k.Just({head:t.value0,tail:t.value1});throw Error("Data.List (259:1-259:66): "+[t.constructor.name]);},p=function(){return function(t){return function(v){for(var G=t,D=!1,n;!D;){n=G;var y=v;if(y instanceof e.Nil)D=!0;
else{if(y instanceof e.Cons)G=new e.Cons(y.value0,n),v=y.value1;else throw Error("Data.List (368:3-368:19): "+[n.constructor.name,y.constructor.name]);n=void 0}}return n}}(e.Nil.value)}();a=function(t){return function(v){return function(G){return p(function(D){return function(n){return function(y){for(var K=D,g=n,U=!1,H;!U;){H=K;var z=g,F=y;if(H instanceof e.Nil)U=!0,H=F;else if(z instanceof e.Nil)U=!0,H=F;else{if(H instanceof e.Cons&&z instanceof e.Cons)K=H.value1,g=z.value1,y=new e.Cons(t(H.value0)(z.value0),
F);else throw Error("Data.List (718:3-718:21): "+[H.constructor.name,z.constructor.name,F.constructor.name]);H=void 0}}return H}}}(v)(G)(e.Nil.value))}}};var C=a(d.Tuple.create);b.toUnfoldable=function(t){return m.unfoldr(t)(function(v){return h.map(k.functorMaybe)(function(G){return new d.Tuple(G.head,G.tail)})(q(v))})};b.fromFoldable=function(t){return c.foldr(t)(e.Cons.create)(e.Nil.value)};b.head=function(t){if(t instanceof e.Nil)return k.Nothing.value;if(t instanceof e.Cons)return new k.Just(t.value0);
throw Error("Data.List (230:1-230:22): "+[t.constructor.name]);};b.tail=function(t){if(t instanceof e.Nil)return k.Nothing.value;if(t instanceof e.Cons)return new k.Just(t.value1);throw Error("Data.List (245:1-245:43): "+[t.constructor.name]);};b.uncons=q;b.reverse=p;b.drop=function(t){return function(v){for(var G=t,D=!1,n;!D;){n=G;var y=v;if(1>n)D=!0,n=y;else if(y instanceof e.Nil)D=!0,n=e.Nil.value;else{if(y instanceof e.Cons)G=n-1|0,v=y.value1;else throw Error("Data.List (543:1-543:42): "+[n.constructor.name,
y.constructor.name]);n=void 0}}return n}};b.zipWith=a;b.zip=C})(PS);(function(a){a["Data.List.NonEmpty"]=a["Data.List.NonEmpty"]||{};var b=a["Data.List.Types"],c=a["Data.NonEmpty"];a["Data.List.NonEmpty"].singleton=function(h){return b.NonEmptyList(c.singleton(b.plusList)(h))}})(PS);
(function(a){a["Data.Map.Internal"]=a["Data.Map.Internal"]||{};var b=a["Data.Map.Internal"],c=a["Control.Applicative"],h=a["Data.Foldable"],e=a["Data.Function"],k=a["Data.Functor"],d=a["Data.FunctorWithIndex"],m=a["Data.List.Types"],q=a["Data.Maybe"],p=a["Data.Monoid"],C=a["Data.Ord"],t=a["Data.Ordering"],v=a["Data.Semigroup"],G=a["Data.Tuple"],D=a["Data.Unfoldable"],n=function(){function B(){}B.value=new B;return B}(),y=function(){function B(A,M,da,O){this.value0=A;this.value1=M;this.value2=da;this.value3=
O}B.create=function(A){return function(M){return function(da){return function(O){return new B(A,M,da,O)}}}};return B}(),K=function(){function B(A,M,da,O,Y,P,ca){this.value0=A;this.value1=M;this.value2=da;this.value3=O;this.value4=Y;this.value5=P;this.value6=ca}B.create=function(A){return function(M){return function(da){return function(O){return function(Y){return function(P){return function(ca){return new B(A,M,da,O,Y,P,ca)}}}}}}};return B}(),g=function(){function B(A,M,da){this.value0=A;this.value1=
M;this.value2=da}B.create=function(A){return function(M){return function(da){return new B(A,M,da)}}};return B}(),U=function(){function B(A,M,da){this.value0=A;this.value1=M;this.value2=da}B.create=function(A){return function(M){return function(da){return new B(A,M,da)}}};return B}(),H=function(){function B(A,M,da,O,Y,P){this.value0=A;this.value1=M;this.value2=da;this.value3=O;this.value4=Y;this.value5=P}B.create=function(A){return function(M){return function(da){return function(O){return function(Y){return function(P){return new B(A,
M,da,O,Y,P)}}}}}};return B}(),z=function(){function B(A,M,da,O,Y,P){this.value0=A;this.value1=M;this.value2=da;this.value3=O;this.value4=Y;this.value5=P}B.create=function(A){return function(M){return function(da){return function(O){return function(Y){return function(P){return new B(A,M,da,O,Y,P)}}}}}};return B}(),F=function(){function B(A,M,da,O,Y,P){this.value0=A;this.value1=M;this.value2=da;this.value3=O;this.value4=Y;this.value5=P}B.create=function(A){return function(M){return function(da){return function(O){return function(Y){return function(P){return new B(A,
M,da,O,Y,P)}}}}}};return B}(),N=function(){function B(A,M,da,O){this.value0=A;this.value1=M;this.value2=da;this.value3=O}B.create=function(A){return function(M){return function(da){return function(O){return new B(A,M,da,O)}}}};return B}(),r=function(B){if(B instanceof n)return m.Nil.value;if(B instanceof y)return v.append(m.semigroupList)(r(B.value0))(v.append(m.semigroupList)(c.pure(m.applicativeList)(B.value2))(r(B.value3)));if(B instanceof K)return v.append(m.semigroupList)(r(B.value0))(v.append(m.semigroupList)(c.pure(m.applicativeList)(B.value2))(v.append(m.semigroupList)(r(B.value3))(v.append(m.semigroupList)(c.pure(m.applicativeList)(B.value5))(r(B.value6)))));
throw Error("Data.Map.Internal (612:1-612:40): "+[B.constructor.name]);},J=function(B){return function(A){return new y(n.value,B,A,n.value)}},ba=function(B){return function(A){return D.unfoldr(B)(function(M){function da(P){if(P instanceof m.Nil)return O=!0,q.Nothing.value;if(P instanceof m.Cons){if(P.value0 instanceof n){M=P.value1;return}if(P.value0 instanceof y&&P.value0.value0 instanceof n&&P.value0.value3 instanceof n)return O=!0,q.Just.create(new G.Tuple(new G.Tuple(P.value0.value1,P.value0.value2),
P.value1));if(P.value0 instanceof y&&P.value0.value0 instanceof n)return O=!0,q.Just.create(new G.Tuple(new G.Tuple(P.value0.value1,P.value0.value2),new m.Cons(P.value0.value3,P.value1)));if(P.value0 instanceof y){M=new m.Cons(P.value0.value0,new m.Cons(J(P.value0.value1)(P.value0.value2),new m.Cons(P.value0.value3,P.value1)));return}if(P.value0 instanceof K){M=new m.Cons(P.value0.value0,new m.Cons(J(P.value0.value1)(P.value0.value2),new m.Cons(P.value0.value3,new m.Cons(J(P.value0.value4)(P.value0.value5),
new m.Cons(P.value0.value6,P.value1)))));return}throw Error("Data.Map.Internal (577:18-586:71): "+[P.value0.constructor.name]);}throw Error("Data.Map.Internal (576:3-576:19): "+[P.constructor.name]);}for(var O=!1,Y;!O;)Y=da(M);return Y})(new m.Cons(A,m.Nil.value))}},u=function(B){return function(A){var M=C.compare(B);return function(da){function O(ca){if(ca instanceof n)return Y=!0,q.Nothing.value;if(ca instanceof y){var V=M(A)(ca.value1);if(V instanceof t.EQ)return Y=!0,new q.Just(ca.value2);da=
V instanceof t.LT?ca.value0:ca.value3}else if(ca instanceof K){V=M(A)(ca.value1);if(V instanceof t.EQ)return Y=!0,new q.Just(ca.value2);var S=M(A)(ca.value4);if(S instanceof t.EQ)return Y=!0,new q.Just(ca.value5);da=V instanceof t.LT?ca.value0:S instanceof t.GT?ca.value6:ca.value3}else throw Error("Data.Map.Internal (200:5-200:22): "+[ca.constructor.name]);}for(var Y=!1,P;!Y;)P=O(da);return P}}},Q=function(B){if(B instanceof n)return m.Nil.value;if(B instanceof y)return v.append(m.semigroupList)(Q(B.value0))(v.append(m.semigroupList)(c.pure(m.applicativeList)(B.value1))(Q(B.value3)));
if(B instanceof K)return v.append(m.semigroupList)(Q(B.value0))(v.append(m.semigroupList)(c.pure(m.applicativeList)(B.value1))(v.append(m.semigroupList)(Q(B.value3))(v.append(m.semigroupList)(c.pure(m.applicativeList)(B.value4))(Q(B.value6)))));throw Error("Data.Map.Internal (606:1-606:38): "+[B.constructor.name]);},R=new k.Functor(function(B){return function(A){if(A instanceof n)return n.value;if(A instanceof y)return new y(k.map(R)(B)(A.value0),A.value1,B(A.value2),k.map(R)(B)(A.value3));if(A instanceof
K)return new K(k.map(R)(B)(A.value0),A.value1,B(A.value2),k.map(R)(B)(A.value3),A.value4,B(A.value5),k.map(R)(B)(A.value6));throw Error("Data.Map.Internal (96:1-96:39): "+[B.constructor.name,A.constructor.name]);}}),w=new d.FunctorWithIndex(function(){return R},function(B){return function(A){if(A instanceof n)return n.value;if(A instanceof y)return new y(d.mapWithIndex(w)(B)(A.value0),A.value1,B(A.value1)(A.value2),d.mapWithIndex(w)(B)(A.value3));if(A instanceof K)return new K(d.mapWithIndex(w)(B)(A.value0),
A.value1,B(A.value1)(A.value2),d.mapWithIndex(w)(B)(A.value3),A.value4,B(A.value4)(A.value5),d.mapWithIndex(w)(B)(A.value6));throw Error("Data.Map.Internal (101:1-101:59): "+[B.constructor.name,A.constructor.name]);}}),L=function(B){return function(A){return function(M){function da(V,S,ha){if(S instanceof m.Nil)return P=!0,ha;if(S instanceof m.Cons){if(S.value0 instanceof g){O=V;Y=S.value1;M=new y(ha,S.value0.value0,S.value0.value1,S.value0.value2);return}if(S.value0 instanceof U){O=V;Y=S.value1;
M=new y(S.value0.value0,S.value0.value1,S.value0.value2,ha);return}if(S.value0 instanceof H){O=V;Y=S.value1;M=new K(ha,S.value0.value0,S.value0.value1,S.value0.value2,S.value0.value3,S.value0.value4,S.value0.value5);return}if(S.value0 instanceof z){O=V;Y=S.value1;M=new K(S.value0.value0,S.value0.value1,S.value0.value2,ha,S.value0.value3,S.value0.value4,S.value0.value5);return}if(S.value0 instanceof F){O=V;Y=S.value1;M=new K(S.value0.value0,S.value0.value1,S.value0.value2,S.value0.value3,S.value0.value4,
S.value0.value5,ha);return}throw Error("Data.Map.Internal (418:3-423:88): "+[S.value0.constructor.name]);}throw Error("Data.Map.Internal (415:1-415:80): "+[S.constructor.name,ha.constructor.name]);}for(var O=B,Y=A,P=!1,ca;!P;)ca=da(O,Y,M);return ca}}},T=function(B){return function(A){return function(M){var da=function(Y){return function(P){function ca(x,l){if(x instanceof m.Nil)return S=!0,new y(l.value0,l.value1,l.value2,l.value3);if(x instanceof m.Cons){if(x.value0 instanceof g)return S=!0,L(B)(x.value1)(new K(l.value0,
l.value1,l.value2,l.value3,x.value0.value0,x.value0.value1,x.value0.value2));if(x.value0 instanceof U)return S=!0,L(B)(x.value1)(new K(x.value0.value0,x.value0.value1,x.value0.value2,l.value0,l.value1,l.value2,l.value3));if(x.value0 instanceof H){V=x.value1;P=new N(new y(l.value0,l.value1,l.value2,l.value3),x.value0.value0,x.value0.value1,new y(x.value0.value2,x.value0.value3,x.value0.value4,x.value0.value5));return}if(x.value0 instanceof z){V=x.value1;P=new N(new y(x.value0.value0,x.value0.value1,
x.value0.value2,l.value0),l.value1,l.value2,new y(l.value3,x.value0.value3,x.value0.value4,x.value0.value5));return}if(x.value0 instanceof F){V=x.value1;P=new N(new y(x.value0.value0,x.value0.value1,x.value0.value2,x.value0.value3),x.value0.value4,x.value0.value5,new y(l.value0,l.value1,l.value2,l.value3));return}throw Error("Data.Map.Internal (454:5-459:108): "+[x.value0.constructor.name,l.constructor.name]);}throw Error("Data.Map.Internal (451:3-451:56): "+[x.constructor.name,l.constructor.name]);
}for(var V=Y,S=!1,ha;!S;)ha=ca(V,P);return ha}},O=C.compare(B);return function(Y){return function(P){function ca(x,l){if(l instanceof n)return S=!0,da(x)(new N(n.value,A,M,n.value));if(l instanceof y){var W=O(A)(l.value1);if(W instanceof t.EQ)return S=!0,L(B)(x)(new y(l.value0,A,M,l.value3));W instanceof t.LT?(V=new m.Cons(new g(l.value1,l.value2,l.value3),x),P=l.value0):(V=new m.Cons(new U(l.value0,l.value1,l.value2),x),P=l.value3)}else if(l instanceof K){W=O(A)(l.value1);if(W instanceof t.EQ)return S=
!0,L(B)(x)(new K(l.value0,A,M,l.value3,l.value4,l.value5,l.value6));var ja=O(A)(l.value4);if(ja instanceof t.EQ)return S=!0,L(B)(x)(new K(l.value0,l.value1,l.value2,l.value3,A,M,l.value6));W instanceof t.LT?(V=new m.Cons(new H(l.value1,l.value2,l.value3,l.value4,l.value5,l.value6),x),P=l.value0):W instanceof t.GT&&ja instanceof t.LT?(V=new m.Cons(new z(l.value0,l.value1,l.value2,l.value4,l.value5,l.value6),x),P=l.value3):(V=new m.Cons(new F(l.value0,l.value1,l.value2,l.value3,l.value4,l.value5),x),
P=l.value6)}else throw Error("Data.Map.Internal (434:3-434:55): "+[x.constructor.name,l.constructor.name]);}for(var V=Y,S=!1,ha;!S;)ha=ca(V,P);return ha}}(m.Nil.value)}}},Z=function(B){return function(A){var M=function(P){return function(ca){function V(l,W){if(l instanceof m.Nil)return ha=!0,W;if(l instanceof m.Cons){if(l.value0 instanceof g&&l.value0.value2 instanceof n&&W instanceof n)return ha=!0,L(B)(l.value1)(new y(n.value,l.value0.value0,l.value0.value1,n.value));if(l.value0 instanceof U&&l.value0.value0 instanceof
n&&W instanceof n)return ha=!0,L(B)(l.value1)(new y(n.value,l.value0.value1,l.value0.value2,n.value));if(l.value0 instanceof g&&l.value0.value2 instanceof y){S=l.value1;ca=new K(W,l.value0.value0,l.value0.value1,l.value0.value2.value0,l.value0.value2.value1,l.value0.value2.value2,l.value0.value2.value3);return}if(l.value0 instanceof U&&l.value0.value0 instanceof y){S=l.value1;ca=new K(l.value0.value0.value0,l.value0.value0.value1,l.value0.value0.value2,l.value0.value0.value3,l.value0.value1,l.value0.value2,
W);return}if(l.value0 instanceof g&&l.value0.value2 instanceof K)return ha=!0,L(B)(l.value1)(new y(new y(W,l.value0.value0,l.value0.value1,l.value0.value2.value0),l.value0.value2.value1,l.value0.value2.value2,new y(l.value0.value2.value3,l.value0.value2.value4,l.value0.value2.value5,l.value0.value2.value6)));if(l.value0 instanceof U&&l.value0.value0 instanceof K)return ha=!0,L(B)(l.value1)(new y(new y(l.value0.value0.value0,l.value0.value0.value1,l.value0.value0.value2,l.value0.value0.value3),l.value0.value0.value4,
l.value0.value0.value5,new y(l.value0.value0.value6,l.value0.value1,l.value0.value2,W)));if(l.value0 instanceof H&&l.value0.value2 instanceof n&&l.value0.value5 instanceof n&&W instanceof n)return ha=!0,L(B)(l.value1)(new K(n.value,l.value0.value0,l.value0.value1,n.value,l.value0.value3,l.value0.value4,n.value));if(l.value0 instanceof z&&l.value0.value0 instanceof n&&l.value0.value5 instanceof n&&W instanceof n)return ha=!0,L(B)(l.value1)(new K(n.value,l.value0.value1,l.value0.value2,n.value,l.value0.value3,
l.value0.value4,n.value));if(l.value0 instanceof F&&l.value0.value0 instanceof n&&l.value0.value3 instanceof n&&W instanceof n)return ha=!0,L(B)(l.value1)(new K(n.value,l.value0.value1,l.value0.value2,n.value,l.value0.value4,l.value0.value5,n.value));if(l.value0 instanceof H&&l.value0.value2 instanceof y)return ha=!0,L(B)(l.value1)(new y(new K(W,l.value0.value0,l.value0.value1,l.value0.value2.value0,l.value0.value2.value1,l.value0.value2.value2,l.value0.value2.value3),l.value0.value3,l.value0.value4,
l.value0.value5));if(l.value0 instanceof z&&l.value0.value0 instanceof y)return ha=!0,L(B)(l.value1)(new y(new K(l.value0.value0.value0,l.value0.value0.value1,l.value0.value0.value2,l.value0.value0.value3,l.value0.value1,l.value0.value2,W),l.value0.value3,l.value0.value4,l.value0.value5));if(l.value0 instanceof z&&l.value0.value5 instanceof y)return ha=!0,L(B)(l.value1)(new y(l.value0.value0,l.value0.value1,l.value0.value2,new K(W,l.value0.value3,l.value0.value4,l.value0.value5.value0,l.value0.value5.value1,
l.value0.value5.value2,l.value0.value5.value3)));if(l.value0 instanceof F&&l.value0.value3 instanceof y)return ha=!0,L(B)(l.value1)(new y(l.value0.value0,l.value0.value1,l.value0.value2,new K(l.value0.value3.value0,l.value0.value3.value1,l.value0.value3.value2,l.value0.value3.value3,l.value0.value4,l.value0.value5,W)));if(l.value0 instanceof H&&l.value0.value2 instanceof K)return ha=!0,L(B)(l.value1)(new K(new y(W,l.value0.value0,l.value0.value1,l.value0.value2.value0),l.value0.value2.value1,l.value0.value2.value2,
new y(l.value0.value2.value3,l.value0.value2.value4,l.value0.value2.value5,l.value0.value2.value6),l.value0.value3,l.value0.value4,l.value0.value5));if(l.value0 instanceof z&&l.value0.value0 instanceof K)return ha=!0,L(B)(l.value1)(new K(new y(l.value0.value0.value0,l.value0.value0.value1,l.value0.value0.value2,l.value0.value0.value3),l.value0.value0.value4,l.value0.value0.value5,new y(l.value0.value0.value6,l.value0.value1,l.value0.value2,W),l.value0.value3,l.value0.value4,l.value0.value5));if(l.value0 instanceof
z&&l.value0.value5 instanceof K)return ha=!0,L(B)(l.value1)(new K(l.value0.value0,l.value0.value1,l.value0.value2,new y(W,l.value0.value3,l.value0.value4,l.value0.value5.value0),l.value0.value5.value1,l.value0.value5.value2,new y(l.value0.value5.value3,l.value0.value5.value4,l.value0.value5.value5,l.value0.value5.value6)));if(l.value0 instanceof F&&l.value0.value3 instanceof K)return ha=!0,L(B)(l.value1)(new K(l.value0.value0,l.value0.value1,l.value0.value2,new y(l.value0.value3.value0,l.value0.value3.value1,
l.value0.value3.value2,l.value0.value3.value3),l.value0.value3.value4,l.value0.value3.value5,new y(l.value0.value3.value6,l.value0.value4,l.value0.value5,W)));throw Error("Data.Map.Internal (511:9-528:136): "+[l.value0.constructor.name,W.constructor.name]);}throw Error("Data.Map.Internal (508:5-528:136): "+[l.constructor.name]);}for(var S=P,ha=!1,x;!ha;)x=V(S,ca);return x}},da=function(P){return function(ca){for(var V=P,S=!1,ha;!S;)a:{ha=V;var x=ca;if(x instanceof y&&x.value0 instanceof n&&x.value3 instanceof
n)S=!0,ha=M(ha)(n.value);else{if(x instanceof y)V=new m.Cons(new U(x.value0,x.value1,x.value2),ha),ca=x.value3;else{if(x instanceof K&&x.value0 instanceof n&&x.value3 instanceof n&&x.value6 instanceof n){S=!0;ha=M(new m.Cons(new U(n.value,x.value1,x.value2),ha))(n.value);break a}if(x instanceof K)V=new m.Cons(new F(x.value0,x.value1,x.value2,x.value3,x.value4,x.value5),ha),ca=x.value6;else throw Error("Data.Map.Internal (540:5-544:107): "+[x.constructor.name]);}ha=void 0}}return ha}},O=function(P){for(var ca=
!1,V;!ca;)a:if(V=P,V instanceof y&&V.value3 instanceof n)ca=!0,V={key:V.value1,value:V.value2};else{if(V instanceof y)P=V.value3;else{if(V instanceof K&&V.value6 instanceof n){ca=!0;V={key:V.value4,value:V.value5};break a}if(V instanceof K)P=V.value6;else throw Error("Data.Map.Internal (531:33-535:45): "+[V.constructor.name]);}V=void 0}return V},Y=C.compare(B);return function(P){return function(ca){function V(l,W){if(W instanceof n)return ha=!0,q.Nothing.value;if(W instanceof y){var ja=Y(A)(W.value1);
if(W.value3 instanceof n&&ja instanceof t.EQ)return ha=!0,new q.Just(new G.Tuple(W.value2,M(l)(n.value)));if(ja instanceof t.EQ)return ja=O(W.value0),ha=!0,new q.Just(new G.Tuple(W.value2,da(new m.Cons(new g(ja.key,ja.value,W.value3),l))(W.value0)));ja instanceof t.LT?(S=new m.Cons(new g(W.value1,W.value2,W.value3),l),ca=W.value0):(S=new m.Cons(new U(W.value0,W.value1,W.value2),l),ca=W.value3)}else if(W instanceof K){var oa=W.value0 instanceof n&&W.value3 instanceof n&&W.value6 instanceof n?!0:!1;
ja=Y(A)(W.value4);var xa=Y(A)(W.value1);if(oa&&xa instanceof t.EQ)return ha=!0,new q.Just(new G.Tuple(W.value2,L(B)(l)(new y(n.value,W.value4,W.value5,n.value))));if(oa&&ja instanceof t.EQ)return ha=!0,new q.Just(new G.Tuple(W.value5,L(B)(l)(new y(n.value,W.value1,W.value2,n.value))));if(xa instanceof t.EQ)return ja=O(W.value0),ha=!0,new q.Just(new G.Tuple(W.value2,da(new m.Cons(new H(ja.key,ja.value,W.value3,W.value4,W.value5,W.value6),l))(W.value0)));if(ja instanceof t.EQ)return ja=O(W.value3),
ha=!0,new q.Just(new G.Tuple(W.value5,da(new m.Cons(new z(W.value0,W.value1,W.value2,ja.key,ja.value,W.value6),l))(W.value3)));xa instanceof t.LT?(S=new m.Cons(new H(W.value1,W.value2,W.value3,W.value4,W.value5,W.value6),l),ca=W.value0):xa instanceof t.GT&&ja instanceof t.LT?(S=new m.Cons(new z(W.value0,W.value1,W.value2,W.value4,W.value5,W.value6),l),ca=W.value3):(S=new m.Cons(new F(W.value0,W.value1,W.value2,W.value3,W.value4,W.value5),l),ca=W.value6)}else throw Error("Data.Map.Internal (481:34-504:80): "+
[W.constructor.name]);}for(var S=P,ha=!1,x;!ha;)x=V(S,ca);return x}}(m.Nil.value)}},la=function(B){return function(A){return function(M){return function(da){return function(O){var Y=function(){if(M instanceof q.Just)return function(S){return C.lessThan(B)(S)(M.value0)};if(M instanceof q.Nothing)return e["const"](!1);throw Error("Data.Map.Internal (319:7-323:22): "+[M.constructor.name]);}(),P=function(){if(da instanceof q.Just)return function(S){return C.greaterThan(B)(S)(da.value0)};if(da instanceof
q.Nothing)return e["const"](!1);throw Error("Data.Map.Internal (326:7-330:22): "+[da.constructor.name]);}(),ca=function(){if(M instanceof q.Just&&da instanceof q.Just)return function(S){return C.lessThanOrEq(B)(M.value0)(S)&&C.lessThanOrEq(B)(S)(da.value0)};if(M instanceof q.Just&&da instanceof q.Nothing)return function(S){return C.lessThanOrEq(B)(M.value0)(S)};if(M instanceof q.Nothing&&da instanceof q.Just)return function(S){return C.lessThanOrEq(B)(S)(da.value0)};if(M instanceof q.Nothing&&da instanceof
q.Nothing)return e["const"](!0);throw Error("Data.Map.Internal (333:7-341:21): "+[M.constructor.name,da.constructor.name]);}(),V=function(S){if(S instanceof n)return p.mempty(A);if(S instanceof y)return v.append(A.Semigroup0())(Y(S.value1)?p.mempty(A):V(S.value0))(v.append(A.Semigroup0())(ca(S.value1)?O(S.value1)(S.value2):p.mempty(A))(P(S.value1)?p.mempty(A):V(S.value3)));if(S instanceof K)return v.append(A.Semigroup0())(Y(S.value1)?p.mempty(A):V(S.value0))(v.append(A.Semigroup0())(ca(S.value1)?
O(S.value1)(S.value2):p.mempty(A))(v.append(A.Semigroup0())(Y(S.value4)||P(S.value1)?p.mempty(A):V(S.value3))(v.append(A.Semigroup0())(ca(S.value4)?O(S.value4)(S.value5):p.mempty(A))(P(S.value4)?p.mempty(A):V(S.value6)))));throw Error("Data.Map.Internal (359:10-371:54): "+[S.constructor.name]);};return V}}}}},aa=function(){return function(B){return function(A){for(var M=B,da=!1,O;!da;){O=M;var Y=A;if(Y instanceof n)da=!0;else{if(Y instanceof y)M=new q.Just({key:Y.value1,value:Y.value2}),A=Y.value0;
else if(Y instanceof K)M=new q.Just({key:Y.value1,value:Y.value2}),A=Y.value0;else throw Error("Data.Map.Internal (297:5-297:22): "+[O.constructor.name,Y.constructor.name]);O=void 0}}return O}}(q.Nothing.value)}(),X=function(){return function(B){return function(A){for(var M=B,da=!1,O;!da;){O=M;var Y=A;if(Y instanceof n)da=!0;else{if(Y instanceof y)M=new q.Just({key:Y.value1,value:Y.value2}),A=Y.value3;else if(Y instanceof K)M=new q.Just({key:Y.value4,value:Y.value5}),A=Y.value6;else throw Error("Data.Map.Internal (289:5-289:22): "+
[O.constructor.name,Y.constructor.name]);O=void 0}}return O}}(q.Nothing.value)}(),pa=n.value,ea=function(B){return function(A){return function(M){return q.maybe(M)(G.snd)(Z(B)(A)(M))}}},I=function(B){return function(A){return function(M){return function(da){var O=A(u(B)(M)(da));if(O instanceof q.Nothing)return ea(B)(M)(da);if(O instanceof q.Just)return T(B)(M)(O.value0)(da);throw Error("Data.Map.Internal (549:15-551:25): "+[O.constructor.name]);}}}},ma=function(B){return function(A){return function(M){return function(da){return h.foldl(m.foldableList)(function(O){return function(Y){return I(B)(function(P){return q.Just.create(q.maybe(Y.value1)(A(Y.value1))(P))})(Y.value0)(O)}})(da)(ba(m.unfoldableList)(M))}}}},
va=function(B){return ma(B)(e["const"])},fa=function(B){return new v.Semigroup(va(B))},ua=function(B){return new p.Monoid(function(){return fa(B)},pa)};b.empty=pa;b.isEmpty=function(B){return B instanceof n?!0:!1};b.singleton=J;b.insert=T;b.lookup=u;b.lookupLE=function(B){return function(A){var M=C.compare(B),da=function(O){if(O instanceof n)return q.Nothing.value;if(O instanceof y){var Y=M(A)(O.value1);if(Y instanceof t.EQ)return new q.Just({key:O.value1,value:O.value2});if(Y instanceof t.GT)return q.Just.create(q.fromMaybe({key:O.value1,
value:O.value2})(da(O.value3)));if(Y instanceof t.LT)return da(O.value0);throw Error("Data.Map.Internal (225:33-228:20): "+[Y.constructor.name]);}if(O instanceof K){Y=M(A)(O.value4);if(Y instanceof t.EQ)return new q.Just({key:O.value4,value:O.value5});if(Y instanceof t.GT)return q.Just.create(q.fromMaybe({key:O.value4,value:O.value5})(da(O.value6)));if(Y instanceof t.LT)return da(new y(O.value0,O.value1,O.value2,O.value3));throw Error("Data.Map.Internal (229:45-232:36): "+[Y.constructor.name]);}throw Error("Data.Map.Internal (224:5-224:22): "+
[O.constructor.name]);};return da}};b.lookupLT=function(B){return function(A){var M=C.compare(B),da=function(O){if(O instanceof n)return q.Nothing.value;if(O instanceof y){var Y=M(A)(O.value1);if(Y instanceof t.EQ)return X(O.value0);if(Y instanceof t.GT)return q.Just.create(q.fromMaybe({key:O.value1,value:O.value2})(da(O.value3)));if(Y instanceof t.LT)return da(O.value0);throw Error("Data.Map.Internal (242:33-245:20): "+[Y.constructor.name]);}if(O instanceof K){Y=M(A)(O.value4);if(Y instanceof t.EQ)return X(new y(O.value0,
O.value1,O.value2,O.value3));if(Y instanceof t.GT)return q.Just.create(q.fromMaybe({key:O.value4,value:O.value5})(da(O.value6)));if(Y instanceof t.LT)return da(new y(O.value0,O.value1,O.value2,O.value3));throw Error("Data.Map.Internal (246:45-249:36): "+[Y.constructor.name]);}throw Error("Data.Map.Internal (241:5-241:22): "+[O.constructor.name]);};return da}};b.lookupGE=function(B){return function(A){var M=C.compare(B),da=function(O){if(O instanceof n)return q.Nothing.value;if(O instanceof y){var Y=
M(A)(O.value1);if(Y instanceof t.EQ)return new q.Just({key:O.value1,value:O.value2});if(Y instanceof t.LT)return q.Just.create(q.fromMaybe({key:O.value1,value:O.value2})(da(O.value0)));if(Y instanceof t.GT)return da(O.value3);throw Error("Data.Map.Internal (259:33-262:21): "+[Y.constructor.name]);}if(O instanceof K){Y=M(A)(O.value1);if(Y instanceof t.EQ)return new q.Just({key:O.value1,value:O.value2});if(Y instanceof t.LT)return q.Just.create(q.fromMaybe({key:O.value1,value:O.value2})(da(O.value0)));
if(Y instanceof t.GT)return da(new y(O.value3,O.value4,O.value5,O.value6));throw Error("Data.Map.Internal (263:45-266:37): "+[Y.constructor.name]);}throw Error("Data.Map.Internal (258:5-258:22): "+[O.constructor.name]);};return da}};b.lookupGT=function(B){return function(A){var M=C.compare(B),da=function(O){if(O instanceof n)return q.Nothing.value;if(O instanceof y){var Y=M(A)(O.value1);if(Y instanceof t.EQ)return aa(O.value3);if(Y instanceof t.LT)return q.Just.create(q.fromMaybe({key:O.value1,value:O.value2})(da(O.value0)));
if(Y instanceof t.GT)return da(O.value3);throw Error("Data.Map.Internal (276:33-279:21): "+[Y.constructor.name]);}if(O instanceof K){Y=M(A)(O.value1);if(Y instanceof t.EQ)return aa(new y(O.value3,O.value4,O.value5,O.value6));if(Y instanceof t.LT)return q.Just.create(q.fromMaybe({key:O.value1,value:O.value2})(da(O.value0)));if(Y instanceof t.GT)return da(new y(O.value3,O.value4,O.value5,O.value6));throw Error("Data.Map.Internal (280:45-283:37): "+[Y.constructor.name]);}throw Error("Data.Map.Internal (275:5-275:22): "+
[O.constructor.name]);};return da}};b.findMin=aa;b.findMax=X;b.foldSubmap=la;b.submap=function(B){return function(A){return function(M){return la(B)(ua(B))(A)(M)(J)}}};b.fromFoldable=function(B){return function(A){return h.foldl(A)(function(M){return function(da){return T(B)(da.value0)(da.value1)(M)}})(pa)}};b.toUnfoldable=ba;b.pop=Z;b.alter=I;b.keys=Q;b.values=r;b.union=va;b.unionWith=ma;b.semigroupMap=fa;b.monoidMap=ua;b.functorMap=R;b.functorWithIndexMap=w})(PS);
(function(a){a["Data.Map"]=a["Data.Map"]||{};var b=a["Data.Functor"],c=a["Data.Map.Internal"];a["Data.Map"].keys=function(h){return b["void"](c.functorMap)(h)}})(PS);
(function(a){a["Data.Set"]=a["Data.Set"]||{};var b=a["Data.Set"],c=a["Data.Foldable"],h=a["Data.List"],e=a["Data.List.Types"],k=a["Data.Map.Internal"],d=function(q){return function(p){return function(C){return k.union(q)(p)(C)}}};a=new c.Foldable(function(q){return function(p){return function(C){return c.foldMap(e.foldableList)(q)(p)(k.keys(C))}}},function(q){return function(p){return function(C){return c.foldl(e.foldableList)(q)(p)(k.keys(C))}}},function(q){return function(p){return function(C){return c.foldr(e.foldableList)(q)(p)(k.keys(C))}}});
var m=k.empty;b.toUnfoldable=function(q){return function(p){return h.toUnfoldable(q)(k.keys(p))}};b.empty=m;b.union=d;b.unions=function(q){return function(p){return c.foldl(q)(d(p))(m)}};b.foldableSet=a})(PS);
(function(a){var b="function"===typeof Array.from,c="undefined"!==typeof Symbol&&null!=Symbol&&"undefined"!==typeof Symbol.iterator&&"function"===typeof String.prototype[Symbol.iterator],h="function"===typeof String.prototype.fromCodePoint,e="function"===typeof String.prototype.codePointAt;a._unsafeCodePointAt0=function(k){return e?function(d){return d.codePointAt(0)}:k};a._singleton=function(k){return h?String.fromCodePoint:k};a._take=function(k){return function(d){return c?function(m){var q="";
m=m[Symbol.iterator]();for(var p=0;p<d;++p){var C=m.next();if(C.done)break;q+=C.value}return q}:k(d)}};a._toCodePointArray=function(k){return function(d){return b?function(m){return Array.from(m,d)}:k}}})(PS["Data.String.CodePoints"]=PS["Data.String.CodePoints"]||{});
(function(a){a.toCharArray=function(b){return b.split("")};a.singleton=function(b){return b};a.length=function(b){return b.length};a._indexOf=function(b){return function(c){return function(h){return function(e){e=e.indexOf(h);return-1===e?c:b(e)}}}};a.take=function(b){return function(c){return c.substr(0,b)}};a.drop=function(b){return function(c){return c.substring(b)}}})(PS["Data.String.CodeUnits"]=PS["Data.String.CodeUnits"]||{});
(function(a){a["Data.String.CodeUnits"]=a["Data.String.CodeUnits"]||{};var b=a["Data.String.CodeUnits"],c=a["Data.String.CodeUnits"];a=a["Data.Maybe"];a=c._indexOf(a.Just.create)(a.Nothing.value);b.indexOf=a;b.singleton=c.singleton;b.toCharArray=c.toCharArray;b.length=c.length;b.take=c.take;b.drop=c.drop})(PS);
(function(a){a.charAt=function(b){return function(c){if(0<=b&&b<c.length)return c.charAt(b);throw Error("Data.String.Unsafe.charAt: Invalid index.");}}})(PS["Data.String.Unsafe"]=PS["Data.String.Unsafe"]||{});(function(a){a["Data.String.Unsafe"]=a["Data.String.Unsafe"]||{};a["Data.String.Unsafe"].charAt=a["Data.String.Unsafe"].charAt})(PS);
(function(a){a["Data.String.CodePoints"]=a["Data.String.CodePoints"]||{};var b=a["Data.String.CodePoints"],c=a["Data.String.CodePoints"],h=a["Data.Array"],e=a["Data.Bounded"],k=a["Data.Enum"],d=a["Data.EuclideanRing"],m=a["Data.Functor"],q=a["Data.Maybe"],p=a["Data.String.CodeUnits"],C=a["Data.String.Unsafe"],t=a["Data.Tuple"],v=a["Data.Unfoldable"],G=function(F){return function(N){return((1024*(F-55296|0)|0)+(N-56320|0)|0)+65536|0}},D=function(F){var N=p.length(F);if(0===N)return q.Nothing.value;
if(1===N)return new q.Just({head:k.fromEnum(k.boundedEnumChar)(C.charAt(0)(F)),tail:""});N=k.fromEnum(k.boundedEnumChar)(C.charAt(1)(F));var r=k.fromEnum(k.boundedEnumChar)(C.charAt(0)(F));return 55296<=r&&56319>=r&&56320<=N&&57343>=N?new q.Just({head:G(r)(N),tail:p.drop(2)(F)}):new q.Just({head:r,tail:p.drop(1)(F)})},n=function(F){return m.map(q.functorMaybe)(function(N){return new t.Tuple(N.head,N.tail)})(D(F))};a=c._unsafeCodePointAt0(function(F){var N=k.fromEnum(k.boundedEnumChar)(C.charAt(0)(F));
return 55296<=N&&56319>=N&&1<p.length(F)&&(F=k.fromEnum(k.boundedEnumChar)(C.charAt(1)(F)),56320<=F&&57343>=F)?G(N)(F):N});var y=c._toCodePointArray(function(F){return v.unfoldr(v.unfoldableArray)(n)(F)})(a),K=function(F){return h.length(y(F))},g=function(F){return p.singleton(k.toEnumWithDefaults(k.boundedEnumChar)(e.bottom(e.boundedChar))(e.top(e.boundedChar))(F))},U=c._singleton(function(F){if(65535>=F)return g(F);var N=d.div(d.euclideanRingInt)(F-65536|0)(1024)+55296|0;F=d.mod(d.euclideanRingInt)(F-
65536|0)(1024)+56320|0;return g(N)+g(F)}),H=function(F){return function(N){if(1>F)return"";var r=D(N);return r instanceof q.Just?U(r.value0.head)+H(F-1|0)(r.value0.tail):N}},z=c._take(H);b.singleton=U;b.toCodePointArray=y;b.uncons=D;b.length=K;b.indexOf=function(F){return function(N){return m.map(q.functorMaybe)(function(r){return K(p.take(r)(N))})(p.indexOf(F)(N))}};b.take=z;b.drop=function(F){return function(N){return p.drop(p.length(z(F)(N)))(N)}}})(PS);
(function(a){a.replace=function(b){return function(c){return function(h){return h.replace(b,c)}}};a.replaceAll=function(b){return function(c){return function(h){return h.replace(new RegExp(b.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),c)}}};a.toUpper=function(b){return b.toUpperCase()}})(PS["Data.String.Common"]=PS["Data.String.Common"]||{});
(function(a){a["Data.String.Common"]=a["Data.String.Common"]||{};var b=a["Data.String.Common"];a=a["Data.String.Common"];b.replaceAll=a.replaceAll;b.toUpper=a.toUpper})(PS);
(function(a){a["regex'"]=function(b){return function(c){return function(h){return function(e){try{return c(new RegExp(h,e))}catch(k){return b(k.message)}}}}};a.test=function(b){return function(c){var h=b.lastIndex;c=b.test(c);b.lastIndex=h;return c}};a.replace=function(b){return function(c){return function(h){return h.replace(b,c)}}}})(PS["Data.String.Regex"]=PS["Data.String.Regex"]||{});
(function(a){a["Data.String.Regex"]=a["Data.String.Regex"]||{};var b=a["Data.String.Regex"],c=a["Data.String.Regex"],h=a["Data.Either"],e=function(k){var d=k.value0.global?"g":"";var m=k.value0.ignoreCase?"i":"";var q=k.value0.multiline?"m":"";var p=k.value0.sticky?"y":"";k=k.value0.unicode?"u":"";return d+(m+(q+(p+k)))};b.regex=function(k){return function(d){return c["regex'"](h.Left.create)(h.Right.create)(k)(e(d))}};b.renderFlags=e;b.test=c.test;b.replace=c.replace})(PS);
(function(a){a["Data.String.Regex.Flags"]=a["Data.String.Regex.Flags"]||{};a=a["Data.String.Regex.Flags"];var b=function(){function h(e){this.value0=e}h.create=function(e){return new h(e)};return h}(),c=new b({global:!1,ignoreCase:!1,multiline:!1,sticky:!1,unicode:!1});a.RegexFlags=b;a.noFlags=c})(PS);
(function(a){a["Data.Time.Duration"]=a["Data.Time.Duration"]||{};var b=a["Data.Time.Duration"],c=a["Control.Category"],h=a["Data.Newtype"],e=a["Data.Ord"],k=a["Data.Ring"],d=function(v){return v},m=function(v){return v},q=function(v,G){this.fromDuration=v;this.toDuration=G};a=new a["Data.Semigroup"].Semigroup(function(v){return function(G){return v+G}});e=e.ordNumber;var p=new h.Newtype(function(v){return v},d),C=new h.Newtype(function(v){return v},m),t=new q(h.over(p)(C)(d)(function(v){return 1E3*
v}),h.over(C)(p)(m)(function(v){return v/1E3}));c=new q(c.identity(c.categoryFn),c.identity(c.categoryFn));b.fromDuration=function(v){return v.fromDuration};b.toDuration=function(v){return v.toDuration};b.Milliseconds=m;b.Seconds=d;b.Duration=q;b.convertDuration=function(v){return function(G){return function(D){return(0,G.toDuration)((0,v.fromDuration)(D))}}};b.negateDuration=function(v){return function(G){return(0,v.toDuration)(h.over(C)(C)(m)(k.negate(k.ringNumber))((0,v.fromDuration)(G)))}};b.newtypeMilliseconds=
C;b.newtypeSeconds=p;b.ordSeconds=e;b.semigroupSeconds=a;b.durationMilliseconds=c;b.durationSeconds=t})(PS);(function(a){a.getWindowDims=function(){return{width:window.innerWidth,height:window.innerHeight}};a.numMod=function(b){return function(c){return b%c}}})(PS.Draw=PS.Draw||{});
(function(a){a.setBaseline=function(b){return function(c){return function(){b.textBaseline=c}}};a.roundRect=function(b){return function(c){return function(){var h=c.x,e=c.y,k=c.width,d=c.height,m=c.radius,q=c.fill,p=c.stroke;"undefined"==typeof p&&(p=!0);"undefined"===typeof m&&(m=5);if("number"===typeof m)m={tl:m,tr:m,br:m,bl:m};else{var C={tl:0,tr:0,br:0,bl:0},t;for(t in C)m[t]=m[t]||C[t]}b.beginPath();b.moveTo(h+m.tl,e);b.lineTo(h+k-m.tr,e);b.quadraticCurveTo(h+k,e,h+k,e+m.tr);b.lineTo(h+k,e+d-
m.br);b.quadraticCurveTo(h+k,e+d,h+k-m.br,e+d);b.lineTo(h+m.bl,e+d);b.quadraticCurveTo(h,e+d,h,e+d-m.bl);b.lineTo(h,e+m.tl);b.quadraticCurveTo(h,e,h+m.tl,e);b.closePath();q&&b.fill();p&&b.stroke()}}}})(PS["Draw.Common"]=PS["Draw.Common"]||{});
(function(a){a.tryLoadImageImpl=function(b){return function(c){return function(h){return function(){var e=new Image;e.src=b;e.addEventListener("load",function(){h(e)()},!1);e.addEventListener("error",function(k){c()},!1)}}}};a.getCanvasElementByIdImpl=function(b,c,h){return function(){var e=document.getElementById(b);return e&&e instanceof HTMLCanvasElement?c(e):h}};a.getContext2D=function(b){return function(){return b.getContext("2d")}};a.getCanvasWidth=function(b){return function(){return b.width}};
a.getCanvasHeight=function(b){return function(){return b.height}};a.setCanvasWidth=function(b){return function(c){return function(){b.width=c}}};a.setCanvasHeight=function(b){return function(c){return function(){b.height=c}}};a.setLineWidth=function(b){return function(c){return function(){b.lineWidth=c}}};a.setFillStyle=function(b){return function(c){return function(){b.fillStyle=c}}};a.setStrokeStyle=function(b){return function(c){return function(){b.strokeStyle=c}}};a.setLineCapImpl=function(b){return function(c){return function(){b.lineCap=
c}}};a.setGlobalAlpha=function(b){return function(c){return function(){b.globalAlpha=c}}};a.beginPath=function(b){return function(){b.beginPath()}};a.stroke=function(b){return function(){b.stroke()}};a.fill=function(b){return function(){b.fill()}};a.clip=function(b){return function(){b.clip()}};a.lineTo=function(b){return function(c){return function(h){return function(){b.lineTo(c,h)}}}};a.moveTo=function(b){return function(c){return function(h){return function(){b.moveTo(c,h)}}}};a.closePath=function(b){return function(){b.closePath()}};
a.arc=function(b){return function(c){return function(){b.arc(c.x,c.y,c.radius,c.start,c.end)}}};a.rect=function(b){return function(c){return function(){b.rect(c.x,c.y,c.width,c.height)}}};a.fillRect=function(b){return function(c){return function(){b.fillRect(c.x,c.y,c.width,c.height)}}};a.strokeRect=function(b){return function(c){return function(){b.strokeRect(c.x,c.y,c.width,c.height)}}};a.scale=function(b){return function(c){return function(){b.scale(c.scaleX,c.scaleY)}}};a.rotate=function(b){return function(c){return function(){b.rotate(c)}}};
a.translate=function(b){return function(c){return function(){b.translate(c.translateX,c.translateY)}}};a.setTransform=function(b){return function(c){return function(){b.setTransform(c.m11,c.m12,c.m21,c.m22,c.m31,c.m32)}}};a.setTextAlignImpl=function(b){return function(c){return function(){b.textAlign=c}}};a.font=function(b){return function(){return b.font}};a.setFont=function(b){return function(c){return function(){b.font=c}}};a.fillText=function(b){return function(c){return function(h){return function(e){return function(){b.fillText(c,
h,e)}}}}};a.measureText=function(b){return function(c){return function(){return b.measureText(c)}}};a.save=function(b){return function(){b.save()}};a.restore=function(b){return function(){b.restore()}};a.drawImage=function(b){return function(c){return function(h){return function(e){return function(){b.drawImage(c,h,e)}}}}};a.drawImageScale=function(b){return function(c){return function(h){return function(e){return function(k){return function(d){return function(){b.drawImage(c,h,e,k,d)}}}}}}}})(PS["Graphics.Canvas"]=
PS["Graphics.Canvas"]||{});
(function(a){a["Graphics.Canvas"]=a["Graphics.Canvas"]||{};var b=a["Graphics.Canvas"],c=a["Graphics.Canvas"],h=a["Control.Apply"],e=a["Data.Maybe"],k=a.Effect,d=function(){function D(){}D.value=new D;return D}(),m=function(){function D(){}D.value=new D;return D}(),q=function(){function D(){}D.value=new D;return D}(),p=function(){function D(){}D.value=new D;return D}(),C=function(){function D(){}D.value=new D;return D}(),t=function(){function D(){}D.value=new D;return D}(),v=function(){function D(){}
D.value=new D;return D}(),G=function(){function D(){}D.value=new D;return D}();b.Round=t;b.Square=v;b.Butt=G;b.AlignLeft=d;b.AlignRight=m;b.AlignCenter=q;b.AlignStart=p;b.AlignEnd=C;b.getCanvasElementById=function(D){return c.getCanvasElementByIdImpl(D,e.Just.create,e.Nothing.value)};b.getCanvasDimensions=function(D){return function(){var n=c.getCanvasWidth(D)(),y=c.getCanvasHeight(D)();return{width:n,height:y}}};b.setCanvasDimensions=function(D){return function(n){return h.applySecond(k.applyEffect)(c.setCanvasHeight(D)(n.height))(c.setCanvasWidth(D)(n.width))}};
b.setLineCap=function(D){return function(n){if(n instanceof t)return c.setLineCapImpl(D)("round");if(n instanceof v)return c.setLineCapImpl(D)("square");if(n instanceof G)return c.setLineCapImpl(D)("butt");throw Error("Graphics.Canvas (234:1-234:50): "+[D.constructor.name,n.constructor.name]);}};b.strokePath=function(D){return function(n){return function(){c.beginPath(D)();var y=n();c.stroke(D)();return y}}};b.setTextAlign=function(D){return function(n){return c.setTextAlignImpl(D)(function(y){if(y instanceof
d)return"left";if(y instanceof m)return"right";if(y instanceof q)return"center";if(y instanceof p)return"start";if(y instanceof C)return"end";throw Error("Graphics.Canvas (518:5-519:5): "+[y.constructor.name]);}(n))}};b.withContext=function(D){return function(n){return function(){c.save(D)();var y=n();c.restore(D)();return y}}};b.tryLoadImage=function(D){return function(n){return c.tryLoadImageImpl(D)(n(e.Nothing.value))(function(y){return n(e.Just.create(y))})}};b.getContext2D=c.getContext2D;b.getCanvasWidth=
c.getCanvasWidth;b.getCanvasHeight=c.getCanvasHeight;b.setLineWidth=c.setLineWidth;b.setFillStyle=c.setFillStyle;b.setStrokeStyle=c.setStrokeStyle;b.setGlobalAlpha=c.setGlobalAlpha;b.beginPath=c.beginPath;b.stroke=c.stroke;b.fill=c.fill;b.clip=c.clip;b.lineTo=c.lineTo;b.moveTo=c.moveTo;b.closePath=c.closePath;b.arc=c.arc;b.rect=c.rect;b.fillRect=c.fillRect;b.strokeRect=c.strokeRect;b.scale=c.scale;b.rotate=c.rotate;b.translate=c.translate;b.setTransform=c.setTransform;b.setFont=c.setFont;b.fillText=
c.fillText;b.measureText=c.measureText;b.save=c.save;b.restore=c.restore;b.drawImage=c.drawImage;b.drawImageScale=c.drawImageScale})(PS);
(function(a){a.OnyxMap=a.OnyxMap||{};var b=a.OnyxMap,c=a["Control.Monad.ST.Internal"],h=a["Data.Array.ST"],e=a["Data.Functor"],k=a["Data.Functor.App"],d=a["Data.Map.Internal"],m=a["Data.Maybe"],q=a["Data.Monoid"],p=a["Data.Monoid.Dual"],C=a["Data.Tuple"];b.zoomAscDo=function(t){return function(v){return function(G){return function(D){return function(n){return function(y){return d.foldSubmap(t)(k.monoidApp(v.Applicative0())(q.monoidUnit))(new m.Just(G))(new m.Just(D))(function(K){return function(g){return k.App(y(K)(g))}})(n)}}}}}};b.zoomDescDo=
function(t){return function(v){return function(G){return function(D){return function(n){return function(y){return d.foldSubmap(t)(p.monoidDual(k.monoidApp(v.Applicative0())(q.monoidUnit)))(new m.Just(G))(new m.Just(D))(function(K){return function(g){return p.Dual(k.App(y(K)(g)))}})(n)}}}}}};b.doTupleArray=function(t){return function(){var v=h.empty();t(c.monadST)(function(G){return function(D){return e["void"](c.functorST)(h.push(new C.Tuple(G,D))(v))}})();return h.freeze(v)()}()}})(PS);
(function(a){a.unsafeFromForeign=function(b){return b};a.typeOf=function(b){return typeof b};a.tagOf=function(b){return Object.prototype.toString.call(b).slice(8,-1)};a.isNull=function(b){return null===b};a.isUndefined=function(b){return void 0===b};a.isArray=Array.isArray||function(b){return"[object Array]"===Object.prototype.toString.call(b)}})(PS.Foreign=PS.Foreign||{});
(function(a){a.Foreign=a.Foreign||{};var b=a.Foreign,c=a.Foreign,h=a["Control.Applicative"],e=a["Control.Monad.Error.Class"],k=a["Control.Monad.Except"],d=a["Control.Monad.Except.Trans"],m=a["Data.Boolean"],q=a["Data.Either"],p=a["Data.Function"],C=a["Data.Identity"],t=a["Data.Int"],v=a["Data.List.NonEmpty"],G=a["Data.Maybe"],D=a["Data.Show"],n=function(){function r(J){this.value0=J}r.create=function(J){return new r(J)};return r}(),y=function(){function r(J,ba){this.value0=J;this.value1=ba}r.create=
function(J){return function(ba){return new r(J,ba)}};return r}(),K=function(){function r(J,ba){this.value0=J;this.value1=ba}r.create=function(J){return function(ba){return new r(J,ba)}};return r}(),g=function(){function r(J,ba){this.value0=J;this.value1=ba}r.create=function(J){return function(ba){return new r(J,ba)}};return r}(),U=new D.Show(function(r){if(r instanceof n)return"(ForeignError "+(D.show(D.showString)(r.value0)+")");if(r instanceof K)return"(ErrorAtIndex "+(D.show(D.showInt)(r.value0)+
(" "+(D.show(U)(r.value1)+")")));if(r instanceof g)return"(ErrorAtProperty "+(D.show(D.showString)(r.value0)+(" "+(D.show(U)(r.value1)+")")));if(r instanceof y)return"(TypeMismatch "+(D.show(D.showString)(r.value0)+(" "+(D.show(D.showString)(r.value1)+")")));throw Error("Foreign (63:1-63:47): "+[r.constructor.name]);}),H=function(r){return e.throwError(d.monadThrowExceptT(C.monadIdentity))(v.singleton(r))};a=function(r){return function(J){if(c.tagOf(J)===r)return h.pure(d.applicativeExceptT(C.monadIdentity))(c.unsafeFromForeign(J));
if(m.otherwise)return H(new y(r,c.tagOf(J)));throw Error("Foreign (106:1-106:55): "+[r.constructor.name,J.constructor.name]);}};var z=a("Boolean"),F=a("Number"),N=a("String");b.ForeignError=n;b.TypeMismatch=y;b.ErrorAtIndex=K;b.ErrorAtProperty=g;b.unsafeReadTagged=a;b.readString=N;b.readBoolean=z;b.readNumber=F;b.readInt=function(r){var J=q.Left.create(v.singleton(new y("Int",c.tagOf(r))));return k.mapExcept(q.either(p["const"](J))(function(ba){return G.maybe(J)(h.pure(q.applicativeEither))(t.fromNumber(ba))}))(F(r))};
b.readArray=function(r){if(c.isArray(r))return h.pure(d.applicativeExceptT(C.monadIdentity))(c.unsafeFromForeign(r));if(m.otherwise)return H(new y("array",c.tagOf(r)));throw Error("Foreign (147:1-147:42): "+[r.constructor.name]);};b.readNullOrUndefined=function(r){if(c.isNull(r)||c.isUndefined(r))return h.pure(d.applicativeExceptT(C.monadIdentity))(G.Nothing.value);if(m.otherwise)return h.pure(d.applicativeExceptT(C.monadIdentity))(new G.Just(r));throw Error("Foreign (162:1-162:52): "+[r.constructor.name]);
};b.fail=H;b.showForeignError=U;b.typeOf=c.typeOf;b.isNull=c.isNull;b.isUndefined=c.isUndefined})(PS);(function(a){a.unsafeReadPropImpl=function(b,c,h,e){return null==e?b:c(e[h])}})(PS["Foreign.Index"]=PS["Foreign.Index"]||{});
(function(a){a["Foreign.Index"]=a["Foreign.Index"]||{};var b=a["Foreign.Index"],c=a["Foreign.Index"],h=a["Control.Applicative"],e=a["Control.Monad.Except.Trans"],k=a["Data.Identity"],d=a.Foreign;a=function(m){return function(q){return c.unsafeReadPropImpl(d.fail(new d.TypeMismatch("object",d.typeOf(q))),h.pure(e.applicativeExceptT(k.monadIdentity)),m,q)}};b.readProp=a;b.readIndex=a})(PS);
(function(a){a.Song=a.Song||{};var b=a.Song,c=a["Control.Applicative"],h=a["Control.Apply"],e=a["Control.Bind"],k=a["Control.Monad.Error.Class"],d=a["Control.Monad.Except.Trans"],m=a["Control.Monad.State.Class"],q=a["Control.Monad.State.Trans"],p=a["Control.Monad.Trans.Class"],C=a["Data.Array"],t=a["Data.Boolean"],v=a["Data.Eq"],G=a["Data.EuclideanRing"],D=a["Data.Foldable"],n=a["Data.Function"],y=a["Data.Functor"],K=a["Data.FunctorWithIndex"],g=a["Data.Identity"],U=a["Data.Int"],H=a["Data.List"],
z=a["Data.List.Types"],F=a["Data.Map"],N=a["Data.Map.Internal"],r=a["Data.Maybe"],J=a["Data.Newtype"],ba=a["Data.Ord"],u=a["Data.Ordering"],Q=a["Data.Semigroup"],R=a["Data.Set"],w=a["Data.Show"],L=a["Data.String.CodePoints"],T=a["Data.String.CodeUnits"],Z=a["Data.String.Common"],la=a["Data.Time.Duration"],aa=a["Data.Traversable"],X=a["Data.Tuple"],pa=a["Data.Unit"],ea=a.Foreign,I=a["Foreign.Index"],ma=function(){function f(){}f.value=new f;return f}(),va=function(){function f(E,ra){this.value0=E;
this.value1=ra}f.create=function(E){return function(ra){return new f(E,ra)}};return f}(),fa=function(){function f(E,ra){this.value0=E;this.value1=ra}f.create=function(E){return function(ra){return new f(E,ra)}};return f}(),ua=function(){function f(){}f.value=new f;return f}(),B=function(){function f(){}f.value=new f;return f}(),A=function(){function f(E){this.value0=E}f.create=function(E){return new f(E)};return f}(),M=function(){function f(E){this.value0=E}f.create=function(E){return new f(E)};return f}(),
da=function(){function f(){}f.value=new f;return f}(),O=function(){function f(){}f.value=new f;return f}(),Y=function(f){return f},P=function(){function f(){}f.value=new f;return f}(),ca=function(){function f(){}f.value=new f;return f}(),V=function(){function f(){}f.value=new f;return f}(),S=function(){function f(){}f.value=new f;return f}(),ha=function(){function f(){}f.value=new f;return f}(),x=function(){function f(){}f.value=new f;return f}(),l=function(){function f(){}f.value=new f;return f}(),
W=function(){function f(){}f.value=new f;return f}(),ja=function(){function f(){}f.value=new f;return f}(),oa=function(){function f(){}f.value=new f;return f}(),xa=function(){function f(){}f.value=new f;return f}(),Aa=function(){function f(){}f.value=new f;return f}(),sa=function(){function f(){}f.value=new f;return f}(),wa=function(){function f(){}f.value=new f;return f}(),Fa=function(){function f(){}f.value=new f;return f}(),Ca=function(){function f(){}f.value=new f;return f}(),Ea=function(){function f(){}
f.value=new f;return f}(),Ia=function(){function f(){}f.value=new f;return f}(),Ja=function(){function f(){}f.value=new f;return f}(),Ha=function(){function f(){}f.value=new f;return f}(),Ga=function(){function f(){}f.value=new f;return f}(),Ma=function(){function f(){}f.value=new f;return f}(),Na=function(){function f(){}f.value=new f;return f}(),Oa=function(){function f(){}f.value=new f;return f}(),Pa=function(){function f(){}f.value=new f;return f}(),Qa=function(){function f(){}f.value=new f;return f}(),
Ra=function(){function f(){}f.value=new f;return f}(),Sa=function(){function f(){}f.value=new f;return f}(),Ta=function(){function f(){}f.value=new f;return f}(),Ua=function(){function f(){}f.value=new f;return f}(),fb=function(){function f(){}f.value=new f;return f}(),jb=function(){function f(){}f.value=new f;return f}(),kb=function(){function f(){}f.value=new f;return f}(),lb=function(){function f(){}f.value=new f;return f}(),$a=function(){function f(){}f.value=new f;return f}(),Ka=function(){function f(){}
f.value=new f;return f}(),ab=function(){function f(){}f.value=new f;return f}(),bb=function(){function f(){}f.value=new f;return f}(),cb=function(){function f(){}f.value=new f;return f}(),db=function(){function f(){}f.value=new f;return f}(),Va=function(){function f(){}f.value=new f;return f}(),La=function(){function f(){}f.value=new f;return f}(),Wa=function(){function f(){}f.value=new f;return f}(),Xa=function(){function f(){}f.value=new f;return f}(),eb=function(){function f(){}f.value=new f;return f}(),
Ya=function(){function f(){}f.value=new f;return f}(),gb=function(){function f(){}f.value=new f;return f}(),Gb=function(f){return f},ub=function(){function f(){}f.value=new f;return f}(),Hb=function(){function f(){}f.value=new f;return f}(),Ib=function(){function f(){}f.value=new f;return f}(),Jb=function(){function f(){}f.value=new f;return f}(),vb=function(){function f(){}f.value=new f;return f}(),wb=function(){function f(){}f.value=new f;return f}(),xb=function(){function f(){}f.value=new f;return f}(),
yb=function(){function f(){}f.value=new f;return f}(),mb=function(){function f(){}f.value=new f;return f}(),zb=function(){function f(){}f.value=new f;return f}(),Kb=function(){function f(){}f.value=new f;return f}(),Lb=function(){function f(){}f.value=new f;return f}(),Mb=function(){function f(){}f.value=new f;return f}(),Nb=function(){function f(){}f.value=new f;return f}(),Ob=function(){function f(){}f.value=new f;return f}(),Pb=function(){function f(){}f.value=new f;return f}(),Ba=function(f){return function(E){var ra=
function(ka){return function(ia){return r.maybe(k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(new ea.ForeignError("index error, shouldn't happen"))))(c.pure(d.applicativeExceptT(g.monadIdentity)))(C.index(ka)(ia))}},ta=function(ka){return function(ia){return e.bind(q.bindStateT(d.monadExceptT(g.monadIdentity)))(m.get(q.monadStateStateT(d.monadExceptT(g.monadIdentity))))(function(na){return e.bind(q.bindStateT(d.monadExceptT(g.monadIdentity)))(p.lift(q.monadTransStateT)(d.monadExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(ra(ka)(2*
ia|0))(ea.readInt)))(function(qa){return e.bind(q.bindStateT(d.monadExceptT(g.monadIdentity)))(p.lift(q.monadTransStateT)(d.monadExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(ra(ka)((2*ia|0)+1|0))(f)))(function(ya){return e.bind(q.bindStateT(d.monadExceptT(g.monadIdentity)))(m.modify(q.monadStateStateT(d.monadExceptT(g.monadIdentity)))(function(za){return za+qa|0}))(function(za){return c.pure(q.applicativeStateT(d.monadExceptT(g.monadIdentity)))(new X.Tuple(la.Seconds(za/1E3),ya))})})})})}};
return y.map(d.functorExceptT(g.functorIdentity))(N.fromFoldable(la.ordSeconds)(D.foldableArray))(e.bind(d.bindExceptT(g.monadIdentity))(ea.readArray(E))(function(ka){var ia=q.evalStateT(d.functorExceptT(g.functorIdentity)),na=aa.traverse(aa.traversableArray)(q.applicativeStateT(d.monadExceptT(g.monadIdentity)))(ta(ka));ka=2>C.length(ka)?[]:C.range(0)(G.div(G.euclideanRingInt)(C.length(ka))(2)-1|0);return ia(na(ka))(0)}))}},pb=function(f){return y.map(d.functorExceptT(g.functorIdentity))(y.map(N.functorMap)(function(E){return pa.unit}))(Ba(c.pure(d.applicativeExceptT(g.monadIdentity)))(f))},
oc=new J.Newtype(function(f){return f},Y),pc=new J.Newtype(function(f){return f},Gb),Qb=function(f){return ea.isNull(f)?c.pure(d.applicativeExceptT(g.monadIdentity))(ma.value):h.apply(d.applyExceptT(g.monadIdentity))(y.map(d.functorExceptT(g.functorIdentity))(va.create)(e.bind(d.bindExceptT(g.monadIdentity))(I.readIndex(0)(f))(ea.readInt)))(e.bind(d.bindExceptT(g.monadIdentity))(I.readIndex(1)(f))(ea.readInt))},qb=function(f){return ea.isNull(f)?c.pure(d.applicativeExceptT(g.monadIdentity))(ua.value):
e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readIndex(0)(f))(ea.readString))(function(E){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readIndex(1)(f))(ea.readNullOrUndefined))(aa.traverse(aa.traversableMaybe)(d.applicativeExceptT(g.monadIdentity))(ea.readInt)))(function(ra){return c.pure(d.applicativeExceptT(g.monadIdentity))(new fa(E,ra))})})},Rb=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(ea.readString(f))(function(E){return"c"===
E?c.pure(d.applicativeExceptT(g.monadIdentity))(P.value):"d"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(ca.value):"e"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(V.value):"f"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(S.value):"g"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(ha.value):"a"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(x.value):k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("pro keys range")(w.show(w.showString)(E))))})},
Sb=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(ea.readString(f))(function(E){var ra=function(qa){var ya=U.fromString(qa.str);if(ya instanceof r.Nothing)return function(za){return k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("protar note event")(w.show(w.showString)(E))))};if(ya instanceof r.Just)return function(za){return c.pure(d.applicativeExceptT(g.monadIdentity))(za({fret:new r.Just(ya.value0),phantom:qa.phantom,slide:qa.slide}))};
throw Error("Song (481:21-483:88): "+[ya.constructor.name]);},ta=function(qa){qa="p"===L.take(1)(qa.str)?{phantom:!0,slide:qa.slide,str:L.drop(1)(qa.str)}:{phantom:!1,slide:qa.slide,str:qa.str};return ra(qa)},ka=function(qa){return"x"===qa.str?function(ya){return c.pure(d.applicativeExceptT(g.monadIdentity))(ya({fret:r.Nothing.value,phantom:!1,slide:qa.slide}))}:ta(qa)},ia=function(qa){var ya=L.take(1)(qa.str);qa="u"===ya?{slide:new r.Just(da.value),str:L.drop(1)(qa.str)}:"d"===ya?{slide:new r.Just(O.value),
str:L.drop(1)(qa.str)}:{slide:r.Nothing.value,str:qa.str};return ka(qa)},na=L.take(1)(E);return"e"===na?c.pure(d.applicativeExceptT(g.monadIdentity))(B.value):"s"===na?ia({str:L.drop(1)(E)})(function(qa){return A.create({noteType:jb.value,fret:qa.fret,phantom:qa.phantom,slide:qa.slide})}):"h"===na?ia({str:L.drop(1)(E)})(function(qa){return A.create({noteType:kb.value,fret:qa.fret,phantom:qa.phantom,slide:qa.slide})}):"t"===na?ia({str:L.drop(1)(E)})(function(qa){return A.create({noteType:lb.value,
fret:qa.fret,phantom:qa.phantom,slide:qa.slide})}):"S"===na?ia({str:L.drop(1)(E)})(function(qa){return M.create({noteType:jb.value,fret:qa.fret,phantom:qa.phantom,slide:qa.slide})}):"H"===na?ia({str:L.drop(1)(E)})(function(qa){return M.create({noteType:kb.value,fret:qa.fret,phantom:qa.phantom,slide:qa.slide})}):"T"===na?ia({str:L.drop(1)(E)})(function(qa){return M.create({noteType:lb.value,fret:qa.fret,phantom:qa.phantom,slide:qa.slide})}):k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("protar note event")(w.show(w.showString)(E))))})},
Tb=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(ea.readString(f))(function(E){return"e"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(B.value):"n"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(new A(pa.unit)):"N"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(new M(pa.unit)):k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("pro keys note event")(w.show(w.showString)(E))))})},Ab=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(ea.readString(f))(function(E){return"e"===
E?c.pure(d.applicativeExceptT(g.monadIdentity))(B.value):"s"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(new A(jb.value)):"h"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(new A(kb.value)):"t"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(new A(lb.value)):"S"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(new M(jb.value)):"H"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(new M(kb.value)):"T"===E?c.pure(d.applicativeExceptT(g.monadIdentity))(new M(lb.value)):k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("grybo/ghl note event")(w.show(w.showString)(E))))})},
Ub=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("notes")(f))(function(E){var ra=function(ta){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp(ta)(E))(Ba(Ab))};return e.bind(d.bindExceptT(g.monadIdentity))(ra("open"))(function(ta){return e.bind(d.bindExceptT(g.monadIdentity))(ra("b1"))(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(ra("b2"))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(ra("b3"))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(ra("w1"))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(ra("w2"))(function(ya){return e.bind(d.bindExceptT(g.monadIdentity))(ra("w3"))(function(za){return e.bind(d.bindExceptT(g.monadIdentity))(ra("bw1"))(function(Da){return e.bind(d.bindExceptT(g.monadIdentity))(ra("bw2"))(function(nb){return e.bind(d.bindExceptT(g.monadIdentity))(ra("bw3"))(function(Bb){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("solo")(f))(Ba(ea.readBoolean)))(function(qc){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("energy")(f))(Ba(ea.readBoolean)))(function(rc){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("bre")(f))(Ba(ea.readBoolean)))(function(sc){return c.pure(d.applicativeExceptT(g.monadIdentity))({notes:{open:ta,
b1:ka,b2:ia,b3:na,w1:qa,w2:ya,w3:za,bw1:Da,bw2:nb,bw3:Bb},solo:qc,energy:rc,bre:sc})})})})})})})})})})})})})})})},Vb=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("notes")(f))(function(E){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("lanes")(f))(function(ra){var ta=function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(ka("open"))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(ka("green"))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(ka("red"))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(ka("yellow"))(function(ya){return e.bind(d.bindExceptT(g.monadIdentity))(ka("blue"))(function(za){return e.bind(d.bindExceptT(g.monadIdentity))(ka("orange"))(function(Da){return c.pure(d.applicativeExceptT(g.monadIdentity))({open:ia,
green:na,red:qa,yellow:ya,blue:za,orange:Da})})})})})})})};return e.bind(d.bindExceptT(g.monadIdentity))(ta(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp(ka)(E))(Ba(Ab))}))(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(ta(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp(ia)(ra))(Ba(ea.readBoolean))}))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("solo")(f))(Ba(ea.readBoolean)))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("energy")(f))(Ba(ea.readBoolean)))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("bre")(f))(Ba(ea.readBoolean)))(function(ya){return c.pure(d.applicativeExceptT(g.monadIdentity))({notes:ka,
lanes:ia,solo:na,energy:qa,bre:ya})})})})})})})})},Wb=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("notes")(f))(function(E){var ra=function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(ea.readString(ka))(function(ia){return"e"===ia?c.pure(d.applicativeExceptT(g.monadIdentity))(B.value):"n"===ia?c.pure(d.applicativeExceptT(g.monadIdentity))(new A(vb.value)):"m"===ia?c.pure(d.applicativeExceptT(g.monadIdentity))(new A(wb.value)):"l"===ia?c.pure(d.applicativeExceptT(g.monadIdentity))(new A(xb.value)):
"r"===ia?c.pure(d.applicativeExceptT(g.monadIdentity))(new A(yb.value)):"N"===ia?c.pure(d.applicativeExceptT(g.monadIdentity))(new M(vb.value)):"M"===ia?c.pure(d.applicativeExceptT(g.monadIdentity))(new M(wb.value)):"L"===ia?c.pure(d.applicativeExceptT(g.monadIdentity))(new M(xb.value)):"R"===ia?c.pure(d.applicativeExceptT(g.monadIdentity))(new M(yb.value)):k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("dance note event")(w.show(w.showString)(ia))))})},
ta=function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp(ka)(E))(Ba(ra))};return e.bind(d.bindExceptT(g.monadIdentity))(ta("L"))(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(ta("D"))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(ta("U"))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(ta("R"))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("energy")(f))(Ba(ea.readBoolean)))(function(ya){return c.pure(d.applicativeExceptT(g.monadIdentity))({notes:{left:ka,
down:ia,up:na,right:qa},energy:ya})})})})})})})},Xb=function(f){var E=function(ta){return function(ka){if(""===ka)return[];var ia=L.indexOf("<gtr>")(ka);if(ia instanceof r.Nothing){var na=L.indexOf("</gtr>")(ka);if(na instanceof r.Nothing)return[new X.Tuple(ta,ka)];if(na instanceof r.Just)return C.cons(new X.Tuple(ta,L.take(na.value0)(ka)))(E(mb.value)(L.drop(na.value0+6|0)(ka)));throw Error("Song (622:22-624:109): "+[na.constructor.name]);}if(ia instanceof r.Just){na=L.indexOf("</gtr>")(ka);if(na instanceof
r.Nothing)return C.cons(new X.Tuple(ta,L.take(ia.value0)(ka)))(E(zb.value)(L.drop(ia.value0+5|0)(ka)));if(na instanceof r.Just)return ia.value0<na.value0?C.cons(new X.Tuple(ta,L.take(ia.value0)(ka)))(E(zb.value)(L.drop(ia.value0+5|0)(ka))):C.cons(new X.Tuple(ta,L.take(na.value0)(ka)))(E(mb.value)(L.drop(na.value0+6|0)(ka)));throw Error("Song (625:26-629:100): "+[na.constructor.name]);}throw Error("Song (621:30-629:100): "+[ia.constructor.name]);}},ra=function(ta){return Z.replaceAll("#")("\u266f")(Z.replaceAll("b")("\u266d")(Z.replaceAll("0")("\u25cb")(ta)))};
return e.bind(d.bindExceptT(g.monadIdentity))(ea.readString(f))(function(ta){var ka=L.take(1)(ta);return"e"===ka?c.pure(d.applicativeExceptT(g.monadIdentity))(B.value):"C"===ka?c.pure(d.applicativeExceptT(g.monadIdentity))(M.create(E(mb.value)(ra(L.drop(2)(ta))))):"c"===ka?c.pure(d.applicativeExceptT(g.monadIdentity))(A.create(E(mb.value)(ra(L.drop(2)(ta))))):k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("pro guitar chord name event")(w.show(w.showString)(ta))))})},
Yb=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("notes")(f))(function(E){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("lanes")(f))(function(ra){var ta=function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(ka("s1"))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(ka("s2"))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(ka("s3"))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(ka("s4"))(function(ya){return e.bind(d.bindExceptT(g.monadIdentity))(ka("s5"))(function(za){return e.bind(d.bindExceptT(g.monadIdentity))(ka("s6"))(function(Da){return e.bind(d.bindExceptT(g.monadIdentity))(ka("s7"))(function(nb){return e.bind(d.bindExceptT(g.monadIdentity))(ka("s8"))(function(Bb){return c.pure(d.applicativeExceptT(g.monadIdentity))({s1:ia,
s2:na,s3:qa,s4:ya,s5:za,s6:Da,s7:nb,s8:Bb})})})})})})})})})};return e.bind(d.bindExceptT(g.monadIdentity))(ta(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp(ka)(E))(Ba(Sb))}))(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(ta(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp(ia)(ra))(Ba(ea.readBoolean))}))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("solo")(f))(Ba(ea.readBoolean)))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("energy")(f))(Ba(ea.readBoolean)))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("bre")(f))(Ba(ea.readBoolean)))(function(ya){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("chords")(f))(Ba(Xb)))(function(za){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("arpeggio")(f))(Ba(ea.readBoolean)))(function(Da){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("strings")(f))(ea.readInt))(function(nb){return c.pure(d.applicativeExceptT(g.monadIdentity))({notes:ka,
lanes:ia,solo:na,energy:qa,bre:ya,chords:za,arpeggio:Da,strings:nb,chordsWidth:0})})})})})})})})})})})},Zb=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(ea.readNumber(f))(function(E){return 0===E?c.pure(d.applicativeExceptT(g.monadIdentity))(Kb.value):1===E?c.pure(d.applicativeExceptT(g.monadIdentity))(Lb.value):2===E?c.pure(d.applicativeExceptT(g.monadIdentity))(Mb.value):k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("bar (0) / beat (1) / halfbeat (2)")(w.show(w.showNumber)(E))))})},
$b=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("lines")(f))(Ba(Zb)))(function(E){return c.pure(d.applicativeExceptT(g.monadIdentity))({lines:E})})},ac=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("notes")(f))(function(E){return e.bind(d.bindExceptT(g.monadIdentity))(Ba(function(ra){return e.bind(d.bindExceptT(g.monadIdentity))(ea.readInt(ra))(function(ta){return 1===ta?c.pure(d.applicativeExceptT(g.monadIdentity))(Nb.value):
2===ta?c.pure(d.applicativeExceptT(g.monadIdentity))(Ob.value):3===ta?c.pure(d.applicativeExceptT(g.monadIdentity))(Pb.value):k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("Amplitude note")(w.show(w.showInt)(ta))))})})(E))(function(ra){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("instrument")(f))(ea.readString))(function(ta){return c.pure(d.applicativeExceptT(g.monadIdentity))({notes:ra,
instrument:ta})})})})},rb=new y.Functor(function(f){return function(E){return{blue:f(E.blue),green:f(E.green),open:f(E.open),orange:f(E.orange),red:f(E.red),yellow:f(E.yellow)}}}),ob=new D.Foldable(function(f){return function(E){return function(ra){return Q.append(f.Semigroup0())(E(ra.open))(Q.append(f.Semigroup0())(E(ra.green))(Q.append(f.Semigroup0())(E(ra.red))(Q.append(f.Semigroup0())(E(ra.yellow))(Q.append(f.Semigroup0())(E(ra.blue))(E(ra.orange))))))}}},function(f){return D.foldlDefault(ob)(f)},
function(f){return D.foldrDefault(ob)(f)}),sb=function(f){return function(E){var ra=function(na){if(na instanceof z.Cons&&na.value0.value1 instanceof r.Nothing&&na.value1 instanceof z.Cons&&na.value1.value0.value1 instanceof r.Just&&"+"===na.value1.value0.value1.value0||na instanceof z.Cons&&na.value0.value1 instanceof r.Nothing&&na.value1 instanceof z.Cons&&na.value1.value0.value1 instanceof r.Just&&"+$"===na.value1.value0.value1.value0)return ra(na.value1.value1);if(na instanceof z.Cons)return z.Cons.create(na.value0)(ra(na.value1));
if(na instanceof z.Nil)return z.Nil.value;throw Error("Song (905:21-915:25): "+[na.constructor.name]);},ta=R.toUnfoldable(z.unfoldableList)(F.keys(f));ta=H.zip(z.Cons.create(r.Nothing.value)(y.map(z.functorList)(r.Just.create)(ta)))(ta);var ka=N.fromFoldable(la.ordSeconds)(z.foldableList)(ra(N.toUnfoldable(z.unfoldableList)(y.map(N.functorMap)(function(na){if(na instanceof ua)return r.Nothing.value;if(na instanceof fa)return new r.Just(na.value0);throw Error("Song (903:3-903:42): "+[na.constructor.name]);
})(E)))),ia=function(na){return function(qa){var ya=N.submap(la.ordSeconds)(na)(new r.Just(qa))(ka);return N.alter(la.ordSeconds)(function(za){return za instanceof r.Just&&za.value0 instanceof r.Just?r.Nothing.value:za})(qa)(ya)}};return N.fromFoldable(la.ordSeconds)(z.foldableList)(y.map(z.functorList)(function(na){return X.Tuple.create(na.value1)(ia(na.value0)(na.value1))})(ta))}},bc=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("harm1")(f))(Ba(qb)))(function(E){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("harm2")(f))(Ba(qb)))(function(ra){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("harm3")(f))(Ba(qb)))(function(ta){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("energy")(f))(Ba(ea.readBoolean)))(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("ranges")(f))(Ba(Qb)))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("tonic")(f))(ea.readNullOrUndefined))(aa.traverse(aa.traversableMaybe)(d.applicativeExceptT(g.monadIdentity))(ea.readInt)))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("percussion")(f))(pb))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("phrases1")(f))(pb))(function(ya){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("phrases2")(f))(pb))(function(za){return c.pure(d.applicativeExceptT(g.monadIdentity))({harm1:E,
harm2:ra,harm3:ta,energy:ka,ranges:ia,tonic:na,percussion:qa,phrases1:ya,phrases2:za,lyrics1:sb(ya)(E),lyrics2:sb(za)(ra),lyrics3:sb(za)(ta)})})})})})})})})})})},cc=new v.Eq(function(f){return function(E){return f instanceof l&&E instanceof l||f instanceof W&&E instanceof W||f instanceof ja&&E instanceof ja||f instanceof oa&&E instanceof oa||f instanceof xa&&E instanceof xa||f instanceof Aa&&E instanceof Aa||f instanceof sa&&E instanceof sa||f instanceof wa&&E instanceof wa||f instanceof Fa&&E instanceof
Fa||f instanceof Ca&&E instanceof Ca||f instanceof Ea&&E instanceof Ea||f instanceof Ia&&E instanceof Ia||f instanceof Ja&&E instanceof Ja||f instanceof Ha&&E instanceof Ha||f instanceof Ga&&E instanceof Ga||f instanceof Ma&&E instanceof Ma||f instanceof Na&&E instanceof Na||f instanceof Oa&&E instanceof Oa||f instanceof Pa&&E instanceof Pa||f instanceof Qa&&E instanceof Qa||f instanceof Ra&&E instanceof Ra||f instanceof Sa&&E instanceof Sa||f instanceof Ta&&E instanceof Ta||f instanceof Ua&&E instanceof
Ua||f instanceof fb&&E instanceof fb?!0:!1}}),hb=new ba.Ord(function(){return cc},function(f){return function(E){if(f instanceof l&&E instanceof l)return u.EQ.value;if(f instanceof l)return u.LT.value;if(E instanceof l)return u.GT.value;if(f instanceof W&&E instanceof W)return u.EQ.value;if(f instanceof W)return u.LT.value;if(E instanceof W)return u.GT.value;if(f instanceof ja&&E instanceof ja)return u.EQ.value;if(f instanceof ja)return u.LT.value;if(E instanceof ja)return u.GT.value;if(f instanceof
oa&&E instanceof oa)return u.EQ.value;if(f instanceof oa)return u.LT.value;if(E instanceof oa)return u.GT.value;if(f instanceof xa&&E instanceof xa)return u.EQ.value;if(f instanceof xa)return u.LT.value;if(E instanceof xa)return u.GT.value;if(f instanceof Aa&&E instanceof Aa)return u.EQ.value;if(f instanceof Aa)return u.LT.value;if(E instanceof Aa)return u.GT.value;if(f instanceof sa&&E instanceof sa)return u.EQ.value;if(f instanceof sa)return u.LT.value;if(E instanceof sa)return u.GT.value;if(f instanceof
wa&&E instanceof wa)return u.EQ.value;if(f instanceof wa)return u.LT.value;if(E instanceof wa)return u.GT.value;if(f instanceof Fa&&E instanceof Fa)return u.EQ.value;if(f instanceof Fa)return u.LT.value;if(E instanceof Fa)return u.GT.value;if(f instanceof Ca&&E instanceof Ca)return u.EQ.value;if(f instanceof Ca)return u.LT.value;if(E instanceof Ca)return u.GT.value;if(f instanceof Ea&&E instanceof Ea)return u.EQ.value;if(f instanceof Ea)return u.LT.value;if(E instanceof Ea)return u.GT.value;if(f instanceof
Ia&&E instanceof Ia)return u.EQ.value;if(f instanceof Ia)return u.LT.value;if(E instanceof Ia)return u.GT.value;if(f instanceof Ja&&E instanceof Ja)return u.EQ.value;if(f instanceof Ja)return u.LT.value;if(E instanceof Ja)return u.GT.value;if(f instanceof Ha&&E instanceof Ha)return u.EQ.value;if(f instanceof Ha)return u.LT.value;if(E instanceof Ha)return u.GT.value;if(f instanceof Ga&&E instanceof Ga)return u.EQ.value;if(f instanceof Ga)return u.LT.value;if(E instanceof Ga)return u.GT.value;if(f instanceof
Ma&&E instanceof Ma)return u.EQ.value;if(f instanceof Ma)return u.LT.value;if(E instanceof Ma)return u.GT.value;if(f instanceof Na&&E instanceof Na)return u.EQ.value;if(f instanceof Na)return u.LT.value;if(E instanceof Na)return u.GT.value;if(f instanceof Oa&&E instanceof Oa)return u.EQ.value;if(f instanceof Oa)return u.LT.value;if(E instanceof Oa)return u.GT.value;if(f instanceof Pa&&E instanceof Pa)return u.EQ.value;if(f instanceof Pa)return u.LT.value;if(E instanceof Pa)return u.GT.value;if(f instanceof
Qa&&E instanceof Qa)return u.EQ.value;if(f instanceof Qa)return u.LT.value;if(E instanceof Qa)return u.GT.value;if(f instanceof Ra&&E instanceof Ra)return u.EQ.value;if(f instanceof Ra)return u.LT.value;if(E instanceof Ra)return u.GT.value;if(f instanceof Sa&&E instanceof Sa)return u.EQ.value;if(f instanceof Sa)return u.LT.value;if(E instanceof Sa)return u.GT.value;if(f instanceof Ta&&E instanceof Ta)return u.EQ.value;if(f instanceof Ta)return u.LT.value;if(E instanceof Ta)return u.GT.value;if(f instanceof
Ua&&E instanceof Ua)return u.EQ.value;if(f instanceof Ua)return u.LT.value;if(E instanceof Ua)return u.GT.value;if(f instanceof fb&&E instanceof fb)return u.EQ.value;throw Error("Song (395:8-395:38): "+[f.constructor.name,E.constructor.name]);}}),dc=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("notes")(f))(function(E){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("lanes")(f))(function(ra){var ta=function(ka){var ia=function(na){return function(qa){return y.map(d.functorExceptT(g.functorIdentity))(X.Tuple.create(na))(ka(qa))}};
return y.map(d.functorExceptT(g.functorIdentity))(N.fromFoldable(hb)(D.foldableArray))(aa.sequence(aa.traversableArray)(d.applicativeExceptT(g.monadIdentity))([ia(l.value)("ry-c"),ia(W.value)("ry-cs"),ia(ja.value)("ry-d"),ia(oa.value)("ry-ds"),ia(xa.value)("ry-e"),ia(Aa.value)("ry-f"),ia(sa.value)("ry-fs"),ia(wa.value)("ry-g"),ia(Fa.value)("ry-gs"),ia(Ca.value)("ry-a"),ia(Ea.value)("ry-as"),ia(Ia.value)("ry-b"),ia(Ja.value)("bg-c"),ia(Ha.value)("bg-cs"),ia(Ga.value)("bg-d"),ia(Ma.value)("bg-ds"),
ia(Na.value)("bg-e"),ia(Oa.value)("bg-f"),ia(Pa.value)("bg-fs"),ia(Qa.value)("bg-g"),ia(Ra.value)("bg-gs"),ia(Sa.value)("bg-a"),ia(Ta.value)("bg-as"),ia(Ua.value)("bg-b"),ia(fb.value)("o-c")]))};return e.bind(d.bindExceptT(g.monadIdentity))(ta(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp(ka)(E))(Ba(Tb))}))(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(ta(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp(ia)(ra))(Ba(ea.readBoolean))}))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("solo")(f))(Ba(ea.readBoolean)))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("energy")(f))(Ba(ea.readBoolean)))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("bre")(f))(Ba(ea.readBoolean)))(function(ya){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("gliss")(f))(Ba(ea.readBoolean)))(function(za){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("ranges")(f))(Ba(Rb)))(function(Da){return c.pure(d.applicativeExceptT(g.monadIdentity))({notes:ka,
lanes:ia,solo:na,energy:qa,bre:ya,gliss:za,ranges:Da})})})})})})})})})})},ec=new v.Eq(function(f){return function(E){return f instanceof $a&&E instanceof $a||f instanceof Ka&&E instanceof Ka||f instanceof ab&&E instanceof ab||f instanceof bb&&E instanceof bb||f instanceof cb&&E instanceof cb||f instanceof db&&E instanceof db||f instanceof Va&&E instanceof Va||f instanceof La&&E instanceof La||f instanceof Wa&&E instanceof Wa||f instanceof Xa&&E instanceof Xa||f instanceof eb&&E instanceof eb||f instanceof
Ya&&E instanceof Ya||f instanceof gb&&E instanceof gb?!0:!1}}),fc=new ba.Ord(function(){return ec},function(f){return function(E){if(f instanceof $a&&E instanceof $a)return u.EQ.value;if(f instanceof $a)return u.LT.value;if(E instanceof $a)return u.GT.value;if(f instanceof Ka&&E instanceof Ka)return u.EQ.value;if(f instanceof Ka)return u.LT.value;if(E instanceof Ka)return u.GT.value;if(f instanceof ab&&E instanceof ab)return u.EQ.value;if(f instanceof ab)return u.LT.value;if(E instanceof ab)return u.GT.value;
if(f instanceof bb&&E instanceof bb)return u.EQ.value;if(f instanceof bb)return u.LT.value;if(E instanceof bb)return u.GT.value;if(f instanceof cb&&E instanceof cb)return u.EQ.value;if(f instanceof cb)return u.LT.value;if(E instanceof cb)return u.GT.value;if(f instanceof db&&E instanceof db)return u.EQ.value;if(f instanceof db)return u.LT.value;if(E instanceof db)return u.GT.value;if(f instanceof Va&&E instanceof Va)return u.EQ.value;if(f instanceof Va)return u.LT.value;if(E instanceof Va)return u.GT.value;
if(f instanceof La&&E instanceof La)return u.EQ.value;if(f instanceof La)return u.LT.value;if(E instanceof La)return u.GT.value;if(f instanceof Wa&&E instanceof Wa)return u.EQ.value;if(f instanceof Wa)return u.LT.value;if(E instanceof Wa)return u.GT.value;if(f instanceof Xa&&E instanceof Xa)return u.EQ.value;if(f instanceof Xa)return u.LT.value;if(E instanceof Xa)return u.GT.value;if(f instanceof eb&&E instanceof eb)return u.EQ.value;if(f instanceof eb)return u.LT.value;if(E instanceof eb)return u.GT.value;
if(f instanceof Ya&&E instanceof Ya)return u.EQ.value;if(f instanceof Ya)return u.LT.value;if(E instanceof Ya)return u.GT.value;if(f instanceof gb&&E instanceof gb)return u.EQ.value;throw Error("Song (849:8-849:34): "+[f.constructor.name,E.constructor.name]);}}),Za=function(f){return function(E){return e.bind(d.bindExceptT(g.monadIdentity))(ea.readArray(E))(aa.traverse(aa.traversableArray)(d.applicativeExceptT(g.monadIdentity))(function(ra){return h.apply(d.applyExceptT(g.monadIdentity))(y.map(d.functorExceptT(g.functorIdentity))(X.Tuple.create)(e.bind(d.bindExceptT(g.monadIdentity))(I.readIndex(0)(ra))(ea.readString)))(e.bind(d.bindExceptT(g.monadIdentity))(I.readIndex(1)(ra))(f))}))}},
tb=new h.Apply(function(){return rb},function(f){return function(E){return{open:f.open(E.open),green:f.green(E.green),red:f.red(E.red),yellow:f.yellow(E.yellow),blue:f.blue(E.blue),orange:f.orange(E.orange)}}}),Cb=new c.Applicative(function(){return tb},function(f){return{open:f,green:f,red:f,yellow:f,blue:f,orange:f}}),gc={notes:c.pure(Cb)({past:r.Nothing.value,now:r.Nothing.value,future:r.Nothing.value}),lanes:c.pure(Cb)({past:!1,now:!1,future:!1}),solo:{past:!1,now:!1,future:!1},energy:{past:!1,
now:!1,future:!1},bre:{past:!1,now:!1,future:!1}},hc=function(f){var E=function(ka){return function(ia){return function(na){na=N.lookup(la.ordSeconds)(na)(ia);if(na instanceof r.Just)return{past:ka.future,now:!0,future:na.value0};if(na instanceof r.Nothing)return{past:ka.future,now:!1,future:ka.future};throw Error("Song (162:30-164:72): "+[na.constructor.name]);}}},ra=function(ka){return function(ia){if(ia instanceof z.Nil)return z.Nil.value;if(ia instanceof z.Cons){var na=E(ka.energy)(f.energy)(ia.value0),
qa={notes:function(){return h.lift2(tb)(function(ya){return function(za){var Da=N.lookup(la.ordSeconds)(ia.value0)(ya);if(Da instanceof r.Nothing)return{past:za.future,now:r.Nothing.value,future:za.future};if(Da instanceof r.Just&&Da.value0 instanceof B)return{past:za.future,now:r.Nothing.value,future:r.Nothing.value};if(Da instanceof r.Just&&Da.value0 instanceof A)return{past:za.future,now:new r.Just(Da.value0.value0),future:r.Nothing.value};if(Da instanceof r.Just&&Da.value0 instanceof M)return{past:za.future,
now:new r.Just(Da.value0.value0),future:new r.Just(na.future)};throw Error("Song (170:25-174:100): "+[Da.constructor.name]);}})(f.notes)(ka.notes)}(),lanes:function(){return h.lift2(tb)(function(ya){return function(za){return E(za)(ya)(ia.value0)}})(f.lanes)(ka.lanes)}(),solo:E(ka.solo)(f.solo)(ia.value0),energy:na,bre:E(ka.bre)(f.bre)(ia.value0)};return z.Cons.create(X.Tuple.create(ia.value0)(qa))(ra(qa)(ia.value1))}throw Error("Song (165:3-165:52): "+[ka.constructor.name,ia.constructor.name]);}},
ta=H.fromFoldable(R.foldableSet)(R.unions(D.foldableArray)(la.ordSeconds)([R.unions(z.foldableList)(la.ordSeconds)(y.map(z.functorList)(F.keys)(H.fromFoldable(ob)(f.notes))),R.unions(z.foldableList)(la.ordSeconds)(y.map(z.functorList)(F.keys)(H.fromFoldable(ob)(f.lanes))),F.keys(f.solo),F.keys(f.energy),F.keys(f.bre)]));return N.fromFoldable(la.ordSeconds)(z.foldableList)(ra(gc)(ta))},Db=[l.value,W.value,ja.value,oa.value,xa.value,Aa.value,sa.value,wa.value,Fa.value,Ca.value,Ea.value,Ia.value,Ja.value,
Ha.value,Ga.value,Ma.value,Na.value,Oa.value,Pa.value,Qa.value,Ra.value,Sa.value,Ta.value,Ua.value,fb.value],ic={notes:N.fromFoldable(hb)(D.foldableArray)(y.map(y.functorArray)(function(f){return new X.Tuple(f,{past:r.Nothing.value,now:r.Nothing.value,future:r.Nothing.value})})(Db)),lanes:N.fromFoldable(hb)(D.foldableArray)(y.map(y.functorArray)(function(f){return new X.Tuple(f,{past:!1,now:!1,future:!1})})(Db)),ranges:{past:r.Nothing.value,now:pa.unit,future:r.Nothing.value},solo:{past:!1,now:!1,
future:!1},energy:{past:!1,now:!1,future:!1},gliss:{past:!1,now:!1,future:!1},bre:{past:!1,now:!1,future:!1}},jc=function(f){var E=function(ka){return function(ia){return function(na){na=N.lookup(la.ordSeconds)(na)(ia);if(na instanceof r.Just)return{past:ka.future,now:!0,future:na.value0};if(na instanceof r.Nothing)return{past:ka.future,now:!1,future:ka.future};throw Error("Song (311:30-313:72): "+[na.constructor.name]);}}},ra=function(ka){return function(ia){if(ia instanceof z.Nil)return z.Nil.value;
if(ia instanceof z.Cons){var na=E(ka.energy)(f.energy)(ia.value0),qa={notes:n.flip(K.mapWithIndex(N.functorWithIndexMap))(ka.notes)(function(ya){return function(za){var Da=e.bind(r.bindMaybe)(N.lookup(hb)(ya)(f.notes))(N.lookup(la.ordSeconds)(ia.value0));if(Da instanceof r.Nothing)return{past:za.future,now:r.Nothing.value,future:za.future};if(Da instanceof r.Just&&Da.value0 instanceof B)return{past:za.future,now:r.Nothing.value,future:r.Nothing.value};if(Da instanceof r.Just&&Da.value0 instanceof
A)return{past:za.future,now:new r.Just(pa.unit),future:r.Nothing.value};if(Da instanceof r.Just&&Da.value0 instanceof M)return{past:za.future,now:new r.Just(pa.unit),future:new r.Just(na.future)};throw Error("Song (319:9-323:99): "+[Da.constructor.name]);}}),lanes:n.flip(K.mapWithIndex(N.functorWithIndexMap))(ka.lanes)(function(ya){return function(za){return E(za)(r.fromMaybe(N.empty)(N.lookup(hb)(ya)(f.lanes)))(ia.value0)}}),ranges:{past:ka.ranges.future,now:pa.unit,future:r.maybe(ka.ranges.future)(r.Just.create)(N.lookup(la.ordSeconds)(ia.value0)(f.ranges))},
solo:E(ka.solo)(f.solo)(ia.value0),energy:na,gliss:E(ka.gliss)(f.gliss)(ia.value0),bre:E(ka.bre)(f.bre)(ia.value0)};return z.Cons.create(X.Tuple.create(ia.value0)(qa))(ra(qa)(ia.value1))}throw Error("Song (314:3-314:55): "+[ka.constructor.name,ia.constructor.name]);}},ta=H.fromFoldable(R.foldableSet)(R.unions(D.foldableArray)(la.ordSeconds)([R.unions(z.foldableList)(la.ordSeconds)(y.map(z.functorList)(F.keys)(N.values(f.notes))),R.unions(z.foldableList)(la.ordSeconds)(y.map(z.functorList)(F.keys)(N.values(f.lanes))),
F.keys(f.ranges),F.keys(f.solo),F.keys(f.energy),F.keys(f.gliss),F.keys(f.bre)]));return N.fromFoldable(la.ordSeconds)(z.foldableList)(ra(ic)(ta))},Eb=[new X.Tuple("k",$a.value),new X.Tuple("r",Ka.value),new X.Tuple("R",ab.value),new X.Tuple("H",bb.value),new X.Tuple("h",cb.value),new X.Tuple("p",db.value),new X.Tuple("Y",Va.value),new X.Tuple("y",La.value),new X.Tuple("B",Wa.value),new X.Tuple("b",Xa.value),new X.Tuple("O",eb.value),new X.Tuple("G",Ya.value),new X.Tuple("g",gb.value)],kc=N.fromFoldable(ba.ordChar)(D.foldableArray)(Eb),
lc=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(ea.readString(f))(function(E){return aa["for"](d.applicativeExceptT(g.monadIdentity))(aa.traversableArray)(T.toCharArray(E))(function(ra){var ta=N.lookup(ba.ordChar)(ra)(kc);if(ta instanceof r.Just)return c.pure(d.applicativeExceptT(g.monadIdentity))(ta.value0);if(ta instanceof r.Nothing)return k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("drum gem")(w.show(w.showChar)(ra))));
throw Error("Song (844:35-846:69): "+[ta.constructor.name]);})})},mc=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("notes")(f))(Ba(lc)))(function(E){return e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("lanes")(f))(function(ra){return e.bind(d.bindExceptT(g.monadIdentity))(y.map(d.functorExceptT(g.functorIdentity))(N.fromFoldable(fc)(D.foldableArray))(aa.traverse(aa.traversableArray)(d.applicativeExceptT(g.monadIdentity))(function(ta){var ka=
y.map(d.functorExceptT(g.functorIdentity))(X.Tuple.create(ta.value1));ta=T.singleton(ta.value0);ta=e.bind(d.bindExceptT(g.monadIdentity))(I.readProp(ta)(ra))(Ba(ea.readBoolean));return ka(ta)})(Eb)))(function(ta){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("solo")(f))(Ba(ea.readBoolean)))(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("energy")(f))(Ba(ea.readBoolean)))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("bre")(f))(Ba(ea.readBoolean)))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("mode")(f))(ea.readString))(function(qa){return"4"===
qa?c.pure(d.applicativeExceptT(g.monadIdentity))(ub.value):"5"===qa?c.pure(d.applicativeExceptT(g.monadIdentity))(Hb.value):"pro"===qa?c.pure(d.applicativeExceptT(g.monadIdentity))(Ib.value):"real"===qa?c.pure(d.applicativeExceptT(g.monadIdentity))(Jb.value):k.throwError(d.monadThrowExceptT(g.monadIdentity))(c.pure(z.applicativeNonEmptyList)(ea.TypeMismatch.create("drums mode")(w.show(w.showString)(qa))))}))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("disco")(f))(Ba(ea.readBoolean)))(function(ya){return c.pure(d.applicativeExceptT(g.monadIdentity))({notes:E,
lanes:ta,solo:ka,energy:ia,bre:na,mode:qa,disco:ya})})})})})})})})})},nc=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("five")(f))(ea.readNullOrUndefined))(aa.traverse(aa.traversableMaybe)(d.applicativeExceptT(g.monadIdentity))(Za(Vb))))(function(E){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("six")(f))(ea.readNullOrUndefined))(aa.traverse(aa.traversableMaybe)(d.applicativeExceptT(g.monadIdentity))(Za(Ub))))(function(ra){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("drums")(f))(ea.readNullOrUndefined))(function(ta){var ka=
e.bind(d.bindExceptT(g.monadIdentity));if(ta instanceof r.Nothing)ta=c.pure(d.applicativeExceptT(g.monadIdentity))([]);else if(ta instanceof r.Just)ta=e.bind(d.bindExceptT(g.monadIdentity))(ea.readArray(ta.value0))(aa.traverse(aa.traversableArray)(d.applicativeExceptT(g.monadIdentity))(Za(mc)));else throw Error("Song (735:12-737:71): "+[ta.constructor.name]);return ka(ta)(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("prokeys")(f))(ea.readNullOrUndefined))(aa.traverse(aa.traversableMaybe)(d.applicativeExceptT(g.monadIdentity))(Za(dc))))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("protar")(f))(ea.readNullOrUndefined))(aa.traverse(aa.traversableMaybe)(d.applicativeExceptT(g.monadIdentity))(Za(Yb))))(function(qa){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("catch")(f))(ea.readNullOrUndefined))(aa.traverse(aa.traversableMaybe)(d.applicativeExceptT(g.monadIdentity))(Za(ac))))(function(ya){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("vocal")(f))(ea.readNullOrUndefined))(aa.traverse(aa.traversableMaybe)(d.applicativeExceptT(g.monadIdentity))(Za(bc))))(function(za){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("dance")(f))(ea.readNullOrUndefined))(aa.traverse(aa.traversableMaybe)(d.applicativeExceptT(g.monadIdentity))(Za(Wb))))(function(Da){return c.pure(d.applicativeExceptT(g.monadIdentity))({five:y.map(r.functorMaybe)(y.map(y.functorArray)(y.map(X.functorTuple)(hc)))(E),
six:ra,drums:ia,prokeys:y.map(r.functorMaybe)(y.map(y.functorArray)(y.map(X.functorTuple)(jc)))(na),protar:qa,amplitude:ya,vocal:za,dance:Da})})})})})})})})})})};b.Drums4=ub;b.Drums5=Hb;b.DrumsPro=Ib;b.DrumsReal=Jb;b.drumsProTo4=function(f){return{notes:n.flip(K.mapWithIndex(N.functorWithIndexMap))(f.notes)(function(E){return function(ra){var ta=r.maybe(!1)(function(ka){return ka.value})(N.lookupLE(la.ordSeconds)(E)(f.disco));return n.flip(y.map(y.functorArray))(ra)(function(ka){return ka instanceof
Ka?ta?La.value:Ka.value:ka instanceof Va?ta?Ka.value:La.value:ka instanceof Wa?Xa.value:ka instanceof Ya?gb.value:ka})}}),lanes:f.lanes,solo:f.solo,energy:f.energy,bre:f.bre,mode:ub.value,disco:f.disco}};b.SustainEnd=B;b.Note=A;b.Sustain=M;b.Strum=jb;b.HOPO=kb;b.Tap=lb;b.FiveEach=Gb;b.emptyFiveState=gc;b.extendFive=function(f){return function(E){return{notes:y.map(rb)(function(ra){return{past:f(ra),now:r.Nothing.value,future:f(ra)}})(E.notes),lanes:y.map(rb)(function(ra){return{past:f(ra),now:!1,
future:f(ra)}})(E.lanes),solo:{past:f(E.solo),now:!1,future:f(E.solo)},energy:{past:f(E.energy),now:!1,future:f(E.energy)},bre:{past:f(E.bre),now:!1,future:f(E.bre)}}}};b.processFive=hc;b.SixEach=Y;b.SlideUp=da;b.SlideDown=O;b.Baseline=mb;b.Superscript=zb;b.emptyProKeysState=ic;b.extendPK=function(f){return function(E){return{notes:y.map(N.functorMap)(function(ra){return{past:f(ra),now:r.Nothing.value,future:f(ra)}})(E.notes),lanes:y.map(N.functorMap)(function(ra){return{past:f(ra),now:!1,future:f(ra)}})(E.lanes),
ranges:{past:f(E.ranges),now:pa.unit,future:f(E.ranges)},solo:{past:f(E.solo),now:!1,future:f(E.solo)},energy:{past:f(E.energy),now:!1,future:f(E.energy)},gliss:{past:f(E.gliss),now:!1,future:f(E.gliss)},bre:{past:f(E.bre),now:!1,future:f(E.bre)}}}};b.processProKeys=jc;b.RangeC=P;b.RangeD=ca;b.RangeE=V;b.RangeF=S;b.RangeG=ha;b.RangeA=x;b.isForeignRange=Rb;b.RedC=l;b.RedCs=W;b.RedD=ja;b.RedDs=oa;b.RedE=xa;b.YellowF=Aa;b.YellowFs=sa;b.YellowG=wa;b.YellowGs=Fa;b.YellowA=Ca;b.YellowAs=Ea;b.YellowB=Ia;
b.BlueC=Ja;b.BlueCs=Ha;b.BlueD=Ga;b.BlueDs=Ma;b.BlueE=Na;b.GreenF=Oa;b.GreenFs=Pa;b.GreenG=Qa;b.GreenGs=Ra;b.GreenA=Sa;b.GreenAs=Ta;b.GreenB=Ua;b.OrangeC=fb;b.allPitches=Db;b.L=Nb;b.M=Ob;b.R=Pb;b.NoteNormal=vb;b.NoteMine=wb;b.NoteLift=xb;b.NoteRoll=yb;b.isForeignFiveNote=Ab;b.isForeignProtarNote=Sb;b.isForeignPKNote=Tb;b.isForeignFive=Vb;b.isForeignAmplitude=ac;b.isForeignDance=Wb;b.isForeignSix=Ub;b.isForeignChord=Xb;b.isForeignProtar=Yb;b.isForeignProKeys=dc;b.isForeignFlex=nc;b.isForeignSong=function(f){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("title")(f))(ea.readString))(function(E){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("artist")(f))(ea.readString))(function(ra){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("author")(f))(ea.readString))(function(ta){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("end")(f))(ea.readNumber))(function(ka){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("beats")(f))($b))(function(ia){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("parts")(f))(ea.readArray))(aa.traverse(aa.traversableArray)(d.applicativeExceptT(g.monadIdentity))(function(na){return h.apply(d.applyExceptT(g.monadIdentity))(y.map(d.functorExceptT(g.functorIdentity))(X.Tuple.create)(e.bind(d.bindExceptT(g.monadIdentity))(I.readIndex(0)(na))(ea.readString)))(e.bind(d.bindExceptT(g.monadIdentity))(I.readIndex(1)(na))(nc))})))(function(na){return e.bind(d.bindExceptT(g.monadIdentity))(e.bind(d.bindExceptT(g.monadIdentity))(I.readProp("sections")(f))(Ba(ea.readString)))(function(qa){return c.pure(d.applicativeExceptT(g.monadIdentity))({end:ka,
beats:ia,parts:na,title:E,artist:ra,author:ta,sections:qa})})})})})})})})};b.readTimedSet=pb;b.readTimedMap=Ba;b.difficulties=Za;b.isForeignDrums=mc;b.Kick=$a;b.Red=Ka;b.Rimshot=ab;b.HHOpen=bb;b.HHSizzle=cb;b.HHPedal=db;b.YCym=Va;b.YTom=La;b.BCym=Wa;b.BTom=Xa;b.OCym=eb;b.GCym=Ya;b.GTom=gb;b.allDrums=Eb;b.allDrumsMap=kc;b.isForeignGems=lc;b.isForeignBeats=$b;b.Bar=Kb;b.Beat=Lb;b.HalfBeat=Mb;b.isForeignBeat=Zb;b.vocalCount=function(f){return r.fromMaybe(1)(D.maximum(ba.ordInt)(D.foldableArray)(y.map(y.functorArray)(function(E){if(!N.isEmpty(E.value1.harm3))return 3;
if(!N.isEmpty(E.value1.harm2))return 2;if(t.otherwise)return 1;throw Error("Song (891:3-895:3): "+[E.constructor.name]);})(f)))};b.extractLyrics=sb;b.isForeignVocal=bc;b.VocalRangeShift=ma;b.VocalRange=va;b.isForeignVocalRange=Qb;b.VocalStart=fa;b.VocalEnd=ua;b.isForeignVocalNote=qb;b.newtypeFiveEach=pc;b.functorFiveEach=rb;b.applyFiveEach=tb;b.applicativeFiveEach=Cb;b.foldableFiveEach=ob;b.newtypeSixEach=oc;b.eqPitch=cc;b.ordPitch=hb;b.eqGem=ec;b.ordGem=fc})(PS);
(function(a){a.customize=window.customizeOnyx})(PS.Style=PS.Style||{});(function(a){a.Style=a.Style||{};a.Style.customize=a.Style.customize})(PS);
(function(a){a["Draw.Common"]=a["Draw.Common"]||{};var b=a["Draw.Common"],c=a["Draw.Common"],h=a["Control.Applicative"],e=a["Control.Bind"],k=a["Data.Int"],d=a["Data.Map.Internal"],m=a["Data.Maybe"],q=a["Data.Ord"],p=a["Data.Show"],C=a["Data.String.Common"],t=a["Data.Time.Duration"],v=a["Data.Unit"],G=a.Effect,D=a["Graphics.Canvas"],n=a.Math,y=a.OnyxMap,K=a.Song,g=a.Style;a=function(){function u(Q){this.value0=Q}u.create=function(Q){return new u(Q)};return u}();var U=function(){function u(Q){this.value0=
Q}u.create=function(Q){return new u(Q)};return u}(),H=function(u){return function(Q){return u(Q.context)}},z=function(u){return H(function(Q){return D.setFillStyle(Q)(u)})},F=function(u){return H(function(Q){return D.fillRect(Q)(u)})},N=function(u){return function(Q){var R=2*u.rx,w=2*u.ry,L=q.max(q.ordNumber)(R)(w),T=R/L,Z=w/L;return function(){D.save(Q.context)();D.translate(Q.context)({translateX:u.x,translateY:u.y})();D.scale(Q.context)({scaleX:T,scaleY:Z})();D.beginPath(Q.context)();D.arc(Q.context)({x:0,
y:0,radius:L/2,start:0,end:2*n.pi})();D.fill(Q.context)();D.closePath(Q.context)();return D.restore(Q.context)()}}},r=function(u){return function(Q){return function(){z(g.customize.freeformLane)(Q)();var R=u.width/2;return N({x:u.x+R,y:u.y,rx:R,ry:15})(Q)()}}},J=function(u){return function(Q){return function(){z(g.customize.freeformLane)(Q)();return F({x:u.x,y:u.y,width:u.width,height:u.height})(Q)()}}},ba=function(u){return function(Q){return function(R){var w=C.toUpper(u.name),L=5/3*g.customize.labelIconWidth;
return function(){D.setFont(R.context)(p.show(p.showInt)(k.round(.3*L))+"px Varela Round")();c.setBaseline(R.context)("middle")();D.setTextAlign(R.context)(D.AlignLeft.value)();var T=D.measureText(R.context)(w)(),Z=.6*L,la=D.measureText(R.context)(u.difficulty)(),aa=function(ea){return k.toNumber(k.round(ea))},X=.12*L;la=T.width+X+Z+X+la.width;var pa=Q.x-la/2;D.setFillStyle(R.context)("#7a4b0d")();D.setStrokeStyle(R.context)("black")();D.setLineWidth(R.context)(1)();c.roundRect(R.context)({x:aa(pa-
X),y:aa(Q.y-.25*L),width:aa(X+la+X),height:aa(.5*L),radius:X,fill:!0,stroke:!0})();D.setFillStyle(R.context)("white")();D.fillText(R.context)(w)(aa(pa))(aa(Q.y+1))();D.drawImageScale(R.context)(R.getImage(u.icon))(aa(pa+T.width+X))(aa(Q.y-Z/2))(aa(Z))(aa(Z))();D.fillText(R.context)(u.difficulty)(aa(pa+T.width+X+Z+X))(aa(Q.y+1))();return c.setBaseline(R.context)("alphabetic")()}}}};b.Paused=a;b.Playing=U;b.Drawer=function(u){return u};b.setFillStyle=z;b.fillRect=F;b.strokeRect=function(u){return H(function(Q){return D.strokeRect(Q)(u)})};
b.fillEllipse=N;b.fillCircle=function(u){return N({x:u.x,y:u.y,rx:u.r,ry:u.r})};b.drawImage=function(u){return function(Q){return function(R){return function(w){return H(function(L){return D.drawImage(L)(w.getImage(u))(Q)(R)})(w)}}}};b.onContext=H;b.measureText=function(u){return function(Q){return D.measureText(Q.context)(u)}};b.showTimestamp=function(u){var Q=function(L){return function(T){return 10>T?L+p.show(p.showInt)(T):p.show(p.showInt)(T)}},R=k.floor(u/60),w=k.floor(u-(60*R|0));u=k.floor(1E3*
(u-(60*R|0)-w));return p.show(p.showInt)(R)+(":"+(Q("0")(w)+("."+function(L){return function(T){return 100>T?L+Q(L)(T):p.show(p.showInt)(T)}}("0")(u))))};b.drawLaneCap=r;b.drawLaneBody=J;b.drawLane=function(u){return function(Q){return function(){J(u)(Q)();r(u)(Q)();return r({x:u.x,y:u.y+u.height|0,width:u.width,height:u.height})(Q)()}}};b.zoomAscDoPadding=function(u){return function(Q){return function(R){return function(w){return function(L){return function(T){return e.discard(e.discardUnit)(Q.Bind1())(function(){var Z=
d.lookupLE(u)(R)(L);if(Z instanceof m.Nothing)return h.pure(Q.Applicative0())(v.unit);if(Z instanceof m.Just)return e.discard(e.discardUnit)(Q.Bind1())(function(){var la=d.lookupLT(u)(Z.value0.key)(L);if(la instanceof m.Nothing)return h.pure(Q.Applicative0())(v.unit);if(la instanceof m.Just)return T(la.value0.key)(la.value0.value);throw Error("Draw.Common (170:7-172:49): "+[la.constructor.name]);}())(function(){return T(Z.value0.key)(Z.value0.value)});throw Error("Draw.Common (165:3-173:14): "+[Z.constructor.name]);
}())(function(){return e.discard(e.discardUnit)(Q.Bind1())(y.zoomAscDo(u)(Q)(R)(w)(L)(T))(function(){var Z=d.lookupGE(u)(w)(L);if(Z instanceof m.Nothing)return h.pure(Q.Applicative0())(v.unit);if(Z instanceof m.Just)return T(Z.value0.key)(Z.value0.value);throw Error("Draw.Common (175:3-177:41): "+[Z.constructor.name]);})})}}}}}};b.zoomDescDoPadding=function(u){return function(Q){return function(R){return function(w){return function(L){return function(T){return e.discard(e.discardUnit)(Q.Bind1())(function(){var Z=
d.lookupGE(u)(w)(L);if(Z instanceof m.Nothing)return h.pure(Q.Applicative0())(v.unit);if(Z instanceof m.Just)return T(Z.value0.key)(Z.value0.value);throw Error("Draw.Common (181:3-183:41): "+[Z.constructor.name]);}())(function(){return e.discard(e.discardUnit)(Q.Bind1())(y.zoomDescDo(u)(Q)(R)(w)(L)(T))(function(){var Z=d.lookupLE(u)(R)(L);if(Z instanceof m.Nothing)return h.pure(Q.Applicative0())(v.unit);if(Z instanceof m.Just)return T(Z.value0.key)(Z.value0.value);throw Error("Draw.Common (185:3-187:41): "+
[Z.constructor.name]);})})}}}}}};b.slide=function(u){return function(Q){return function(R){return function(w){return function(L){return u===Q?(w+L)/2:w+(R-u)/(Q-u)*(L-w)}}}}};b.secToNum=function(u){return u};b.drawBeats=function(u){return function(Q){return function(R){return function(){z(g.customize.highwayLine)(R)();return y.zoomDescDo(t.ordSeconds)(G.monadEffect)(Q.minSecs)(Q.maxSecs)(R.song.beats.lines)(function(w){return function(L){var T=u(w),Z=function(){if(L instanceof K.Bar)return g.customize.highwayBarHeight;
if(L instanceof K.Beat)return g.customize.highwayBeatHeight;if(L instanceof K.HalfBeat)return g.customize.highwayHalfBeatHeight;throw Error("Draw.Common (205:13-208:54): "+[L.constructor.name]);}();return function(){z(g.customize.highwayLine)(R)();return F({x:Q.x,y:k.toNumber(T-(Z>>1)|0),width:Q.width,height:Z})(R)()}}})()}}}};b.drawBadge=ba;b.drawBadgeVertical=function(u){return function(Q){return function(R){return function(w){return function(){var L=D.getCanvasHeight(w.canvas)()-g.customize.labelPositionVert,
T=Q+R/2;return ba(u)({x:T,y:L})(w)()}}}}};b.drawBadgeHorizontal=function(u){return function(Q){return function(R){return function(w){return function(){D.translate(w.context)({translateX:g.customize.labelPositionHoriz,translateY:Q+R/2})();D.rotate(w.context)(-1.5707963267948966)();ba(u)({x:0,y:0})(w)();return D.setTransform(w.context)({m11:1,m12:0,m21:0,m22:1,m31:0,m32:0})()}}}}}})(PS);
(function(a){a.showErrorImpl=function(b){return b.stack||b.toString()};a.error=function(b){return Error(b)};a.throwException=function(b){return function(){throw b;}};a.catchException=function(b){return function(c){return function(){try{return c()}catch(h){return h instanceof Error||"[object Error]"===Object.prototype.toString.call(h)?b(h)():b(Error(h.toString()))()}}}}})(PS["Effect.Exception"]=PS["Effect.Exception"]||{});
(function(a){a["Effect.Exception"]=a["Effect.Exception"]||{};var b=a["Effect.Exception"],c=a["Effect.Exception"];a=new a["Data.Show"].Show(c.showErrorImpl);b.showError=a;b.error=c.error;b.throwException=c.throwException;b.catchException=c.catchException})(PS);(function(a){a.unsafePerformEffect=function(b){return b()}})(PS["Effect.Unsafe"]=PS["Effect.Unsafe"]||{});(function(a){a["Effect.Unsafe"]=a["Effect.Unsafe"]||{};a["Effect.Unsafe"].unsafePerformEffect=a["Effect.Unsafe"].unsafePerformEffect})(PS);
(function(a){a["Effect.Exception.Unsafe"]=a["Effect.Exception.Unsafe"]||{};var b=a["Effect.Exception.Unsafe"],c=a["Effect.Exception"],h=a["Effect.Unsafe"],e=function(k){return h.unsafePerformEffect(c.throwException(k))};b.unsafeThrowException=e;b.unsafeThrow=function(k){return e(c.error(k))}})(PS);
(function(a){a.Images=a.Images||{};var b=a.Images,c=a["Control.Monad.Cont.Trans"],h=a["Control.Parallel"],e=a["Control.Parallel.Class"],k=a["Data.Array"],d=a["Data.Functor"],m=a["Data.Maybe"],q=a["Data.Traversable"],p=a.Effect,C=a["Effect.Class"],t=a["Effect.Exception"],v=a["Effect.Exception.Unsafe"],G=a["Graphics.Canvas"],D={index:154,name:"pro-fret-24"},n={index:153,name:"pro-fret-23"},y={index:152,name:"pro-fret-22"},K={index:151,name:"pro-fret-21"},g={index:150,name:"pro-fret-20"},U={index:149,
name:"pro-fret-19"},H={index:148,name:"pro-fret-18"},z={index:147,name:"pro-fret-17"},F={index:146,name:"pro-fret-16"},N={index:145,name:"pro-fret-15"},r={index:144,name:"pro-fret-14"},J={index:143,name:"pro-fret-13"},ba={index:142,name:"pro-fret-12"},u={index:141,name:"pro-fret-11"},Q={index:140,name:"pro-fret-10"},R={index:139,name:"pro-fret-09"},w={index:138,name:"pro-fret-08"},L={index:137,name:"pro-fret-07"},T={index:136,name:"pro-fret-06"},Z={index:135,name:"pro-fret-05"},la={index:134,name:"pro-fret-04"},
aa={index:133,name:"pro-fret-03"},X={index:132,name:"pro-fret-02"},pa={index:131,name:"pro-fret-01"},ea={index:130,name:"pro-fret-00"},I=[ea,pa,X,aa,la,Z,T,L,w,R,Q,u,ba,J,r,N,F,z,H,U,g,K,y,n,D],ma={index:129,name:"icon-vocal-3"},va={index:128,name:"icon-vocal-2"},fa={index:127,name:"icon-vocal-1"},ua={index:126,name:"icon-real-drums"},B={index:125,name:"icon-pro-keys"},A={index:124,name:"icon-pro-guitar"},M={index:123,name:"icon-pro-drums"},da={index:122,name:"icon-pro-bass"},O={index:121,name:"icon-keys"},
Y={index:120,name:"icon-guitar"},P={index:119,name:"icon-ghl"},ca={index:118,name:"icon-drums"},V={index:117,name:"icon-dance"},S={index:116,name:"icon-bass"},ha={index:115,name:"icon-amplitude"},x={index:114,name:"highway-target-yellow"},l={index:113,name:"highway-target-red"},W={index:112,name:"highway-target-orange"},ja={index:111,name:"highway-target-green"},oa={index:110,name:"highway-target-blue"},xa={index:109,name:"highway-target-arrow-hit"},Aa={index:108,name:"highway-target-arrow"},sa={index:107,
name:"highway-protar-target-yellow"},wa={index:106,name:"highway-protar-target-red"},Fa={index:105,name:"highway-protar-target-purple"},Ca={index:104,name:"highway-protar-target-orange"},Ea={index:103,name:"highway-protar-target-green"},Ia={index:102,name:"highway-protar-target-blue"},Ja={index:101,name:"highway-prokeys-target"},Ha={index:100,name:"highway-ghl-target"},Ga={index:99,name:"highway-catch-target"},Ma={index:98,name:"gem-yellow-tap"},Na={index:97,name:"gem-yellow-pro-tap"},Oa={index:96,
name:"gem-yellow-pro-hopo"},Pa={index:95,name:"gem-yellow-pro"},Qa={index:94,name:"gem-yellow-hopo"},Ra={index:93,name:"gem-yellow-hhpedal"},Sa={index:92,name:"gem-yellow-hhopen"},Ta={index:91,name:"gem-yellow-hhclosed"},Ua={index:90,name:"gem-yellow-cymbal"},fb={index:89,name:"gem-yellow"},jb={index:88,name:"gem-whitekey-energy"},kb={index:87,name:"gem-whitekey"},lb={index:86,name:"gem-whiteblack-tap"},$a={index:85,name:"gem-whiteblack-hopo"},Ka={index:84,name:"gem-whiteblack"},ab={index:83,name:"gem-white-tap"},
bb={index:82,name:"gem-white-hopo"},cb={index:81,name:"gem-white"},db={index:80,name:"gem-red-tap"},Va={index:79,name:"gem-red-rimshot"},La={index:78,name:"gem-red-pro-tap"},Wa={index:77,name:"gem-red-pro-hopo"},Xa={index:76,name:"gem-red-pro"},eb={index:75,name:"gem-red-hopo"},Ya={index:74,name:"gem-red-cymbal"},gb={index:73,name:"gem-red-arrow"},Gb={index:72,name:"gem-red"},ub={index:71,name:"gem-purple-pro-tap"},Hb={index:70,name:"gem-purple-pro-hopo"},Ib={index:69,name:"gem-purple-pro"},Jb={index:68,
name:"gem-orange-tap"},vb={index:67,name:"gem-orange-pro-tap"},wb={index:66,name:"gem-orange-pro-hopo"},xb={index:65,name:"gem-orange-pro"},yb={index:64,name:"gem-orange-hopo"},mb={index:63,name:"gem-orange-cymbal"},zb={index:62,name:"gem-orange"},Kb={index:61,name:"gem-openghl-tap"},Lb={index:60,name:"gem-openghl-hopo"},Mb={index:59,name:"gem-openghl-energy"},Nb={index:58,name:"gem-openghl"},Ob={index:57,name:"gem-open-tap"},Pb={index:56,name:"gem-open-hopo"},Ba={index:55,name:"gem-open-energy-tap"},
pb={index:54,name:"gem-open-energy-hopo"},oc={index:53,name:"gem-open-energy"},pc={index:52,name:"gem-open"},Qb={index:51,name:"gem-mute-tap"},qb={index:50,name:"gem-mute-hopo"},Rb={index:49,name:"gem-mute"},Sb={index:48,name:"gem-mine"},Tb={index:47,name:"gem-kick-energy"},Ab={index:46,name:"gem-kick"},Ub={index:45,name:"gem-green-tap"},Vb={index:44,name:"gem-green-rimshot"},Wb={index:43,name:"gem-green-pro-tap"},Xb={index:42,name:"gem-green-pro-hopo"},Yb={index:41,name:"gem-green-pro"},Zb={index:40,
name:"gem-green-hopo"},$b={index:39,name:"gem-green-cymbal"},ac={index:38,name:"gem-green"},rb={index:37,name:"gem-ghl-energy"},ob={index:36,name:"gem-energy-tap"},sb={index:35,name:"gem-energy-rimshot"},bc={index:34,name:"gem-energy-pro-tap"},cc={index:33,name:"gem-energy-pro-hopo"},hb={index:32,name:"gem-energy-pro"},dc={index:31,name:"gem-energy-mute-tap"},ec={index:30,name:"gem-energy-mute-hopo"},fc={index:29,name:"gem-energy-mute"},Za={index:28,name:"gem-energy-hopo"},tb={index:27,name:"gem-energy-hhpedal"},
Cb={index:26,name:"gem-energy-hhopen"},gc={index:25,name:"gem-energy-hhclosed"},hc={index:24,name:"gem-energy-cymbal"},Db={index:23,name:"gem-energy"},ic={index:22,name:"gem-catch"},jc={index:21,name:"gem-blue-tap"},Eb={index:20,name:"gem-blue-pro-tap"},kc={index:19,name:"gem-blue-pro-hopo"},lc={index:18,name:"gem-blue-pro"},mc={index:17,name:"gem-blue-hopo"},nc={index:16,name:"gem-blue-hhpedal"},f={index:15,name:"gem-blue-hhopen"},E={index:14,name:"gem-blue-hhclosed"},ra={index:13,name:"gem-blue-cymbal"},
ta={index:12,name:"gem-blue-arrow"},ka={index:11,name:"gem-blue"},ia={index:10,name:"gem-blackwhite-tap"},na={index:9,name:"gem-blackwhite-hopo"},qa={index:8,name:"gem-blackwhite"},ya={index:7,name:"gem-blackkey-energy"},za={index:6,name:"gem-blackkey"},Da={index:5,name:"gem-black-tap"},nb={index:4,name:"gem-black-hopo"},Bb={index:3,name:"gem-black"},qc={index:2,name:"button-play"},rc={index:1,name:"button-pause"},sc={index:0,name:"button-gear"},vc=function(uc){return"images/"+(uc.name+".png")},wc=
[sc,rc,qc,Bb,nb,Da,za,ya,qa,na,ia,ka,ta,ra,E,f,nc,mc,lc,kc,Eb,jc,ic,Db,hc,gc,Cb,tb,Za,fc,ec,dc,hb,cc,bc,sb,ob,rb,ac,$b,Zb,Yb,Xb,Wb,Vb,Ub,Ab,Tb,Sb,Rb,qb,Qb,pc,oc,pb,Ba,Pb,Ob,Nb,Mb,Lb,Kb,zb,mb,yb,xb,wb,vb,Jb,Ib,Hb,ub,Gb,gb,Ya,eb,Xa,Wa,La,Va,db,cb,bb,ab,Ka,$a,lb,kb,jb,fb,Ua,Ta,Sa,Ra,Qa,Pa,Oa,Na,Ma,Ga,Ha,Ja,Ia,Ea,Ca,Fa,wa,sa,Aa,xa,oa,ja,W,l,x,ha,S,V,ca,P,Y,O,da,M,A,B,ua,fa,va,ma,ea,pa,X,aa,la,Z,T,L,w,R,Q,u,ba,J,r,N,F,z,H,U,g,K,y,n,D],xc=function(){var uc=function(Fb){return function(tc){return G.tryLoadImage(Fb)(function(ib){if(ib instanceof
m.Just)return tc(ib.value0);if(ib instanceof m.Nothing)return t.throwException(t.error("could not load image from path: "+Fb));throw Error("Images (342:51-344:84): "+[ib.constructor.name]);})}};return c.runContT(d.map(c.functorContT(p.functorEffect))(function(Fb){return function(tc){var ib=k.index(Fb)(tc.index);if(ib instanceof m.Just)return ib.value0;if(ib instanceof m.Nothing)return v.unsafeThrow("panic! couldn't access image "+tc.name);throw Error("Images (346:25-348:74): "+[ib.constructor.name]);
}})(h.parTraverse(e.monadParParCont(C.monadEffectEffect))(q.traversableArray)(function(Fb){return c.ContT(uc(vc(Fb)))})(wc)))}();b.image_button_gear=sc;b.image_button_pause=rc;b.image_button_play=qc;b.image_gem_black=Bb;b.image_gem_black_hopo=nb;b.image_gem_black_tap=Da;b.image_gem_blackkey=za;b.image_gem_blackkey_energy=ya;b.image_gem_blackwhite=qa;b.image_gem_blackwhite_hopo=na;b.image_gem_blackwhite_tap=ia;b.image_gem_blue=ka;b.image_gem_blue_arrow=ta;b.image_gem_blue_cymbal=ra;b.image_gem_blue_hhclosed=
E;b.image_gem_blue_hhopen=f;b.image_gem_blue_hhpedal=nc;b.image_gem_blue_hopo=mc;b.image_gem_blue_pro=lc;b.image_gem_blue_pro_hopo=kc;b.image_gem_blue_pro_tap=Eb;b.image_gem_blue_tap=jc;b.image_gem_catch=ic;b.image_gem_energy=Db;b.image_gem_energy_cymbal=hc;b.image_gem_energy_hhclosed=gc;b.image_gem_energy_hhopen=Cb;b.image_gem_energy_hhpedal=tb;b.image_gem_energy_hopo=Za;b.image_gem_energy_mute=fc;b.image_gem_energy_mute_hopo=ec;b.image_gem_energy_mute_tap=dc;b.image_gem_energy_pro=hb;b.image_gem_energy_pro_hopo=
cc;b.image_gem_energy_pro_tap=bc;b.image_gem_energy_rimshot=sb;b.image_gem_energy_tap=ob;b.image_gem_ghl_energy=rb;b.image_gem_green=ac;b.image_gem_green_cymbal=$b;b.image_gem_green_hopo=Zb;b.image_gem_green_pro=Yb;b.image_gem_green_pro_hopo=Xb;b.image_gem_green_pro_tap=Wb;b.image_gem_green_rimshot=Vb;b.image_gem_green_tap=Ub;b.image_gem_kick=Ab;b.image_gem_kick_energy=Tb;b.image_gem_mine=Sb;b.image_gem_mute=Rb;b.image_gem_mute_hopo=qb;b.image_gem_mute_tap=Qb;b.image_gem_open=pc;b.image_gem_open_energy=
oc;b.image_gem_open_energy_hopo=pb;b.image_gem_open_energy_tap=Ba;b.image_gem_open_hopo=Pb;b.image_gem_open_tap=Ob;b.image_gem_openghl=Nb;b.image_gem_openghl_energy=Mb;b.image_gem_openghl_hopo=Lb;b.image_gem_openghl_tap=Kb;b.image_gem_orange=zb;b.image_gem_orange_cymbal=mb;b.image_gem_orange_hopo=yb;b.image_gem_orange_pro=xb;b.image_gem_orange_pro_hopo=wb;b.image_gem_orange_pro_tap=vb;b.image_gem_orange_tap=Jb;b.image_gem_purple_pro=Ib;b.image_gem_purple_pro_hopo=Hb;b.image_gem_purple_pro_tap=ub;
b.image_gem_red=Gb;b.image_gem_red_arrow=gb;b.image_gem_red_cymbal=Ya;b.image_gem_red_hopo=eb;b.image_gem_red_pro=Xa;b.image_gem_red_pro_hopo=Wa;b.image_gem_red_pro_tap=La;b.image_gem_red_rimshot=Va;b.image_gem_red_tap=db;b.image_gem_white=cb;b.image_gem_white_hopo=bb;b.image_gem_white_tap=ab;b.image_gem_whiteblack=Ka;b.image_gem_whiteblack_hopo=$a;b.image_gem_whiteblack_tap=lb;b.image_gem_whitekey=kb;b.image_gem_whitekey_energy=jb;b.image_gem_yellow=fb;b.image_gem_yellow_cymbal=Ua;b.image_gem_yellow_hhclosed=
Ta;b.image_gem_yellow_hhopen=Sa;b.image_gem_yellow_hhpedal=Ra;b.image_gem_yellow_hopo=Qa;b.image_gem_yellow_pro=Pa;b.image_gem_yellow_pro_hopo=Oa;b.image_gem_yellow_pro_tap=Na;b.image_gem_yellow_tap=Ma;b.image_highway_catch_target=Ga;b.image_highway_ghl_target=Ha;b.image_highway_prokeys_target=Ja;b.image_highway_protar_target_blue=Ia;b.image_highway_protar_target_green=Ea;b.image_highway_protar_target_orange=Ca;b.image_highway_protar_target_purple=Fa;b.image_highway_protar_target_red=wa;b.image_highway_protar_target_yellow=
sa;b.image_highway_target_arrow=Aa;b.image_highway_target_arrow_hit=xa;b.image_highway_target_blue=oa;b.image_highway_target_green=ja;b.image_highway_target_orange=W;b.image_highway_target_red=l;b.image_highway_target_yellow=x;b.image_icon_amplitude=ha;b.image_icon_bass=S;b.image_icon_dance=V;b.image_icon_drums=ca;b.image_icon_ghl=P;b.image_icon_guitar=Y;b.image_icon_keys=O;b.image_icon_pro_bass=da;b.image_icon_pro_drums=M;b.image_icon_pro_guitar=A;b.image_icon_pro_keys=B;b.image_icon_real_drums=
ua;b.image_icon_vocal_1=fa;b.image_icon_vocal_2=va;b.image_icon_vocal_3=ma;b.image_pro_fret_00=ea;b.image_pro_fret_01=pa;b.image_pro_fret_02=X;b.image_pro_fret_03=aa;b.image_pro_fret_04=la;b.image_pro_fret_05=Z;b.image_pro_fret_06=T;b.image_pro_fret_07=L;b.image_pro_fret_08=w;b.image_pro_fret_09=R;b.image_pro_fret_10=Q;b.image_pro_fret_11=u;b.image_pro_fret_12=ba;b.image_pro_fret_13=J;b.image_pro_fret_14=r;b.image_pro_fret_15=N;b.image_pro_fret_16=F;b.image_pro_fret_17=z;b.image_pro_fret_18=H;b.image_pro_fret_19=
U;b.image_pro_fret_20=g;b.image_pro_fret_21=K;b.image_pro_fret_22=y;b.image_pro_fret_23=n;b.image_pro_fret_24=D;b.allImageIDs=wc;b.imageURL=vc;b.withImages=xc;b.protarFrets=I})(PS);
(function(a){a.Draw=a.Draw||{};var b=a.Draw,c=a.Draw,h=a["Control.Applicative"],e=a["Control.Bind"],k=a["Control.MonadZero"],d=a["Data.Array"],m=a["Data.Eq"],q=a["Data.Foldable"],p=a["Data.Functor"],C=a["Data.Int"],t=a["Data.Map"],v=a["Data.Map.Internal"],G=a["Data.Maybe"],D=a["Data.Set"],n=a["Data.Symbol"],y=a["Data.Time.Duration"],K=a["Draw.Common"],g=a.Effect,U=a["Graphics.Canvas"],H=a.Images,z=a.Style,F=z.customize.marginWidth,N=z.customize.buttonWidth;b.draw=function(r){return function(){var J=
c.getWindowDims(),ba=U.getCanvasDimensions(r.canvas)();h.when(g.applicativeEffect)(m.notEq(m.eqRec()(m.eqRowCons(m.eqRowCons(m.eqRowNil)()(new n.IsSymbol(function(){return"width"}))(m.eqNumber))()(new n.IsSymbol(function(){return"height"}))(m.eqNumber)))(ba)(J))(U.setCanvasDimensions(r.canvas)(J))();K.setFillStyle(z.customize.background)(r)();K.fillRect({x:0,y:0,width:J.width,height:J.height})(r)();K.setFillStyle(z.customize.timestampColor)(r)();K.onContext(function(L){return function(){U.setFont(L)(z.customize.timestampFont)();
U.setTextAlign(L)(U.AlignRight.value)();U.fillText(L)(K.showTimestamp(r.time))(J.width-20)(J.height-20)();return q.for_(g.applicativeEffect)(q.foldableMaybe)(v.lookupLE(y.ordSeconds)(r.time)(r.song.sections))(function(T){return U.fillText(L)(T.value)(J.width-20)(J.height-45)})()}})(r)();var u=function(L){return function(T){var Z=d.uncons(T);if(Z instanceof G.Nothing)return h.pure(g.applicativeEffect)(L);if(Z instanceof G.Just)return function(){var la=Z.value0.head(L)();return u(la)(Z.value0.tail)()};
throw Error("Draw (52:33-56:35): "+[Z.constructor.name]);}};ba=function(L){return function(T){return function(Z){return p["void"](g.functorEffect)(u(T)(e.bind(e.bindArray)(Z.app.settings.parts)(function(la){return e.bind(e.bindArray)(la.flexParts)(function(aa){return e.bind(e.bindArray)(aa.difficulties)(function(X){return e.discard(e.discardUnit)(e.bindArray)(k.guard(k.monadZeroArray)(X.enabled))(function(){return e.discard(e.discardUnit)(e.bindArray)(k.guard(k.monadZeroArray)(L===aa.typeVertical))(function(){return h.pure(h.applicativeArray)(function(pa){return X.draw({name:la.partName,
icon:aa.typeIcon,difficulty:X.diffName})(pa)(Z)})})})})})})))}}};var Q=ba(!1)(0),R=ba(!0)((F+N|0)+F|0);(function(){if(r.app.settings.staticVert){var L=.65*J.height,T=function(X){var pa=X+z.customize.targetPositionVert,ea=pa-L+F;return h.when(g.applicativeEffect)(0<pa&&ea<J.height)(function(){p["void"](g.functorEffect)(U.save(r.context))();p["void"](g.functorEffect)(U.beginPath(r.context))();p["void"](g.functorEffect)(U.rect(r.context)({x:0,y:ea,width:J.width,height:pa-ea}))();p["void"](g.functorEffect)(U.clip(r.context))();
R({app:r.app,canvas:r.canvas,context:r.context,getImage:r.getImage,maxY:r.maxY,minY:r.minY,pxToSecsHoriz:r.pxToSecsHoriz,pxToSecsVert:function(I){return y.Seconds((I-J.height+X)/z.customize.trackSpeed)},secsToPxHoriz:r.secsToPxHoriz,secsToPxVert:function(I){return C.round(J.height-X+z.customize.trackSpeed*I)},song:r.song,time:r.time})();return p["void"](g.functorEffect)(U.restore(r.context))()})},Z=J.height-z.customize.targetPositionVert-c.numMod(r.time*z.customize.trackSpeed)(L),la=Z-L,aa=Z+L;T(Z)();
T(la)();return T(aa)()}return R(r)()})();Q(r)();if(r.app.time instanceof K.Paused)ba=H.image_button_play;else if(r.app.time instanceof K.Playing)ba=H.image_button_pause;else throw Error("Draw (98:19-100:40): "+[r.app.time.constructor.name]);K.drawImage(ba)(F)(J.height-2*F-2*N)(r)();K.drawImage(H.image_button_gear)(F)(J.height-F-N)(r)();var w=J.height-4*F-2*N-2;ba=r.time/r.song.end;K.setFillStyle(z.customize.progressBorder)(r)();K.fillRect({x:F,y:F,width:N,height:w+2})(r)();K.setFillStyle(z.customize.progressEmpty)(r)();
K.fillRect({x:F+1,y:F+1,width:N-2,height:w})(r)();K.setFillStyle(z.customize.progressFilled)(r)();K.fillRect({x:F+1,y:F+1+w*(1-ba),width:N-2,height:w*ba})(r)();K.setFillStyle(z.customize.progressSection)(r)();return q.for_(g.applicativeEffect)(D.foldableSet)(t.keys(r.song.sections))(function(L){return K.fillRect({x:F+(N-z.customize.progressSectionWidth|0)/2,y:F+1+(w-L/r.song.end*w),width:z.customize.progressSectionWidth,height:1})(r)})()}};b._M=F;b._B=N;b.getWindowDims=c.getWindowDims;b.numMod=c.numMod})(PS);
(function(a){a["Draw.Amplitude"]=a["Draw.Amplitude"]||{};var b=a["Control.Applicative"],c=a["Data.Foldable"],h=a["Data.Functor"],e=a["Data.Int"],k=a["Data.Semigroup"],d=a["Data.Time.Duration"],m=a["Data.Unit"],q=a["Draw.Common"],p=a.Effect,C=a["Graphics.Canvas"],t=a.Images,v=a.OnyxMap,G=a.Song,D=a.Style;a["Draw.Amplitude"].drawAmplitude=function(n){return function(y){return function(K){return function(g){return function(){var U=h.map(p.functorEffect)(e.round)(C.getCanvasHeight(g.canvas))(),H=function(ba){return U-
g.secsToPxVert(k.append(d.semigroupSeconds)(ba)(d.negateDuration(d.durationSeconds)(g.time)))|0},z=H(g.time),F=function(ba){return k.append(d.semigroupSeconds)(g.pxToSecsVert(U-ba|0))(g.time)},N=F(g.maxY+50|0),r=F(g.minY-50|0),J=g.maxY-g.minY|0;q.setFillStyle("Drums"===n.instrument?"#dd73ca":"Bass"===n.instrument?"#739ddd":"Synth"===n.instrument?"#cec371":"Vocal"===n.instrument?"#73dd81":"Guitar"===n.instrument?"#ef9558":D.customize.highway)(g)();q.fillRect({x:K,y:g.minY,width:105,height:J})(g)();
q.setFillStyle(D.customize.highwayRailing)(g)();c.for_(p.applicativeEffect)(c.foldableArray)([0,103])(function(ba){return q.fillRect({x:K+ba|0,y:g.minY,width:1,height:J})(g)})();q.setFillStyle(D.customize.highwayDivider)(g)();c.for_(p.applicativeEffect)(c.foldableArray)([1,104])(function(ba){return q.fillRect({x:K+ba|0,y:g.minY,width:1,height:J})(g)})();q.drawBeats(H)({x:K+2|0,width:101,minSecs:N,maxSecs:r})(g)();q.drawImage(t.image_highway_catch_target)(K)(z-6)(g)();(function(ba){return v.zoomDescDo(d.ordSeconds)(ba)(N)(r)})(p.monadEffect)(n.notes)(function(ba){return function(u){var Q=
q.secToNum(k.append(d.semigroupSeconds)(ba)(d.negateDuration(d.durationSeconds)(g.time)));if(g.app.settings.autoplay&&0>=Q){if(-.1<Q){var R=(Q+.1)/.05;return function(){q.setFillStyle(D.customize.sustainBlue.hit(R))(g)();return q.fillEllipse({x:function(){if(u instanceof G.L)return K+19.5;if(u instanceof G.M)return K+52.5;if(u instanceof G.R)return K+85.5;throw Error("Draw.Amplitude (65:20-69:15): "+[u.constructor.name]);}(),y:z+.5,rx:16.5,ry:7.5})(g)()}}return b.pure(p.applicativeEffect)(m.unit)}Q=
H(ba);var w=function(){if(u instanceof G.L)return K+4|0;if(u instanceof G.M)return K+37|0;if(u instanceof G.R)return K+70|0;throw Error("Draw.Amplitude (77:17-81:9): "+[u.constructor.name]);}();return q.drawImage(t.image_gem_catch)(w)(Q-6|0)(g)}})();q.drawBadgeVertical(y)(K)(105)(g)();return(K+105|0)+D.customize.marginWidth|0}}}}}})(PS);
(function(a){a["Draw.Dance"]=a["Draw.Dance"]||{};var b=a["Draw.Dance"],c=a["Control.Applicative"],h=a["Data.Foldable"],e=a["Data.Functor"],k=a["Data.Int"],d=a["Data.Semigroup"],m=a["Data.Time.Duration"],q=a["Data.Unit"],p=a["Draw.Common"],C=a.Effect,t=a["Graphics.Canvas"],v=a.Images,G=a.Math,D=a.OnyxMap,n=a.Song,y=a.Style,K=function(g){return function(U){return function(H){return function(z){return t.withContext(z.context)(function(){t.translate(z.context)({translateX:H.x+H.w/2,translateY:H.y+H.h/
2})();t.rotate(z.context)(G.pi/2*g)();return p.drawImage(U)(-.5*H.w)(-.5*H.h)(z)()})}}}};b.drawRotated=K;b.drawDance=function(g){return function(U){return function(H){return function(z){return function(){var F=e.map(C.functorEffect)(k.round)(t.getCanvasHeight(z.canvas))(),N=function(L){return F-z.secsToPxVert(d.append(m.semigroupSeconds)(L)(m.negateDuration(m.durationSeconds)(z.time)))|0},r=N(z.time),J=function(L){return d.append(m.semigroupSeconds)(z.pxToSecsVert(F-L|0))(z.time)},ba=J(z.maxY+50|
0),u=J(z.minY-50|0),Q=function(L){return D.zoomDescDo(m.ordSeconds)(L)(ba)(u)},R=z.maxY-z.minY|0,w=k.quot(29)(2);p.setFillStyle(y.customize.highway)(z)();p.fillRect({x:H,y:z.minY,width:136,height:R})(z)();p.setFillStyle(y.customize.highwayRailing)(z)();h.for_(C.applicativeEffect)(h.foldableArray)([0,134])(function(L){return p.fillRect({x:H+L|0,y:z.minY,width:1,height:R})(z)})();p.setFillStyle(y.customize.highwayDivider)(z)();h.for_(C.applicativeEffect)(h.foldableArray)([1,135])(function(L){return p.fillRect({x:H+
L|0,y:z.minY,width:1,height:R})(z)})();p.drawBeats(N)({x:H+2|0,width:132,minSecs:ba,maxSecs:u})(z)();K(3)(v.image_highway_target_arrow)({x:H+4|0,y:r-w|0,w:29,h:29})(z)();K(2)(v.image_highway_target_arrow)({x:k.toNumber((H+8|0)+29|0),y:r-w|0,w:29,h:29})(z)();p.drawImage(v.image_highway_target_arrow)(k.toNumber((H+12|0)+58|0))(r-w|0)(z)();K(1)(v.image_highway_target_arrow)({x:k.toNumber((H+16|0)+87|0),y:r-w|0,w:29,h:29})(z)();h.for_(C.applicativeEffect)(h.foldableArray)([{fn:function(L){return L.left},
i:0,rotate:3},{fn:function(L){return L.down},i:1,rotate:2},{fn:function(L){return L.up},i:2,rotate:0},{fn:function(L){return L.right},i:3,rotate:1}])(function(L){return Q(C.monadEffect)(L.fn(g.notes))(function(T){return function(Z){var la=function(aa){var X=aa instanceof n.NoteMine?!0:!1;var pa=p.secToNum(d.append(m.semigroupSeconds)(T)(m.negateDuration(m.durationSeconds)(z.time)));if(z.app.settings.autoplay&&0>=pa&&!X){if(-.1<pa){var ea=r-w|0,I=(H+(4*(1+L.i|0)|0)|0)+(29*L.i|0)|0,ma=(pa+.1)/.05;return function(){t.setGlobalAlpha(z.context)(ma)();
0===L.rotate?p.drawImage(v.image_highway_target_arrow_hit)(I)(ea)(z)():K(L.rotate)(v.image_highway_target_arrow_hit)({x:I,y:ea,w:29,h:29})(z)();return t.setGlobalAlpha(z.context)(1)()}}return c.pure(C.applicativeEffect)(q.unit)}ea=N(T)-w|0;I=(H+(4*(1+L.i|0)|0)|0)+(29*L.i|0)|0;aa=aa instanceof n.NoteMine?v.image_gem_mine:v.image_gem_red_arrow;return 0===L.rotate?p.drawImage(aa)(I)(ea)(z):K(L.rotate)(aa)({x:I,y:ea,w:29,h:29})(z)};if(Z instanceof n.Note||Z instanceof n.Sustain)return la(Z.value0);if(Z instanceof
n.SustainEnd)return c.pure(C.applicativeEffect)(q.unit);throw Error("Draw.Dance (134:10-137:35): "+[Z.constructor.name]);}})})();p.drawBadgeVertical(U)(H)(136)(z)();return(H+136|0)+y.customize.marginWidth|0}}}}}})(PS);
(function(a){a["Draw.Drums"]=a["Draw.Drums"]||{};var b=a["Control.Applicative"],c=a["Data.Array"],h=a["Data.Foldable"],e=a["Data.Function"],k=a["Data.Functor"],d=a["Data.Int"],m=a["Data.List"],q=a["Data.List.Types"],p=a["Data.Map.Internal"],C=a["Data.Maybe"],t=a["Data.Semigroup"],v=a["Data.Time.Duration"],G=a["Data.Tuple"],D=a["Data.Unit"],n=a["Draw.Common"],y=a.Effect,K=a["Graphics.Canvas"],g=a.Images,U=a.OnyxMap,H=a.Song,z=a.Style;a["Draw.Drums"].drawDrums=function(F){return function(N){return function(r){return function(J){return function(){var ba=
k.map(y.functorEffect)(d.round)(K.getCanvasHeight(J.canvas))(),u=function(fa){return ba-J.secsToPxVert(t.append(v.semigroupSeconds)(fa)(v.negateDuration(v.durationSeconds)(J.time)))|0},Q=u(J.time),R=function(fa){return t.append(v.semigroupSeconds)(J.pxToSecsVert(ba-fa|0))(J.time)};var w=F.mode instanceof H.Drums5?5:4;var L=(w*z.customize.widthStandardFret|0)+2|0,T=R(J.maxY+50|0),Z=R(J.minY-50|0),la=function(fa){return U.zoomAscDo(v.ordSeconds)(fa)(T)(Z)};R=function(fa){return U.zoomDescDo(v.ordSeconds)(fa)(T)(Z)};
var aa=function(fa){return J.app.settings.leftyFlip?(w-1|0)-fa|0:fa},X=J.maxY-J.minY|0;n.setFillStyle(z.customize.highway)(J)();n.fillRect({x:r,y:J.minY,width:L,height:X})(J)();n.setFillStyle(z.customize.highwaySolo)(J)();var pa=function(){var fa=p.lookupLE(v.ordSeconds)(T)(F.solo);if(fa instanceof C.Nothing)return!1;if(fa instanceof C.Just)return fa.value0.value;throw Error("Draw.Drums (208:22-210:31): "+[fa.constructor.name]);}();pa=m.fromFoldable(h.foldableArray)(c.cons(new G.Tuple(T,pa))(e.flip(c.snoc)(new G.Tuple(Z,
!1))(U.doTupleArray(function(fa){return la(fa)(F.solo)}))));var ea=function(fa){if(fa instanceof q.Nil||fa instanceof q.Cons&&fa.value1 instanceof q.Nil)return b.pure(y.applicativeEffect)(D.unit);if(fa instanceof q.Cons&&fa.value1 instanceof q.Cons){var ua=u(fa.value1.value0.value0),B=u(fa.value0.value0),A=k.map(k.functorArray)(function(Y){return(Y*z.customize.widthStandardFret|0)+2|0}),M=c.range(0);var da=F.mode instanceof H.Drums5?4:3;var O=A(M(da));return function(){b.when(y.applicativeEffect)(fa.value0.value1)(h.for_(y.applicativeEffect)(h.foldableArray)(O)(function(Y){return n.fillRect({x:r+
Y|0,y:ua,width:z.customize.widthStandardFret-2|0,height:B-ua|0})(J)}))();return ea(fa.value1)()}}throw Error("Draw.Drums (216:7-216:45): "+[fa.constructor.name]);};ea(pa)();R(y.monadEffect)(F.solo)(function(fa){return function(ua){var B=u(fa);return function(){n.setFillStyle(z.customize.highwaySoloEdge)(J)();return n.fillRect({x:r,y:B,width:L,height:1})(J)()}}})();n.drawBeats(u)({x:r,width:L,minSecs:T,maxSecs:Z})(J)();n.setFillStyle(z.customize.highwayRailing)(J)();pa=k.map(k.functorArray)(function(fa){return(fa*
z.customize.widthStandardFret|0)+1|0})(c.range(0)(w));var I=k.map(k.functorArray)(function(fa){return fa*z.customize.widthStandardFret|0})(c.range(0)(w));h.for_(y.applicativeEffect)(h.foldableArray)(I)(function(fa){return n.fillRect({x:r+fa|0,y:J.minY,width:1,height:X})(J)})();n.setFillStyle(z.customize.highwayDivider)(J)();h.for_(y.applicativeEffect)(h.foldableArray)(pa)(function(fa){return n.fillRect({x:r+fa|0,y:J.minY,width:1,height:X})(J)})();pa=[{x:(aa(0)*z.customize.widthStandardFret|0)+2|0,
gem:H.Red.value},{x:(aa(0)*z.customize.widthStandardFret|0)+2|0,gem:H.Rimshot.value},{x:(aa(1)*z.customize.widthStandardFret|0)+2|0,gem:H.HHOpen.value},{x:(aa(1)*z.customize.widthStandardFret|0)+2|0,gem:H.HHSizzle.value},{x:(aa(1)*z.customize.widthStandardFret|0)+2|0,gem:H.HHPedal.value},{x:(aa(1)*z.customize.widthStandardFret|0)+2|0,gem:H.YCym.value},{x:(aa(1)*z.customize.widthStandardFret|0)+2|0,gem:H.YTom.value},{x:(aa(2)*z.customize.widthStandardFret|0)+2|0,gem:H.BCym.value},{x:(aa(2)*z.customize.widthStandardFret|
0)+2|0,gem:H.BTom.value},{x:(aa(3)*z.customize.widthStandardFret|0)+2|0,gem:H.OCym.value},{x:(aa(w-1|0)*z.customize.widthStandardFret|0)+2|0,gem:H.GCym.value},{x:(aa(w-1|0)*z.customize.widthStandardFret|0)+2|0,gem:H.GTom.value}];h.for_(y.applicativeEffect)(h.foldableArray)(pa)(function(fa){var ua=p.union(v.ordSeconds)(F.bre)(C.fromMaybe(p.empty)(p.lookup(H.ordGem)(fa.gem)(F.lanes))),B=function(){var M=p.lookupLE(v.ordSeconds)(T)(ua);if(M instanceof C.Nothing)return!1;if(M instanceof C.Just)return M.value0.value;
throw Error("Draw.Drums (268:20-270:29): "+[M.constructor.name]);}();B=m.fromFoldable(h.foldableArray)(c.cons(new G.Tuple(T,B))(e.flip(c.snoc)(new G.Tuple(Z,!1))(U.doTupleArray(function(M){return la(M)(ua)}))));var A=function(M){if(M instanceof q.Nil||M instanceof q.Cons&&M.value1 instanceof q.Nil)return b.pure(y.applicativeEffect)(D.unit);if(M instanceof q.Cons&&M.value1 instanceof q.Cons){var da=u(M.value1.value0.value0),O=u(M.value0.value0);return function(){b.when(y.applicativeEffect)(M.value0.value1)(n.drawLane({x:r+
fa.x|0,y:da,width:z.customize.widthStandardFret-2|0,height:O-da|0})(J))();return A(M.value1)()}}throw Error("Draw.Drums (276:5-276:43): "+[M.constructor.name]);};return A(B)})();n.drawImage(g.image_highway_target_red)(d.toNumber((r+(0*z.customize.widthStandardFret|0)|0)+1|0))(Q-5)(J)();n.drawImage(g.image_highway_target_yellow)(d.toNumber((r+(1*z.customize.widthStandardFret|0)|0)+1|0))(Q-5)(J)();n.drawImage(g.image_highway_target_blue)(d.toNumber((r+(2*z.customize.widthStandardFret|0)|0)+1|0))(Q-
5)(J)();F.mode instanceof H.Drums5?(n.drawImage(g.image_highway_target_orange)(d.toNumber((r+(3*z.customize.widthStandardFret|0)|0)+1|0))(Q-5)(J)(),n.drawImage(g.image_highway_target_green)(d.toNumber((r+(4*z.customize.widthStandardFret|0)|0)+1|0))(Q-5)(J)()):n.drawImage(g.image_highway_target_green)(d.toNumber((r+(3*z.customize.widthStandardFret|0)|0)+1|0))(Q-5)(J)();var ma=F.mode instanceof H.Drums5?g.image_gem_open_energy:g.image_gem_kick_energy;var va=F.mode instanceof H.Drums5?g.image_gem_open:
g.image_gem_kick;R(y.monadEffect)(F.notes)(function(fa){return function(ua){var B=n.secToNum(t.append(v.semigroupSeconds)(fa)(v.negateDuration(v.durationSeconds)(J.time)));if(J.app.settings.autoplay&&0>=B){if(-.1<B){var A=(B+.1)/.05,M=function(){F.mode instanceof H.Drums5?n.setFillStyle(z.customize.sustainPurple.hit(A))(J)():n.setFillStyle(z.customize.sustainOrange.hit(A))(J)();n.fillRect({x:d.toNumber((r+(0*z.customize.widthStandardFret|0)|0)+2|0),y:Q-5|0,width:d.toNumber((w*z.customize.widthStandardFret|
0)-1|0),height:1})(J)();return n.fillRect({x:d.toNumber((r+(0*z.customize.widthStandardFret|0)|0)+2|0),y:Q+4|0,width:d.toNumber((w*z.customize.widthStandardFret|0)-1|0),height:1})(J)()};return h.for_(y.applicativeEffect)(h.foldableArray)(ua)(function(Y){return Y instanceof H.Kick?M:b.pure(y.applicativeEffect)(D.unit)})}return b.pure(y.applicativeEffect)(D.unit)}var da=u(fa),O=function(){var Y=p.lookupLE(v.ordSeconds)(fa)(F.energy);if(Y instanceof C.Just)return Y.value0.value;if(Y instanceof C.Nothing)return!1;
throw Error("Draw.Drums (327:24-329:42): "+[Y.constructor.name]);}();return h.for_(y.applicativeEffect)(h.foldableArray)(ua)(function(Y){return Y instanceof H.Kick?n.drawImage(O?ma:va)(d.toNumber((r+(0*z.customize.widthStandardFret|0)|0)+1|0))(da-3|0)(J):b.pure(y.applicativeEffect)(D.unit)})}})();R(y.monadEffect)(F.notes)(function(fa){return function(ua){var B=n.secToNum(t.append(v.semigroupSeconds)(fa)(v.negateDuration(v.durationSeconds)(J.time)));if(J.app.settings.autoplay&&0>=B){if(-.1<B){var A=
(B+.1)/.05;B=function(){n.setFillStyle(z.customize.sustainOrange.hit(A))(J)();return n.fillRect({x:d.toNumber((r+(3*z.customize.widthStandardFret|0)|0)+2|0),y:Q-4|0,width:z.customize.widthStandardFret-1|0,height:8})(J)()};var M=function(){n.setFillStyle(z.customize.sustainRed.hit(A))(J)();return n.fillRect({x:d.toNumber((r+(0*z.customize.widthStandardFret|0)|0)+2|0),y:Q-4|0,width:z.customize.widthStandardFret-1|0,height:8})(J)()},da=function(){n.setFillStyle(z.customize.sustainYellow.hit(A))(J)();
return n.fillRect({x:d.toNumber((r+(1*z.customize.widthStandardFret|0)|0)+2|0),y:Q-4|0,width:z.customize.widthStandardFret-1|0,height:8})(J)()};var O=J.app.settings.leftyFlip?da:B;var Y=function(){n.setFillStyle(z.customize.sustainGreen.hit(A))(J)();return n.fillRect({x:d.toNumber((r+((w-1|0)*z.customize.widthStandardFret|0)|0)+2|0),y:Q-4|0,width:z.customize.widthStandardFret-1|0,height:8})(J)()};var P=J.app.settings.leftyFlip?M:Y;var ca=J.app.settings.leftyFlip?Y:M;M=function(){n.setFillStyle(z.customize.sustainBlue.hit(A))(J)();
return n.fillRect({x:d.toNumber((r+(2*z.customize.widthStandardFret|0)|0)+2|0),y:Q-4|0,width:z.customize.widthStandardFret-1|0,height:8})(J)()};var V=J.app.settings.leftyFlip?F.mode instanceof H.Drums5?M:da:M,S=J.app.settings.leftyFlip?F.mode instanceof H.Drums5?B:M:da;return h.for_(y.applicativeEffect)(h.foldableArray)(ua)(function(l){if(l instanceof H.Kick)return b.pure(y.applicativeEffect)(D.unit);if(l instanceof H.Red||l instanceof H.Rimshot)return ca;if(l instanceof H.HHOpen||l instanceof H.HHSizzle||
l instanceof H.HHPedal||l instanceof H.YCym||l instanceof H.YTom)return S;if(l instanceof H.BCym||l instanceof H.BTom)return V;if(l instanceof H.OCym)return O;if(l instanceof H.GCym||l instanceof H.GTom)return P;throw Error("Draw.Drums (373:29-386:33): "+[l.constructor.name]);})}return b.pure(y.applicativeEffect)(D.unit)}var ha=u(fa),x=function(){var l=p.lookupLE(v.ordSeconds)(fa)(F.energy);if(l instanceof C.Just)return l.value0.value;if(l instanceof C.Nothing)return!1;throw Error("Draw.Drums (391:24-393:42): "+
[l.constructor.name]);}();return h.for_(y.applicativeEffect)(h.foldableArray)(ua)(function(l){if(l instanceof H.Kick)return b.pure(y.applicativeEffect)(D.unit);if(l instanceof H.Red)return n.drawImage(x?g.image_gem_energy:J.app.settings.leftyFlip?g.image_gem_green:g.image_gem_red)(d.toNumber((r+(aa(0)*z.customize.widthStandardFret|0)|0)+1|0))(ha-5|0)(J);if(l instanceof H.Rimshot)return n.drawImage(x?g.image_gem_energy_rimshot:J.app.settings.leftyFlip?g.image_gem_green_rimshot:g.image_gem_red_rimshot)(d.toNumber((r+
(aa(0)*z.customize.widthStandardFret|0)|0)+1|0))(ha-5|0)(J);if(l instanceof H.YTom)return n.drawImage(x?g.image_gem_energy:J.app.settings.leftyFlip?F.mode instanceof H.Drums5?g.image_gem_orange:g.image_gem_blue:g.image_gem_yellow)(d.toNumber((r+(aa(1)*z.customize.widthStandardFret|0)|0)+1|0))(ha-5|0)(J);if(l instanceof H.YCym)return n.drawImage(x?g.image_gem_energy_cymbal:J.app.settings.leftyFlip?F.mode instanceof H.Drums5?g.image_gem_orange_cymbal:g.image_gem_blue_cymbal:g.image_gem_yellow_cymbal)(d.toNumber((r+
(aa(1)*z.customize.widthStandardFret|0)|0)+1|0))(ha-8|0)(J);if(l instanceof H.HHOpen)return n.drawImage(x?g.image_gem_energy_hhopen:J.app.settings.leftyFlip?g.image_gem_blue_hhopen:g.image_gem_yellow_hhopen)(d.toNumber((r+(aa(1)*z.customize.widthStandardFret|0)|0)+1|0))(ha-8|0)(J);if(l instanceof H.HHSizzle)return n.drawImage(x?g.image_gem_energy_hhclosed:J.app.settings.leftyFlip?g.image_gem_blue_hhclosed:g.image_gem_yellow_hhclosed)(d.toNumber((r+(aa(1)*z.customize.widthStandardFret|0)|0)+1|0))(ha-
8|0)(J);if(l instanceof H.HHPedal)return n.drawImage(x?g.image_gem_energy_hhpedal:J.app.settings.leftyFlip?g.image_gem_blue_hhpedal:g.image_gem_yellow_hhpedal)(d.toNumber((r+(aa(1)*z.customize.widthStandardFret|0)|0)+1|0))(ha-8|0)(J);if(l instanceof H.BTom)return n.drawImage(x?g.image_gem_energy:J.app.settings.leftyFlip?F.mode instanceof H.Drums5?g.image_gem_blue:g.image_gem_yellow:g.image_gem_blue)(d.toNumber((r+(aa(2)*z.customize.widthStandardFret|0)|0)+1|0))(ha-5|0)(J);if(l instanceof H.BCym)return n.drawImage(x?
g.image_gem_energy_cymbal:J.app.settings.leftyFlip?F.mode instanceof H.Drums5?g.image_gem_blue_cymbal:g.image_gem_yellow_cymbal:g.image_gem_blue_cymbal)(d.toNumber((r+(aa(2)*z.customize.widthStandardFret|0)|0)+1|0))(ha-8|0)(J);if(l instanceof H.OCym)return n.drawImage(x?g.image_gem_energy_cymbal:J.app.settings.leftyFlip?g.image_gem_yellow_cymbal:g.image_gem_orange_cymbal)(d.toNumber((r+(aa(3)*z.customize.widthStandardFret|0)|0)+1|0))(ha-8|0)(J);if(l instanceof H.GTom)return n.drawImage(x?g.image_gem_energy:
J.app.settings.leftyFlip?g.image_gem_red:g.image_gem_green)(d.toNumber((r+(aa(w-1|0)*z.customize.widthStandardFret|0)|0)+1|0))(ha-5|0)(J);if(l instanceof H.GCym)return n.drawImage(x?g.image_gem_energy_cymbal:J.app.settings.leftyFlip?g.image_gem_red_cymbal:g.image_gem_green_cymbal)(d.toNumber((r+(aa(w-1|0)*z.customize.widthStandardFret|0)|0)+1|0))(ha-8|0)(J);throw Error("Draw.Drums (394:25-465:37): "+[l.constructor.name]);})}})();n.drawBadgeVertical(N)(r)(L)(J)();return(r+L|0)+z.customize.marginWidth|
0}}}}}})(PS);
(function(a){a["Draw.Five"]=a["Draw.Five"]||{};var b=a["Control.Applicative"],c=a["Data.Array"],h=a["Data.Foldable"],e=a["Data.Functor"],k=a["Data.Int"],d=a["Data.List"],m=a["Data.List.Types"],q=a["Data.Map.Internal"],p=a["Data.Maybe"],C=a["Data.Newtype"],t=a["Data.Ord"],v=a["Data.Semigroup"],G=a["Data.Time.Duration"],D=a["Data.Tuple"],n=a["Data.Unit"],y=a["Draw.Common"],K=a.Effect,g=a["Graphics.Canvas"],U=a.Images,H=a.OnyxMap,z=a.Song,F=a.Style;a["Draw.Five"].drawFiveFast=function(N){return function(r){return function(J){return function(ba){return function(){var u=e.map(K.functorEffect)(k.round)(g.getCanvasHeight(ba.canvas))(),
Q=(5*F.customize.widthStandardFret|0)+2|0,R=function(I){return u-ba.secsToPxVert(v.append(G.semigroupSeconds)(I)(G.negateDuration(G.durationSeconds)(ba.time)))|0},w=R(ba.time),L=function(I){return v.append(G.semigroupSeconds)(ba.pxToSecsVert(u-I|0))(ba.time)},T=L(ba.maxY+50|0),Z=L(ba.minY-50|0);L=function(I){return ba.app.settings.leftyFlip?4-I|0:I};var la=ba.maxY-ba.minY|0,aa=function(I){if(I instanceof m.Cons&&I.value1 instanceof m.Nil)return m.Cons.create(I.value0)(new m.Cons(new D.Tuple(Z,z.extendFive(function(ma){return ma.future})(I.value0.value1)),
m.Nil.value));if(I instanceof m.Cons)return m.Cons.create(I.value0)(aa(I.value1));if(I instanceof m.Nil)return I=function(){var ma=q.lookupGE(G.ordSeconds)(Z)(N);if(ma instanceof p.Nothing)return z.emptyFiveState;if(ma instanceof p.Just)return z.extendFive(function(va){return va.past})(ma.value0.value);throw Error("Draw.Five (44:13-46:46): "+[ma.constructor.name]);}(),new m.Cons(new D.Tuple(Z,I),m.Nil.value);throw Error("Draw.Five (41:7-41:110): "+[I.constructor.name]);},X=aa(function(I){if(I instanceof
m.Nil)return I=function(){var ma=q.lookupLE(G.ordSeconds)(T)(N);if(ma instanceof p.Nothing)return z.emptyFiveState;if(ma instanceof p.Just)return z.extendFive(function(va){return va.future})(ma.value0.value);throw Error("Draw.Five (35:13-37:48): "+[ma.constructor.name]);}(),new m.Cons(new D.Tuple(T,I),m.Nil.value);if(I instanceof m.Cons)return new m.Cons(new D.Tuple(T,z.extendFive(function(ma){return ma.past})(I.value0.value1)),I);throw Error("Draw.Five (34:7-38:42): "+[I.constructor.name]);}(d.fromFoldable(h.foldableArray)(H.doTupleArray(function(I){return H.zoomAscDo(G.ordSeconds)(I)(T)(Z)(N)})))),
pa=d.reverse(X);y.setFillStyle(F.customize.highway)(ba)();y.fillRect({x:J,y:ba.minY,width:k.toNumber((5*F.customize.widthStandardFret|0)+2|0),height:la})(ba)();y.setFillStyle(F.customize.highwaySolo)(ba)();var ea=function(I){return I instanceof m.Cons&&I.value1 instanceof m.Cons?function(){b.when(K.applicativeEffect)(I.value0.value1.solo.future)(function(){var ma=R(I.value1.value0.value0),va=R(I.value0.value0);return h.for_(K.applicativeEffect)(h.foldableArray)(e.map(e.functorArray)(function(fa){return(fa*
F.customize.widthStandardFret|0)+2|0})(c.range(0)(4)))(function(fa){return y.fillRect({x:J+fa|0,y:ma,width:F.customize.widthStandardFret-2|0,height:va-ma|0})(ba)})}())();return ea(I.value1)()}:b.pure(K.applicativeEffect)(n.unit)};ea(X)();h.for_(K.applicativeEffect)(m.foldableList)(X)(function(I){return b.when(K.applicativeEffect)(I.value1.solo.now)(function(){var ma=R(I.value0);return function(){y.setFillStyle(F.customize.highwaySoloEdge)(ba)();return y.fillRect({x:J,y:ma,width:Q,height:1})(ba)()}}())})();
y.drawBeats(R)({x:J,width:Q,minSecs:T,maxSecs:Z})(ba)();y.setFillStyle(F.customize.highwayRailing)(ba)();h.for_(K.applicativeEffect)(h.foldableArray)(e.map(e.functorArray)(function(I){return I*F.customize.widthStandardFret|0})(c.range(0)(5)))(function(I){return y.fillRect({x:J+I|0,y:ba.minY,width:1,height:la})(ba)})();y.setFillStyle(F.customize.highwayDivider)(ba)();h.for_(K.applicativeEffect)(h.foldableArray)(e.map(e.functorArray)(function(I){return(I*F.customize.widthStandardFret|0)+1|0})(c.range(0)(5)))(function(I){return y.fillRect({x:J+
I|0,y:ba.minY,width:1,height:la})(ba)})();L=[{c:function(I){return I.open},lane:function(I){return I.open},x:(0*F.customize.widthStandardFret|0)+1|0,strum:U.image_gem_open,hopo:U.image_gem_open_hopo,tap:U.image_gem_open_tap,shades:F.customize.sustainPurple,open:!0,target:p.Nothing.value},{c:function(I){return I.green},lane:function(I){return I.green},x:(L(0)*F.customize.widthStandardFret|0)+1|0,strum:U.image_gem_green,hopo:U.image_gem_green_hopo,tap:U.image_gem_green_tap,shades:F.customize.sustainGreen,
open:!1,target:new p.Just(U.image_highway_target_green)},{c:function(I){return I.red},lane:function(I){return I.red},x:(L(1)*F.customize.widthStandardFret|0)+1|0,strum:U.image_gem_red,hopo:U.image_gem_red_hopo,tap:U.image_gem_red_tap,shades:F.customize.sustainRed,open:!1,target:new p.Just(U.image_highway_target_red)},{c:function(I){return I.yellow},lane:function(I){return I.yellow},x:(L(2)*F.customize.widthStandardFret|0)+1|0,strum:U.image_gem_yellow,hopo:U.image_gem_yellow_hopo,tap:U.image_gem_yellow_tap,
shades:F.customize.sustainYellow,open:!1,target:new p.Just(U.image_highway_target_yellow)},{c:function(I){return I.blue},lane:function(I){return I.blue},x:(L(3)*F.customize.widthStandardFret|0)+1|0,strum:U.image_gem_blue,hopo:U.image_gem_blue_hopo,tap:U.image_gem_blue_tap,shades:F.customize.sustainBlue,open:!1,target:new p.Just(U.image_highway_target_blue)},{c:function(I){return I.orange},lane:function(I){return I.orange},x:(L(4)*F.customize.widthStandardFret|0)+1|0,strum:U.image_gem_orange,hopo:U.image_gem_orange_hopo,
tap:U.image_gem_orange_tap,shades:F.customize.sustainOrange,open:!1,target:new p.Just(U.image_highway_target_orange)}];h.for_(K.applicativeEffect)(h.foldableArray)(L)(function(I){var ma=function(fa){if(fa instanceof m.Cons){var ua=I.lane(C.unwrap(z.newtypeFiveEach)(fa.value0.value1.lanes)),B=ua.past||!I.open&&fa.value0.value1.bre.past,A=ua.future||!I.open&&fa.value0.value1.bre.future;return function(){b.when(K.applicativeEffect)(B!==A)(y.drawLaneCap({x:((J+I.x|0)+1|0)+(I.open?1*F.customize.widthStandardFret|
0:0)|0,y:R(fa.value0.value0),width:(F.customize.widthStandardFret-2|0)+(I.open?2*F.customize.widthStandardFret|0:0)|0})(ba))();return va(fa)()}}if(fa instanceof m.Nil)return b.pure(K.applicativeEffect)(n.unit);throw Error("Draw.Five (110:5-119:16): "+[fa.constructor.name]);},va=function(fa){return fa instanceof m.Cons&&fa.value1 instanceof m.Cons?function(){var ua=b.when(K.applicativeEffect)(I.lane(C.unwrap(z.newtypeFiveEach)(fa.value0.value1.lanes)).future||fa.value0.value1.bre.future&&!I.open);
var B=R(fa.value1.value0.value0);var A=R(fa.value0.value0);B=y.drawLaneBody({x:((J+I.x|0)+1|0)+(I.open?1*F.customize.widthStandardFret|0:0)|0,y:B,width:(F.customize.widthStandardFret-2|0)+(I.open?2*F.customize.widthStandardFret|0:0)|0,height:A-B|0})(ba);ua(B)();return ma(fa.value1)()}:ma(d.drop(1)(fa))};return ma(X)})();h.for_(K.applicativeEffect)(h.foldableArray)(L)(function(I){if(I.target instanceof p.Just)return y.drawImage(I.target.value0)(J+I.x|0)(w-5)(ba);if(I.target instanceof p.Nothing)return b.pure(K.applicativeEffect)(n.unit);
throw Error("Draw.Five (135:53-137:26): "+[I.target.constructor.name]);})();h.for_(K.applicativeEffect)(h.foldableArray)(L)(function(I){var ma=I.open?(1*F.customize.widthStandardFret|0)+1|0:I.x;var va=ba.app.settings.autoplay?w:ba.maxY+50|0;var fa=function(B){return function(A){return function(M){return b.when(K.applicativeEffect)(B<va||A<va)(function(){var da=t.min(t.ordInt)(B)(va),O=t.min(t.ordInt)(A)(va),Y=ba.app.settings.autoplay&&(w<B||w<A);var P=M?F.customize.sustainEnergy:I.shades;var ca=(O-
da|0)+1|0;var V=I.open?2*F.customize.widthStandardFret|0:0;return function(){y.setFillStyle(F.customize.sustainBorder)(ba)();y.fillRect({x:k.toNumber((J+ma|0)+14|0),y:da,width:1,height:ca})(ba)();y.fillRect({x:k.toNumber(((J+ma|0)+22|0)+V|0),y:da,width:1,height:ca})(ba)();y.setFillStyle(P.light)(ba)();y.fillRect({x:k.toNumber((J+ma|0)+15|0),y:da,width:1,height:ca})(ba)();y.setFillStyle(P.normal)(ba)();y.fillRect({x:k.toNumber((J+ma|0)+16|0),y:da,width:5+V,height:ca})(ba)();y.setFillStyle(P.dark)(ba)();
y.fillRect({x:k.toNumber(((J+ma|0)+21|0)+V|0),y:da,width:1,height:ca})(ba)();return b.when(K.applicativeEffect)(Y)(function(){y.setFillStyle(P.light)(ba)();return y.fillRect({x:k.toNumber((J+ma|0)+1|0),y:w-4|0,width:k.toNumber((F.customize.widthStandardFret-1|0)+V|0),height:8})(ba)()})()}}())}}},ua=function(B){return B instanceof m.Cons&&B.value1 instanceof m.Cons?function(){var A=I.c(C.unwrap(z.newtypeFiveEach)(B.value0.value1.notes)).future;if(!(A instanceof p.Nothing))if(A instanceof p.Just)fa(R(B.value1.value0.value0))(R(B.value0.value0))(A.value0)();
else throw Error("Draw.Five (164:11-166:87): "+[A.constructor.name]);return ua(B.value1)()}:b.pure(K.applicativeEffect)(n.unit)};return ua(X)})();h.for_(K.applicativeEffect)(h.foldableArray)(L)(function(I){return function(){y.setFillStyle(F.customize.sustainBorder)(ba)();return h.for_(K.applicativeEffect)(m.foldableList)(pa)(function(ma){var va=I.c(C.unwrap(z.newtypeFiveEach)(ma.value1.notes));va=b.when(K.applicativeEffect)(p.isJust(va.past)&&p.isNothing(va.future));var fa=I.open?(1*F.customize.widthStandardFret|
0)+1|0:I.x;var ua=y.secToNum(v.append(G.semigroupSeconds)(ma.value0)(G.negateDuration(G.durationSeconds)(ba.time)));ma=ba.app.settings.autoplay&&0>=ua?b.pure(K.applicativeEffect)(n.unit):y.fillRect({x:k.toNumber((J+fa|0)+14|0),y:k.toNumber(R(ma.value0)),width:k.toNumber(I.open?9+(2*F.customize.widthStandardFret|0)|0:9),height:1})(ba);return va(ma)})()}})();h.for_(K.applicativeEffect)(h.foldableArray)(L)(function(I){return h.for_(K.applicativeEffect)(m.foldableList)(pa)(function(ma){var va=I.c(C.unwrap(z.newtypeFiveEach)(ma.value1.notes)).now;
if(va instanceof p.Nothing)return b.pure(K.applicativeEffect)(n.unit);if(va instanceof p.Just){var fa=I.open?(1*F.customize.widthStandardFret|0)+1|0:I.x;var ua=y.secToNum(v.append(G.semigroupSeconds)(ma.value0)(G.negateDuration(G.durationSeconds)(ba.time)));var B=I.open?2*F.customize.widthStandardFret|0:0;if(ba.app.settings.autoplay&&0>=ua)return-.1<ua?function(){y.setFillStyle(I.shades.hit((ua+.1)/.05))(ba)();return y.fillRect({x:k.toNumber((J+fa|0)+1|0),y:w-4|0,width:k.toNumber((F.customize.widthStandardFret-
1|0)+B|0),height:8})(ba)()}:b.pure(K.applicativeEffect)(n.unit);var A=R(ma.value0);A=I.open?A-3|0:A-5|0;var M=J+I.x|0,da=function(){if(va.value0 instanceof z.Strum)return ma.value1.energy.future?I.open?U.image_gem_open_energy:U.image_gem_energy:I.strum;if(va.value0 instanceof z.HOPO)return ma.value1.energy.future?I.open?U.image_gem_open_energy_hopo:U.image_gem_energy_hopo:I.hopo;if(va.value0 instanceof z.Tap)return ma.value1.energy.future?I.open?U.image_gem_open_energy_tap:U.image_gem_energy_tap:
I.tap;throw Error("Draw.Five (205:23-208:129): "+[va.value0.constructor.name]);}();return y.drawImage(da)(M)(A)(ba)}throw Error("Draw.Five (188:51-211:60): "+[va.constructor.name]);})})();y.drawBadgeVertical(r)(J)(Q)(ba)();return(J+Q|0)+F.customize.marginWidth|0}}}}}})(PS);
(function(a){a["Draw.ProKeys"]=a["Draw.ProKeys"]||{};var b=a["Draw.ProKeys"],c=a["Control.Applicative"],h=a["Control.Bind"],e=a["Data.Array"],k=a["Data.Foldable"],d=a["Data.Functor"],m=a["Data.Int"],q=a["Data.List"],p=a["Data.List.Types"],C=a["Data.Map.Internal"],t=a["Data.Maybe"],v=a["Data.Ord"],G=a["Data.Semigroup"],D=a["Data.Semiring"],n=a["Data.Time.Duration"],y=a["Data.Tuple"],K=a["Data.Unit"],g=a["Draw.Common"],U=a.Effect,H=a["Graphics.Canvas"],z=a.Images,F=a.OnyxMap,N=a.Song,r=a.Style,J=function(){function Z(){}
Z.value=new Z;return Z}(),ba=function(){function Z(){}Z.value=new Z;return Z}(),u=function(){function Z(){}Z.value=new Z;return Z}(),Q=function(){function Z(){}Z.value=new Z;return Z}(),R=function(){function Z(){}Z.value=new Z;return Z}(),w=q.fromFoldable(k.foldableArray)([J.value,ba.value,u.value,R.value,u.value,R.value,Q.value,J.value,ba.value,u.value,R.value,u.value,R.value,u.value,R.value,Q.value,J.value,ba.value,u.value,R.value,u.value,R.value,Q.value,J.value,ba.value,u.value,R.value,u.value,
R.value,u.value,R.value,Q.value,J.value,ba.value,Q.value,J.value,ba.value]),L=function(Z){return d.map(d.functorArray)(function(la){return e.take(la)(Z)})(e.range(0)(e.length(Z)))},T=function(){var Z=function(aa){return k.elem(k.foldableArray)(N.eqPitch)(aa)([N.RedCs.value,N.RedDs.value,N.YellowFs.value,N.YellowGs.value,N.YellowAs.value,N.BlueCs.value,N.BlueDs.value,N.GreenFs.value,N.GreenGs.value,N.GreenAs.value])},la=[N.RedC.value,N.RedCs.value,N.RedD.value,N.RedDs.value,N.RedE.value,N.YellowF.value,
N.YellowFs.value,N.YellowG.value,N.YellowGs.value,N.YellowA.value,N.YellowAs.value,N.YellowB.value,N.BlueC.value,N.BlueCs.value,N.BlueD.value,N.BlueDs.value,N.BlueE.value,N.GreenF.value,N.GreenFs.value,N.GreenG.value,N.GreenGs.value,N.GreenA.value,N.GreenAs.value,N.GreenB.value,N.OrangeC.value];return h.bind(h.bindArray)(e.zip(la)(L(la)))(function(aa){return c.pure(c.applicativeArray)({pitch:aa.value0,offsetX:1+k.sum(k.foldableArray)(D.semiringInt)(d.map(d.functorArray)(function(X){return Z(X)?10:
12})(aa.value1))|0,isBlack:Z(aa.value0)})})}();b.drawProKeysFast=function(Z){return function(la){return function(aa){return function(X){return function(){var pa=d.map(U.functorEffect)(m.round)(H.getCanvasHeight(X.canvas))(),ea=function(V){return pa-X.secsToPxVert(G.append(n.semigroupSeconds)(V)(n.negateDuration(n.durationSeconds)(X.time)))|0},I=ea(X.time),ma=function(V){return G.append(n.semigroupSeconds)(X.pxToSecsVert(pa-V|0))(X.time)},va=ma(X.maxY+50|0),fa=ma(X.minY-50|0),ua=X.maxY-X.minY|0,B=
function(V){if(V instanceof p.Cons&&V.value1 instanceof p.Nil)return p.Cons.create(V.value0)(new p.Cons(new y.Tuple(fa,N.extendPK(function(S){return S.future})(V.value0.value1)),p.Nil.value));if(V instanceof p.Cons)return p.Cons.create(V.value0)(B(V.value1));if(V instanceof p.Nil)return V=function(){var S=C.lookupGE(n.ordSeconds)(fa)(Z);if(S instanceof t.Nothing)return N.emptyProKeysState;if(S instanceof t.Just)return N.extendPK(function(ha){return ha.past})(S.value0.value);throw Error("Draw.ProKeys (74:13-76:44): "+
[S.constructor.name]);}(),new p.Cons(new y.Tuple(fa,V),p.Nil.value);throw Error("Draw.ProKeys (71:7-71:110): "+[V.constructor.name]);},A=B(function(V){if(V instanceof p.Nil)return V=function(){var S=C.lookupLE(n.ordSeconds)(va)(Z);if(S instanceof t.Nothing)return N.emptyProKeysState;if(S instanceof t.Just)return N.extendPK(function(ha){return ha.future})(S.value0.value);throw Error("Draw.ProKeys (65:13-67:46): "+[S.constructor.name]);}(),new p.Cons(new y.Tuple(va,V),p.Nil.value);if(V instanceof p.Cons)return new p.Cons(new y.Tuple(va,
N.extendPK(function(S){return S.past})(V.value0.value1)),V);throw Error("Draw.ProKeys (64:7-68:42): "+[V.constructor.name]);}(q.fromFoldable(k.foldableArray)(F.doTupleArray(function(V){return F.zoomAscDo(n.ordSeconds)(V)(va)(fa)(Z)})))),M=q.reverse(A),da=function(V){return function(S){if(S instanceof p.Nil)return c.pure(U.applicativeEffect)(K.unit);if(S instanceof p.Cons){var ha=function(){if(S.value0 instanceof J)return{color:r.customize.highwayRailing,width:1};if(S.value0 instanceof ba)return{color:r.customize.highwayDivider,
width:1};if(S.value0 instanceof u)return{color:r.customize.highway,width:11};if(S.value0 instanceof Q)return{color:r.customize.highway,width:10};if(S.value0 instanceof R)return{color:r.customize.highwayBlackKey,width:11};throw Error("Draw.ProKeys (85:22-90:79): "+[S.value0.constructor.name]);}();return function(){g.setFillStyle(ha.color)(X)();g.fillRect({x:V,y:X.minY,width:ha.width,height:ua})(X)();return da(V+ha.width|0)(S.value1)()}}throw Error("Draw.ProKeys (83:7-83:57): "+[V.constructor.name,
S.constructor.name]);}};da(aa)(w)();var O=function(V){return function(S){return function(ha){return function(x){if(x instanceof p.Nil)return c.pure(U.applicativeEffect)(K.unit);if(x instanceof p.Cons){var l=function(){if(x.value0 instanceof J||x.value0 instanceof ba)return{color:t.Nothing.value,width:1};if(x.value0 instanceof u)return{color:new t.Just(r.customize.highwaySolo),width:11};if(x.value0 instanceof Q)return{color:new t.Just(r.customize.highwaySolo),width:10};if(x.value0 instanceof R)return{color:new t.Just(r.customize.highwaySoloBlackKey),
width:11};throw Error("Draw.ProKeys (98:22-103:88): "+[x.value0.constructor.name]);}();return function(){if(!(l.color instanceof t.Nothing))if(l.color instanceof t.Just)g.setFillStyle(l.color.value0)(X)(),g.fillRect({x:V,y:S,width:l.width,height:ha-S|0})(X)();else throw Error("Draw.ProKeys (104:9-108:122): "+[l.color.constructor.name]);return O(V+l.width|0)(S)(ha)(x.value1)()}}throw Error("Draw.ProKeys (96:7-96:67): "+[V.constructor.name,S.constructor.name,ha.constructor.name,x.constructor.name]);
}}}},Y=function(V){return V instanceof p.Cons&&V.value1 instanceof p.Cons?function(){c.when(U.applicativeEffect)(V.value0.value1.solo.future)(O(aa)(ea(V.value0.value0))(ea(V.value1.value0.value0))(w))();return Y(V.value1)()}:c.pure(U.applicativeEffect)(K.unit)};Y(A)();k.for_(U.applicativeEffect)(p.foldableList)(A)(function(V){return c.when(U.applicativeEffect)(V.value1.solo.now)(function(){var S=ea(V.value0);return function(){g.setFillStyle(r.customize.highwaySoloEdge)(X)();return g.fillRect({x:aa,
y:S,width:282,height:1})(X)()}}())})();F.zoomDescDo(n.ordSeconds)(U.monadEffect)(va)(fa)(X.song.beats.lines)(function(V){return function(S){var ha=ea(V),x=function(){if(S instanceof N.Bar)return r.customize.highwayBarHeight;if(S instanceof N.Beat)return r.customize.highwayBeatHeight;if(S instanceof N.HalfBeat)return r.customize.highwayHalfBeatHeight;throw Error("Draw.ProKeys (124:13-127:54): "+[S.constructor.name]);}();return function(){g.setFillStyle(r.customize.highwayLine)(X)();return g.fillRect({x:aa+
1,y:m.toNumber(ha-(x>>1)|0),width:281,height:x})(X)()}}})();k.for_(U.applicativeEffect)(k.foldableArray)(T)(function(V){var S=function(x){if(x instanceof p.Cons){var l=function(oa){return t.maybe(!1)(oa)(C.lookup(N.ordPitch)(V.pitch)(x.value0.value1.lanes))},W=l(function(oa){return oa.past})||x.value0.value1.bre.past,ja=l(function(oa){return oa.future})||x.value0.value1.bre.future;return function(){c.when(U.applicativeEffect)(W!==ja)(g.drawLaneCap({x:(aa+V.offsetX|0)+(V.isBlack?0:1)|0,y:ea(x.value0.value0),
width:11})(X))();return ha(x)()}}if(x instanceof p.Nil)return c.pure(U.applicativeEffect)(K.unit);throw Error("Draw.ProKeys (132:5-141:16): "+[x.constructor.name]);},ha=function(x){return x instanceof p.Cons&&x.value1 instanceof p.Cons?function(){c.when(U.applicativeEffect)(t.maybe(!1)(function(l){return l.future})(C.lookup(N.ordPitch)(V.pitch)(x.value0.value1.lanes))||x.value0.value1.bre.future)(function(){var l=ea(x.value1.value0.value0),W=ea(x.value0.value0);return g.drawLaneBody({x:(aa+V.offsetX|
0)+(V.isBlack?0:1)|0,y:l,width:11,height:W-l|0})(X)}())();return S(x.value1)()}:S(q.drop(1)(x))};return S(A)})();g.drawImage(z.image_highway_prokeys_target)(aa)(I-5)(X)();g.setFillStyle(r.customize.proKeysRangeOverlay)(X)();var P=function(V){return function(S){return function(ha){var x=m.toNumber(ea(V)),l=m.toNumber(ea(S))-x,W=function(){if(ha instanceof N.RangeC)return[{x:aa+192|0,y:x,width:90,height:l}];if(ha instanceof N.RangeD)return[{x:aa+2|0,y:x,width:22,height:l},{x:aa+203|0,y:x,width:79,height:l}];
if(ha instanceof N.RangeE)return[{x:aa+2|0,y:x,width:44,height:l},{x:aa+225|0,y:x,width:57,height:l}];if(ha instanceof N.RangeF)return[{x:aa+2|0,y:x,width:56,height:l},{x:aa+247|0,y:x,width:35,height:l}];if(ha instanceof N.RangeG)return[{x:aa+2|0,y:x,width:78,height:l},{x:aa+270|0,y:x,width:12,height:l}];if(ha instanceof N.RangeA)return[{x:aa+2|0,y:x,width:100,height:l}];throw Error("Draw.ProKeys (163:17-169:81): "+[ha.constructor.name]);}();return k.for_(U.applicativeEffect)(k.foldableArray)(W)(function(ja){return g.fillRect(ja)(X)})}}},
ca=function(V){return V instanceof p.Cons&&V.value1 instanceof p.Cons?function(){if(!(V.value0.value1.ranges.future instanceof t.Nothing))if(V.value0.value1.ranges.future instanceof t.Just)P(V.value0.value0)(V.value1.value0.value0)(V.value0.value1.ranges.future.value0)();else throw Error("Draw.ProKeys (172:9-174:42): "+[V.value0.value1.ranges.future.constructor.name]);return ca(V.value1)()}:c.pure(U.applicativeEffect)(K.unit)};ca(A)();k.for_(U.applicativeEffect)(k.foldableArray)(T)(function(V){var S=
X.app.settings.autoplay?I:X.maxY+50|0;var ha=function(l){return function(W){return function(ja){return c.when(U.applicativeEffect)(l<S||W<S)(function(){var oa=v.min(v.ordInt)(l)(S),xa=v.min(v.ordInt)(W)(S),Aa=X.app.settings.autoplay&&(I<l||I<W),sa=ja?V.isBlack?r.customize.sustainBlackKeyEnergy:r.customize.sustainEnergy:V.isBlack?r.customize.sustainBlackKey:r.customize.sustainWhiteKey,wa=V.offsetX;var Fa=V.isBlack?0:1;var Ca=wa+Fa|0,Ea=(xa-oa|0)+1|0;return function(){g.setFillStyle(r.customize.sustainBorder)(X)();
g.fillRect({x:m.toNumber((aa+Ca|0)+2|0),y:oa,width:1,height:Ea})(X)();g.fillRect({x:m.toNumber((aa+Ca|0)+8|0),y:oa,width:1,height:Ea})(X)();g.setFillStyle(sa.light)(X)();g.fillRect({x:m.toNumber((aa+Ca|0)+3|0),y:oa,width:1,height:Ea})(X)();g.setFillStyle(sa.normal)(X)();g.fillRect({x:m.toNumber((aa+Ca|0)+4|0),y:oa,width:3,height:Ea})(X)();g.setFillStyle(sa.dark)(X)();g.fillRect({x:m.toNumber((aa+Ca|0)+7|0),y:oa,width:1,height:Ea})(X)();return c.when(U.applicativeEffect)(Aa)(function(){g.setFillStyle(sa.light)(X)();
return g.fillRect({x:m.toNumber((aa+V.offsetX|0)+1|0),y:I-4|0,width:V.isBlack?9:11,height:8})(X)()})()}}())}}},x=function(l){return l instanceof p.Cons&&l.value1 instanceof p.Cons?function(){(function(){var W=h.bind(t.bindMaybe)(C.lookup(N.ordPitch)(V.pitch)(l.value0.value1.notes))(function(ja){return ja.future});if(W instanceof t.Nothing)return K.unit;if(W instanceof t.Just)return ha(ea(l.value1.value0.value0))(ea(l.value0.value0))(W.value0)();throw Error("Draw.ProKeys (207:11-209:87): "+[W.constructor.name]);
})();return x(l.value1)()}:c.pure(U.applicativeEffect)(K.unit)};return x(A)})();k.for_(U.applicativeEffect)(k.foldableArray)(T)(function(V){return function(){g.setFillStyle(r.customize.sustainBorder)(X)();return k.for_(U.applicativeEffect)(p.foldableList)(M)(function(S){var ha=C.lookup(N.ordPitch)(V.pitch)(S.value1.notes);if(ha instanceof t.Nothing)return c.pure(U.applicativeEffect)(K.unit);if(ha instanceof t.Just){ha=c.when(U.applicativeEffect)(t.isJust(ha.value0.past)&&t.isNothing(ha.value0.future));
var x=g.secToNum(G.append(n.semigroupSeconds)(S.value0)(n.negateDuration(n.durationSeconds)(X.time)));S=X.app.settings.autoplay&&0>=x?c.pure(U.applicativeEffect)(K.unit):g.fillRect({x:m.toNumber((aa+V.offsetX|0)+(V.isBlack?2:3)|0),y:m.toNumber(ea(S.value0)),width:7,height:1})(X);return ha(S)}throw Error("Draw.ProKeys (216:55-227:20): "+[ha.constructor.name]);})()}})();k.for_(U.applicativeEffect)(k.foldableArray)(T)(function(V){return k.for_(U.applicativeEffect)(p.foldableList)(M)(function(S){var ha=
h.bind(t.bindMaybe)(C.lookup(N.ordPitch)(V.pitch)(S.value1.notes))(function(oa){return oa.now});if(ha instanceof t.Nothing)return c.pure(U.applicativeEffect)(K.unit);if(ha instanceof t.Just){var x=g.secToNum(G.append(n.semigroupSeconds)(S.value0)(n.negateDuration(n.durationSeconds)(X.time)));if(X.app.settings.autoplay&&0>=x){if(-.1<x){var l=V.isBlack?r.customize.sustainBlackKey:r.customize.sustainWhiteKey;return function(){g.setFillStyle(l.hit((x+.1)/.05))(X)();return g.fillRect({x:m.toNumber((aa+
V.offsetX|0)+1|0),y:I-4|0,width:V.isBlack?9:11,height:8})(X)()}}return c.pure(U.applicativeEffect)(K.unit)}var W=ea(S.value0),ja=S.value1.energy.future?V.isBlack?z.image_gem_blackkey_energy:z.image_gem_whitekey_energy:V.isBlack?z.image_gem_blackkey:z.image_gem_whitekey;return function(){g.drawImage(ja)(aa+V.offsetX|0)(W-5|0)(X)();return c.when(U.applicativeEffect)(S.value1.gliss.future)(function(){g.onContext(function(oa){return H.setStrokeStyle(oa)(r.customize.glissandoBorder)})(X)();g.onContext(function(oa){return H.setLineWidth(oa)(1)})(X)();
return g.strokeRect({x:(aa+V.offsetX|0)+.5,y:W-4.5,width:12,height:9})(X)()})()}}throw Error("Draw.ProKeys (230:55-254:120): "+[ha.constructor.name]);})})();g.drawBadgeVertical(la)(aa)(282)(X)();return(aa+282|0)+r.customize.marginWidth|0}}}}}})(PS);
(function(a){a["Draw.Protar"]=a["Draw.Protar"]||{};var b=a["Draw.Protar"],c=a["Control.Applicative"],h=a["Data.Array"],e=a["Data.Foldable"],k=a["Data.Function"],d=a["Data.Functor"],m=a["Data.Int"],q=a["Data.List"],p=a["Data.List.Types"],C=a["Data.Map.Internal"],t=a["Data.Maybe"],v=a["Data.Ord"],G=a["Data.Semigroup"],D=a["Data.Semiring"],n=a["Data.Time.Duration"],y=a["Data.Traversable"],K=a["Data.Tuple"],g=a["Data.Unit"],U=a["Draw.Common"],H=a.Effect,z=a["Graphics.Canvas"],F=a.Images,N=a.OnyxMap,r=
a.Song,J=a.Style,ba=function(u){return function(Q){return function(){var R=y["for"](H.applicativeEffect)(p.traversableList)(C.values(Q.chords))(function(w){var L=function(T){return d.map(H.functorEffect)(e.sum(e.foldableArray)(D.semiringNumber))(y["for"](H.applicativeEffect)(y.traversableArray)(T)(function(Z){return function(){if(Z.value0 instanceof r.Baseline)z.setFont(u)(J.customize.proChordNameFont)();else if(Z.value0 instanceof r.Superscript)z.setFont(u)(J.customize.proChordNameFontSuperscript)();
else throw Error("Draw.Protar (31:7-33:75): "+[Z.value0.constructor.name]);return z.measureText(u)(Z.value1)().width}}))};if(w instanceof r.SustainEnd)return c.pure(H.applicativeEffect)(0);if(w instanceof r.Sustain||w instanceof r.Note)return L(w.value0);throw Error("Draw.Protar (36:8-39:25): "+[w.constructor.name]);})();return{notes:Q.notes,lanes:Q.lanes,solo:Q.solo,energy:Q.energy,bre:Q.bre,chords:Q.chords,arpeggio:Q.arpeggio,strings:Q.strings,chordsWidth:m.ceil(t.fromMaybe(0)(e.maximum(v.ordNumber)(p.foldableList)(R)))}}}};
b.drawProtar=function(u){return function(Q){return function(R){return function(w){return function(){var L=d.map(H.functorEffect)(m.round)(z.getCanvasHeight(w.canvas))(),T=(J.customize.widthProtarFret*u.strings|0)+2|0;var Z=w.app.settings.leftyFlip?R:R+u.chordsWidth|0;var la=function(x){return L-w.secsToPxVert(G.append(n.semigroupSeconds)(x)(n.negateDuration(n.durationSeconds)(w.time)))|0},aa=la(w.time),X=function(x){return G.append(n.semigroupSeconds)(w.pxToSecsVert(L-x|0))(w.time)},pa=X(w.maxY+50|
0),ea=X(w.minY-50|0),I=function(x){return N.zoomAscDo(n.ordSeconds)(x)(pa)(ea)},ma=function(x){return N.zoomDescDo(n.ordSeconds)(x)(pa)(ea)},va=6>=u.strings?0:u.strings-6|0,fa=function(x){return w.app.settings.leftyFlip?(u.strings-1|0)-x|0:x},ua=w.maxY-w.minY|0,B=function(x){return w.app.settings.leftyFlip?d.map(t.functorMaybe)(function(l){return{piece:l.head,pieces:l.tail}})(h.uncons(x)):d.map(t.functorMaybe)(function(l){return{piece:l.last,pieces:l.init}})(h.unsnoc(x))},A=function(x){return function(l){return function(W){var ja=
B(W);if(ja instanceof t.Nothing)return c.pure(H.applicativeEffect)(g.unit);if(ja instanceof t.Just)return function(){var oa=K.fst(ja.value0.piece);if(oa instanceof r.Baseline)z.setFont(w.context)(J.customize.proChordNameFont)(),z.setFillStyle(w.context)(J.customize.proChordNameColor)(),oa=m.toNumber(la(l)+5|0);else if(oa instanceof r.Superscript)z.setFont(w.context)(J.customize.proChordNameFontSuperscript)(),z.setFillStyle(w.context)(J.customize.proChordNameColor)(),oa=m.toNumber(la(l)-3|0);else throw Error("Draw.Protar (86:16-95:11): "+
[oa.constructor.name]);var xa=d["void"](H.functorEffect),Aa=z.setTextAlign(w.context);var sa=w.app.settings.leftyFlip?z.AlignLeft.value:z.AlignRight.value;xa(Aa(sa))();d["void"](H.functorEffect)(z.fillText(w.context)(K.snd(ja.value0.piece))(x)(oa))();oa=z.measureText(w.context)(K.snd(ja.value0.piece))();oa=w.app.settings.leftyFlip?x+oa.width:x-oa.width;return A(oa)(l)(ja.value0.pieces)()};throw Error("Draw.Protar (82:32-103:38): "+[ja.constructor.name]);}}},M=A;var da=w.app.settings.leftyFlip?m.toNumber((R+
T|0)+5|0):Z-5|0;var O=M(da);N.zoomDescDo(n.ordSeconds)(H.monadEffect)(pa)(w.time)(u.chords)(function(x){return function(l){if(l instanceof r.Sustain)return c.pure(H.applicativeEffect)(g.unit);if(l instanceof r.Note)return O(x)(l.value0);if(l instanceof r.SustainEnd)return l=C.lookupLT(n.ordSeconds)(x)(u.chords),l instanceof t.Just&&l.value0.value instanceof r.Sustain?O(x)(l.value0.value.value0):c.pure(H.applicativeEffect)(g.unit);throw Error("Draw.Protar (105:62-111:21): "+[l.constructor.name]);}})();
(function(){var x=C.lookupLE(n.ordSeconds)(w.time)(u.chords);return x instanceof t.Just&&x.value0.value instanceof r.Sustain?O(w.time)(x.value0.value.value0)():g.unit})();N.zoomDescDo(n.ordSeconds)(H.monadEffect)(w.time)(ea)(u.chords)(function(x){return function(l){if(l instanceof r.SustainEnd)return c.pure(H.applicativeEffect)(g.unit);if(l instanceof r.Sustain||l instanceof r.Note)return O(x)(l.value0);throw Error("Draw.Protar (117:62-120:35): "+[l.constructor.name]);}})();U.setFillStyle(J.customize.highway)(w)();
U.fillRect({x:Z,y:w.minY,width:T,height:ua})(w)();U.setFillStyle(J.customize.highwaySolo)(w)();var Y=function(x){x=C.lookupLE(n.ordSeconds)(pa)(x);if(x instanceof t.Nothing)return!1;if(x instanceof t.Just)return x.value0.value;throw Error("Draw.Protar (126:28-128:31): "+[x.constructor.name]);};M=function(x){return q.fromFoldable(e.foldableArray)(h.cons(K.Tuple.create(pa)(Y(x)))(k.flip(h.snoc)(new K.Tuple(ea,!1))(N.doTupleArray(function(l){return I(l)(x)}))))};var P=function(x){if(x instanceof p.Nil||
x instanceof p.Cons&&x.value1 instanceof p.Nil)return c.pure(H.applicativeEffect)(g.unit);if(x instanceof p.Cons&&x.value1 instanceof p.Cons){var l=la(x.value1.value0.value0),W=la(x.value0.value0);return function(){c.when(H.applicativeEffect)(x.value0.value1)(e.for_(H.applicativeEffect)(e.foldableArray)(d.map(d.functorArray)(function(ja){return(ja*J.customize.widthProtarFret|0)+2|0})(h.range(0)(u.strings-1|0)))(function(ja){return U.fillRect({x:Z+ja|0,y:l,width:J.customize.widthProtarFret-2|0,height:W-
l|0})(w)}))();return P(x.value1)()}}throw Error("Draw.Protar (134:7-134:45): "+[x.constructor.name]);};P(M(u.solo))();ma(H.monadEffect)(u.solo)(function(x){return function(l){var W=la(x);return function(){U.setFillStyle(J.customize.highwaySoloEdge)(w)();return U.fillRect({x:Z,y:W,width:T,height:1})(w)()}}})();U.setFillStyle("rgba(255,255,255,0.3)")(w)();P(M(u.arpeggio))();U.drawBeats(la)({x:Z,width:T,minSecs:pa,maxSecs:ea})(w)();U.setFillStyle(J.customize.highwayRailing)(w)();e.for_(H.applicativeEffect)(e.foldableArray)(d.map(d.functorArray)(function(x){return x*
J.customize.widthProtarFret|0})(h.range(0)(u.strings)))(function(x){return U.fillRect({x:Z+x|0,y:w.minY,width:1,height:ua})(w)})();U.setFillStyle(J.customize.highwayDivider)(w)();e.for_(H.applicativeEffect)(e.foldableArray)(d.map(d.functorArray)(function(x){return(x*J.customize.widthProtarFret|0)+1|0})(h.range(0)(u.strings)))(function(x){return U.fillRect({x:Z+x|0,y:w.minY,width:1,height:ua})(w)})();va=[{c:function(x){return x.s6},lane:function(x){return x.s6},x:(fa(0+va|0)*J.customize.widthProtarFret|
0)+1|0,strum:F.image_gem_red_pro,hopo:F.image_gem_red_pro_hopo,tap:F.image_gem_red_pro_tap,shades:J.customize.sustainRed,target:F.image_highway_protar_target_red},{c:function(x){return x.s5},lane:function(x){return x.s5},x:(fa(1+va|0)*J.customize.widthProtarFret|0)+1|0,strum:F.image_gem_green_pro,hopo:F.image_gem_green_pro_hopo,tap:F.image_gem_green_pro_tap,shades:J.customize.sustainGreen,target:F.image_highway_protar_target_green},{c:function(x){return x.s4},lane:function(x){return x.s4},x:(fa(2+
va|0)*J.customize.widthProtarFret|0)+1|0,strum:F.image_gem_orange_pro,hopo:F.image_gem_orange_pro_hopo,tap:F.image_gem_orange_pro_tap,shades:J.customize.sustainOrange,target:F.image_highway_protar_target_orange},{c:function(x){return x.s3},lane:function(x){return x.s3},x:(fa(3+va|0)*J.customize.widthProtarFret|0)+1|0,strum:F.image_gem_blue_pro,hopo:F.image_gem_blue_pro_hopo,tap:F.image_gem_blue_pro_tap,shades:J.customize.sustainBlue,target:F.image_highway_protar_target_blue},{c:function(x){return x.s2},
lane:function(x){return x.s2},x:(fa(4+va|0)*J.customize.widthProtarFret|0)+1|0,strum:F.image_gem_yellow_pro,hopo:F.image_gem_yellow_pro_hopo,tap:F.image_gem_yellow_pro_tap,shades:J.customize.sustainYellow,target:F.image_highway_protar_target_yellow},{c:function(x){return x.s1},lane:function(x){return x.s1},x:(fa(5+va|0)*J.customize.widthProtarFret|0)+1|0,strum:F.image_gem_purple_pro,hopo:F.image_gem_purple_pro_hopo,tap:F.image_gem_purple_pro_tap,shades:J.customize.sustainPurple,target:F.image_highway_protar_target_purple},
{c:function(x){return x.s7},lane:function(x){return x.s7},x:(fa(-1+va|0)*J.customize.widthProtarFret|0)+1|0,strum:F.image_gem_purple_pro,hopo:F.image_gem_purple_pro_hopo,tap:F.image_gem_purple_pro_tap,shades:J.customize.sustainPurple,target:F.image_highway_protar_target_purple},{c:function(x){return x.s8},lane:function(x){return x.s8},x:(fa(-2+va|0)*J.customize.widthProtarFret|0)+1|0,strum:F.image_gem_yellow_pro,hopo:F.image_gem_yellow_pro_hopo,tap:F.image_gem_yellow_pro_tap,shades:J.customize.sustainYellow,
target:F.image_highway_protar_target_yellow}];var ca=h.take(u.strings)(va);e.for_(H.applicativeEffect)(e.foldableArray)(ca)(function(x){var l=C.union(n.ordSeconds)(u.bre)(x.lane(u.lanes)),W=function(){var oa=C.lookupLE(n.ordSeconds)(pa)(l);if(oa instanceof t.Nothing)return!1;if(oa instanceof t.Just)return oa.value0.value;throw Error("Draw.Protar (195:20-197:29): "+[oa.constructor.name]);}();W=q.fromFoldable(e.foldableArray)(h.cons(new K.Tuple(pa,W))(k.flip(h.snoc)(new K.Tuple(ea,!1))(N.doTupleArray(function(oa){return I(oa)(l)}))));
var ja=function(oa){if(oa instanceof p.Nil||oa instanceof p.Cons&&oa.value1 instanceof p.Nil)return c.pure(H.applicativeEffect)(g.unit);if(oa instanceof p.Cons&&oa.value1 instanceof p.Cons){var xa=la(oa.value1.value0.value0),Aa=la(oa.value0.value0);return function(){c.when(H.applicativeEffect)(oa.value0.value1)(U.drawLane({x:(Z+x.x|0)+1|0,y:xa,width:J.customize.widthProtarFret-2|0,height:Aa-xa|0})(w))();return ja(oa.value1)()}}throw Error("Draw.Protar (203:5-203:43): "+[oa.constructor.name]);};return ja(W)})();
e.for_(H.applicativeEffect)(e.foldableArray)(ca)(function(x){return U.drawImage(x.target)(Z+x.x|0)(aa-5)(w)})();e.for_(H.applicativeEffect)(e.foldableArray)(ca)(function(x){var l=x.c(u.notes),W=function(){var sa=C.lookupLT(n.ordSeconds)(X(w.maxY))(l);return sa instanceof t.Just&&sa.value0.value instanceof r.Sustain?new t.Just(new K.Tuple(sa.value0.key,sa.value0.value.value0)):t.Nothing.value}(),ja=function(sa){sa=C.lookupLE(n.ordSeconds)(sa)(u.energy);if(sa instanceof t.Nothing)return!1;if(sa instanceof
t.Just)return sa.value0.value;throw Error("Draw.Protar (222:25-224:33): "+[sa.constructor.name]);};var oa=w.app.settings.autoplay?aa:w.maxY+50|0;var xa=function(sa){return function(wa){return function(Fa){return function(Ca){return c.when(H.applicativeEffect)((sa<oa||wa<oa)&&!Ca.phantom)(function(){var Ea=v.min(v.ordInt)(sa)(oa),Ia=v.min(v.ordInt)(wa)(oa),Ja=w.app.settings.autoplay&&(aa<sa||aa<wa),Ha=Fa?J.customize.sustainEnergy:t.isNothing(Ca.fret)?J.customize.sustainProtarMute:x.shades,Ga=(Ia-Ea|
0)+1|0;return function(){U.setFillStyle(Ha.light)(w)();U.fillRect({x:m.toNumber((Z+x.x|0)+12|0),y:Ea,width:1,height:Ga})(w)();U.setFillStyle(Ha.normal)(w)();U.fillRect({x:m.toNumber((Z+x.x|0)+13|0),y:Ea,width:5,height:Ga})(w)();U.setFillStyle(Ha.dark)(w)();U.fillRect({x:m.toNumber((Z+x.x|0)+18|0),y:Ea,width:1,height:Ga})(w)();U.setFillStyle(J.customize.sustainBorder)(w)();U.fillRect({x:m.toNumber((Z+x.x|0)+11|0),y:Ea,width:1,height:Ga})(w)();U.fillRect({x:m.toNumber((Z+x.x|0)+19|0),y:Ea,width:1,height:Ga})(w)();
U.fillRect({x:m.toNumber((Z+x.x|0)+11|0),y:Ea,width:9,height:1})(w)();(function(){if(Ca.slide instanceof t.Nothing)return g.unit;if(Ca.slide instanceof t.Just)return z.strokePath(w.context)(function(){if(Ca.slide.value0 instanceof r.SlideDown)return function(){z.moveTo(w.context)(Z+x.x|0)(sa)();return z.lineTo(w.context)(m.toNumber((Z+x.x|0)+J.customize.widthProtarFret|0))(wa)()};if(Ca.slide.value0 instanceof r.SlideUp)return function(){z.moveTo(w.context)(m.toNumber((Z+x.x|0)+J.customize.widthProtarFret|
0))(sa)();return z.lineTo(w.context)(Z+x.x|0)(wa)()};throw Error("Draw.Protar (252:56-258:88): "+[Ca.slide.value0.constructor.name]);}())();throw Error("Draw.Protar (250:11-258:88): "+[Ca.slide.constructor.name]);})();return c.when(H.applicativeEffect)(Ja)(function(){U.setFillStyle(Ha.light)(w)();return U.fillRect({x:m.toNumber((Z+x.x|0)+1|0),y:aa-4|0,width:J.customize.widthProtarFret-1|0,height:8})(w)()})()}}())}}}},Aa=function(sa){return function(wa){if(sa instanceof t.Nothing&&wa instanceof p.Nil)return c.pure(H.applicativeEffect)(g.unit);
if(wa instanceof p.Cons)return function(){if(!(sa instanceof t.Nothing))if(sa instanceof t.Just)xa(la(wa.value0.value0))(la(sa.value0.value0))(ja(sa.value0.value0))(sa.value0.value1)();else throw Error("Draw.Protar (265:11-267:125): "+[sa.constructor.name]);var Fa=wa.value0.value1 instanceof r.Sustain?new t.Just(new K.Tuple(wa.value0.value0,wa.value0.value1.value0)):t.Nothing.value;return Aa(Fa)(wa.value1)()};if(sa instanceof t.Just&&wa instanceof p.Nil)return xa(w.minY)(la(sa.value0.value0))(ja(sa.value0.value0))(sa.value0.value1);
throw Error("Draw.Protar (263:9-263:37): "+[sa.constructor.name,wa.constructor.name]);}};return Aa(W)(q.fromFoldable(e.foldableArray)(N.doTupleArray(function(sa){return I(sa)(l)})))})();var V=function(x){return function(l){if(x instanceof r.Note||x instanceof r.Sustain)return l(x.value0);if(x instanceof r.SustainEnd)return c.pure(H.applicativeEffect)(g.unit);throw Error("Draw.Protar (281:7-281:53): "+[x.constructor.name,l.constructor.name]);}},S=function(x){x=h.index(F.protarFrets)(x);if(x instanceof
t.Just)return x.value0;if(x instanceof t.Nothing)return F.image_pro_fret_00;throw Error("Draw.Protar (285:21-287:37): "+[x.constructor.name]);},ha=function(x){return function(l){return function(W){if(W.fret instanceof t.Just){var ja=function(){if(W.noteType instanceof r.Strum)return l?F.image_gem_energy_pro:x.strum;if(W.noteType instanceof r.HOPO)return l?F.image_gem_energy_pro_hopo:x.hopo;if(W.noteType instanceof r.Tap)return l?F.image_gem_energy_pro_tap:x.tap;throw Error("Draw.Protar (291:18-294:79): "+
[W.noteType.constructor.name]);}();return[ja,S(W.fret.value0)]}if(W.fret instanceof t.Nothing)return ja=function(){if(W.noteType instanceof r.Strum)return l?F.image_gem_energy_mute:F.image_gem_mute;if(W.noteType instanceof r.HOPO)return l?F.image_gem_energy_mute_hopo:F.image_gem_mute_hopo;if(W.noteType instanceof r.Tap)return l?F.image_gem_energy_mute_tap:F.image_gem_mute_tap;throw Error("Draw.Protar (297:18-300:89): "+[W.noteType.constructor.name]);}(),[ja];throw Error("Draw.Protar (289:39-301:20): "+
[W.fret.constructor.name]);}}};(function(){var x=C.lookupLE(n.ordSeconds)(w.time)(u.arpeggio);return x instanceof t.Just&&x.value0.value?(z.setGlobalAlpha(w.context)(.5)(),e.for_(H.applicativeEffect)(e.foldableArray)(ca)(function(l){var W=C.lookup(n.ordSeconds)(x.value0.key)(l.c(u.notes));if(W instanceof t.Just)return V(W.value0)(function(ja){return e.for_(H.applicativeEffect)(e.foldableArray)(ha(l)(!1)(ja))(function(oa){return U.drawImage(oa)(Z+l.x|0)(m.toNumber(la(w.time)-10|0))(w)})});if(W instanceof
t.Nothing)return c.pure(H.applicativeEffect)(g.unit);throw Error("Draw.Protar (306:9-310:31): "+[W.constructor.name]);})(),z.setGlobalAlpha(w.context)(1)()):g.unit})();e.for_(H.applicativeEffect)(e.foldableArray)(ca)(function(x){return ma(H.monadEffect)(x.c(u.notes))(function(l){return function(W){return V(W)(function(ja){var oa=U.secToNum(G.append(n.semigroupSeconds)(l)(n.negateDuration(n.durationSeconds)(w.time)));return c.unless(H.applicativeEffect)(ja.phantom&&0>=oa)(function(){c.when(H.applicativeEffect)(ja.phantom)(z.setGlobalAlpha(w.context)(.5))();
(function(){if(w.app.settings.autoplay&&0>=oa)return-.1<oa?(U.setFillStyle(x.shades.hit((oa+.1)/.05))(w)(),U.fillRect({x:m.toNumber((Z+x.x|0)+1|0),y:aa-4|0,width:J.customize.widthProtarFret-1|0,height:8})(w)()):g.unit;var xa=la(l),Aa=!ja.phantom&&function(){var sa=C.lookupLE(n.ordSeconds)(l)(u.energy);if(sa instanceof t.Just)return sa.value0.value;if(sa instanceof t.Nothing)return!1;throw Error("Draw.Protar (330:47-332:46): "+[sa.constructor.name]);}();return e.for_(H.applicativeEffect)(e.foldableArray)(ha(x)(Aa)(ja))(function(sa){return U.drawImage(sa)(Z+
x.x|0)(xa-10|0)(w)})()})();return c.when(H.applicativeEffect)(ja.phantom)(z.setGlobalAlpha(w.context)(1))()})})}})})();U.drawBadgeVertical(Q)(Z)(T)(w)();return((R+u.chordsWidth|0)+T|0)+J.customize.marginWidth|0}}}}};b.eachChordsWidth=function(u){return function(Q){return function(){var R=y["for"](H.applicativeEffect)(y.traversableArray)(Q.parts)(function(w){if(w.value1.protar instanceof t.Nothing)return c.pure(H.applicativeEffect)(new K.Tuple(w.value0,w.value1));if(w.value1.protar instanceof t.Just)return function(){var L=
y["for"](H.applicativeEffect)(y.traversableArray)(w.value1.protar.value0)(function(T){return function(){var Z=ba(u)(T.value1)();return new K.Tuple(T.value0,Z)}})();return K.Tuple.create(w.value0)({five:w.value1.five,six:w.value1.six,drums:w.value1.drums,prokeys:w.value1.prokeys,protar:new t.Just(L),amplitude:w.value1.amplitude,vocal:w.value1.vocal,dance:w.value1.dance})};throw Error("Draw.Protar (45:52-51:55): "+[w.value1.protar.constructor.name]);})();return{end:Q.end,beats:Q.beats,parts:R,title:Q.title,
artist:Q.artist,author:Q.author,sections:Q.sections}}}}})(PS);
(function(a){a["Draw.Six"]=a["Draw.Six"]||{};var b=a["Draw.Six"],c=a["Control.Applicative"],h=a["Data.Array"],e=a["Data.Foldable"],k=a["Data.Function"],d=a["Data.Functor"],m=a["Data.Int"],q=a["Data.List"],p=a["Data.List.Types"],C=a["Data.Map.Internal"],t=a["Data.Maybe"],v=a["Data.Newtype"],G=a["Data.Ord"],D=a["Data.Semigroup"],n=a["Data.Time.Duration"],y=a["Data.Tuple"],K=a["Data.Unit"],g=a["Draw.Common"],U=a.Effect,H=a["Graphics.Canvas"],z=a.Images,F=a.OnyxMap,N=a.Song,r=a.Style,J=function(){function R(){}
R.value=new R;return R}(),ba=function(){function R(){}R.value=new R;return R}(),u=function(){function R(){}R.value=new R;return R}(),Q=function(){function R(){}R.value=new R;return R}();b.drawSix=function(R){return function(w){return function(L){return function(T){return function(){var Z=d.map(U.functorEffect)(m.round)(H.getCanvasHeight(T.canvas))(),la=(3*r.customize.widthStandardFret|0)+2|0,aa=function(P){return Z-T.secsToPxVert(D.append(n.semigroupSeconds)(P)(n.negateDuration(n.durationSeconds)(T.time)))|
0},X=aa(T.time),pa=function(P){return D.append(n.semigroupSeconds)(T.pxToSecsVert(Z-P|0))(T.time)},ea=pa(T.maxY+50|0),I=pa(T.minY-50|0),ma=function(P){return F.zoomAscDo(n.ordSeconds)(P)(ea)(I)},va=function(P){return F.zoomDescDo(n.ordSeconds)(P)(ea)(I)},fa=function(P){return T.app.settings.leftyFlip?2-P|0:P},ua=T.maxY-T.minY|0;g.setFillStyle(r.customize.highway)(T)();g.fillRect({x:L,y:T.minY,width:110,height:ua})(T)();g.setFillStyle(r.customize.highwaySolo)(T)();var B=function(){var P=C.lookupLE(n.ordSeconds)(ea)(R.solo);
if(P instanceof t.Nothing)return!1;if(P instanceof t.Just)return P.value0.value;throw Error("Draw.Six (50:22-52:31): "+[P.constructor.name]);}();B=q.fromFoldable(e.foldableArray)(h.cons(new y.Tuple(ea,B))(k.flip(h.snoc)(new y.Tuple(I,!1))(F.doTupleArray(function(P){return ma(P)(R.solo)}))));var A=function(P){if(P instanceof p.Nil||P instanceof p.Cons&&P.value1 instanceof p.Nil)return c.pure(U.applicativeEffect)(K.unit);if(P instanceof p.Cons&&P.value1 instanceof p.Cons){var ca=aa(P.value1.value0.value0),
V=aa(P.value0.value0);return function(){c.when(U.applicativeEffect)(P.value0.value1)(e.for_(U.applicativeEffect)(e.foldableArray)(d.map(d.functorArray)(function(S){return(S*r.customize.widthStandardFret|0)+2|0})(h.range(0)(2)))(function(S){return g.fillRect({x:L+S|0,y:ca,width:r.customize.widthStandardFret-2|0,height:V-ca|0})(T)}))();return A(P.value1)()}}throw Error("Draw.Six (58:7-58:45): "+[P.constructor.name]);};A(B)();va(U.monadEffect)(R.solo)(function(P){return function(ca){var V=aa(P);return function(){g.setFillStyle(r.customize.highwaySoloEdge)(T)();
return g.fillRect({x:L,y:V,width:la,height:1})(T)()}}})();g.drawBeats(aa)({x:L,width:la,minSecs:ea,maxSecs:I})(T)();g.setFillStyle(r.customize.highwayRailing)(T)();e.for_(U.applicativeEffect)(e.foldableArray)(d.map(d.functorArray)(function(P){return P*r.customize.widthStandardFret|0})(h.range(0)(3)))(function(P){return g.fillRect({x:L+P|0,y:T.minY,width:1,height:ua})(T)})();g.setFillStyle(r.customize.highwayDivider)(T)();e.for_(U.applicativeEffect)(e.foldableArray)(d.map(d.functorArray)(function(P){return(P*
r.customize.widthStandardFret|0)+1|0})(h.range(0)(3)))(function(P){return g.fillRect({x:L+P|0,y:T.minY,width:1,height:ua})(T)})();g.drawImage(z.image_highway_ghl_target)(L)(X-5)(T)();var M={strum:z.image_gem_white,hopo:z.image_gem_white_hopo,tap:z.image_gem_white_tap,energy:z.image_gem_ghl_energy},da=function(P){if(P instanceof u)return T.app.settings.leftyFlip?r.customize.sustainBlackGHL:r.customize.sustainWhiteGHL;if(P instanceof Q)return r.customize.sustainBothGHL;if(P instanceof ba)return T.app.settings.leftyFlip?
r.customize.sustainWhiteGHL:r.customize.sustainBlackGHL;if(P instanceof J)return r.customize.sustainOpenGHL;throw Error("Draw.Six (102:22-106:45): "+[P.constructor.name]);};fa=[{c:function(P){return P.open},x:(0*r.customize.widthStandardFret|0)+1|0,color:J.value},{c:function(P){return P.b1},x:(fa(0)*r.customize.widthStandardFret|0)+1|0,color:ba.value},{c:function(P){return P.b2},x:(fa(1)*r.customize.widthStandardFret|0)+1|0,color:ba.value},{c:function(P){return P.b3},x:(fa(2)*r.customize.widthStandardFret|
0)+1|0,color:ba.value},{c:function(P){return P.w1},x:(fa(0)*r.customize.widthStandardFret|0)+1|0,color:u.value},{c:function(P){return P.w2},x:(fa(1)*r.customize.widthStandardFret|0)+1|0,color:u.value},{c:function(P){return P.w3},x:(fa(2)*r.customize.widthStandardFret|0)+1|0,color:u.value},{c:function(P){return P.bw1},x:(fa(0)*r.customize.widthStandardFret|0)+1|0,color:Q.value},{c:function(P){return P.bw2},x:(fa(1)*r.customize.widthStandardFret|0)+1|0,color:Q.value},{c:function(P){return P.bw3},x:(fa(2)*
r.customize.widthStandardFret|0)+1|0,color:Q.value}];var O={strum:z.image_gem_black,hopo:z.image_gem_black_hopo,tap:z.image_gem_black_tap,energy:z.image_gem_ghl_energy},Y=function(P){if(P instanceof ba)return T.app.settings.leftyFlip?M:O;if(P instanceof u)return T.app.settings.leftyFlip?O:M;if(P instanceof Q)return T.app.settings.leftyFlip?{strum:z.image_gem_whiteblack,hopo:z.image_gem_whiteblack_hopo,tap:z.image_gem_whiteblack_tap,energy:z.image_gem_ghl_energy}:{strum:z.image_gem_blackwhite,hopo:z.image_gem_blackwhite_hopo,
tap:z.image_gem_blackwhite_tap,energy:z.image_gem_ghl_energy};if(P instanceof J)return{strum:z.image_gem_openghl,hopo:z.image_gem_openghl_hopo,tap:z.image_gem_openghl_tap,energy:z.image_gem_openghl_energy};throw Error("Draw.Six (109:25-115:141): "+[P.constructor.name]);};e.for_(U.applicativeEffect)(e.foldableArray)(fa)(function(P){var ca=P.c(v.unwrap(N.newtypeSixEach)(R.notes)),V=function(){var ja=C.lookupLT(n.ordSeconds)(pa(T.maxY))(ca);return ja instanceof t.Just&&ja.value0.value instanceof N.Sustain?
new t.Just(ja.value0.key):t.Nothing.value}();var S=P.color instanceof J?(1*r.customize.widthStandardFret|0)+1|0:P.x;var ha=function(ja){ja=C.lookupLE(n.ordSeconds)(ja)(R.energy);if(ja instanceof t.Nothing)return!1;if(ja instanceof t.Just)return ja.value0.value;throw Error("Draw.Six (121:25-123:33): "+[ja.constructor.name]);};var x=T.app.settings.autoplay?X:T.maxY+50|0;var l=function(ja){return function(oa){return function(xa){return c.when(U.applicativeEffect)(ja<x||oa<x)(function(){var Aa=G.min(G.ordInt)(ja)(x),
sa=G.min(G.ordInt)(oa)(x),wa=T.app.settings.autoplay&&(X<ja||X<oa);var Fa=xa?r.customize.sustainEnergy:da(P.color);var Ca=(sa-Aa|0)+1|0;return function(){g.setFillStyle(r.customize.sustainBorder)(T)();g.fillRect({x:m.toNumber((L+S|0)+14|0),y:Aa,width:1,height:Ca})(T)();g.fillRect({x:m.toNumber((L+S|0)+22|0),y:Aa,width:1,height:Ca})(T)();g.setFillStyle(Fa.light)(T)();g.fillRect({x:m.toNumber((L+S|0)+15|0),y:Aa,width:1,height:Ca})(T)();g.setFillStyle(Fa.normal)(T)();g.fillRect({x:m.toNumber((L+S|0)+
16|0),y:Aa,width:5,height:Ca})(T)();g.setFillStyle(Fa.dark)(T)();g.fillRect({x:m.toNumber((L+S|0)+21|0),y:Aa,width:1,height:Ca})(T)();return c.when(U.applicativeEffect)(wa)(function(){g.setFillStyle(Fa.light)(T)();return g.fillRect({x:m.toNumber((L+S|0)+1|0),y:X-4|0,width:r.customize.widthStandardFret-1|0,height:8})(T)()})()}}())}}},W=function(ja){return function(oa){if(ja instanceof t.Nothing&&oa instanceof p.Nil)return c.pure(U.applicativeEffect)(K.unit);if(oa instanceof p.Cons)return function(){if(!(ja instanceof
t.Nothing))if(ja instanceof t.Just)l(aa(oa.value0.value0))(aa(ja.value0))(ha(ja.value0))();else throw Error("Draw.Six (148:11-150:113): "+[ja.constructor.name]);var xa=oa.value0.value1 instanceof N.Sustain?new t.Just(oa.value0.value0):t.Nothing.value;return W(xa)(oa.value1)()};if(ja instanceof t.Just&&oa instanceof p.Nil)return l(T.minY)(aa(ja.value0))(ha(ja.value0));throw Error("Draw.Six (146:9-146:37): "+[ja.constructor.name,oa.constructor.name]);}};return W(V)(q.fromFoldable(e.foldableArray)(F.doTupleArray(function(ja){return ma(ja)(ca)})))})();
e.for_(U.applicativeEffect)(e.foldableArray)(fa)(function(P){return function(){g.setFillStyle(r.customize.sustainBorder)(T)();return va(U.monadEffect)(P.c(v.unwrap(N.newtypeSixEach)(R.notes)))(function(ca){return function(V){if(V instanceof N.SustainEnd){V=P.color instanceof J?(1*r.customize.widthStandardFret|0)+1|0:P.x;var S=g.secToNum(D.append(n.semigroupSeconds)(ca)(n.negateDuration(n.durationSeconds)(T.time)));return T.app.settings.autoplay&&0>=S?c.pure(U.applicativeEffect)(K.unit):g.fillRect({x:m.toNumber((L+
V|0)+14|0),y:m.toNumber(aa(ca)),width:9,height:1})(T)}return c.pure(U.applicativeEffect)(K.unit)}})()}})();e.for_(U.applicativeEffect)(e.foldableArray)(fa)(function(P){var ca=Y(P.color);return va(U.monadEffect)(P.c(v.unwrap(N.newtypeSixEach)(R.notes)))(function(V){return function(S){var ha=function(x){var l=P.color instanceof J?(1*r.customize.widthStandardFret|0)+1|0:P.x;var W=g.secToNum(D.append(n.semigroupSeconds)(V)(n.negateDuration(n.durationSeconds)(T.time)));if(T.app.settings.autoplay&&0>=W)return-.1<
W?function(){g.setFillStyle(da(P.color).hit((W+.1)/.05))(T)();return g.fillRect({x:m.toNumber((L+l|0)+1|0),y:X-4|0,width:r.customize.widthStandardFret-1|0,height:8})(T)()}:c.pure(U.applicativeEffect)(K.unit);var ja=aa(V);var oa=P.color instanceof J?ja-3|0:ja-5|0;var xa=L+P.x|0,Aa=function(){var wa=C.lookupLE(n.ordSeconds)(V)(R.energy);if(wa instanceof t.Just)return wa.value0.value;if(wa instanceof t.Nothing)return!1;throw Error("Draw.Six (200:28-202:46): "+[wa.constructor.name]);}(),sa=function(){if(x instanceof
N.Strum)return ca.strum;if(x instanceof N.HOPO)return ca.hopo;if(x instanceof N.Tap)return ca.tap;throw Error("Draw.Six (203:23-206:36): "+[x.constructor.name]);}();return function(){g.drawImage(sa)(xa)(oa)(T)();return c.when(U.applicativeEffect)(Aa)(g.drawImage(ca.energy)(xa)(oa)(T))()}};if(S instanceof N.Note||S instanceof N.Sustain)return ha(S.value0);if(S instanceof N.SustainEnd)return c.pure(U.applicativeEffect)(K.unit);throw Error("Draw.Six (213:10-216:33): "+[S.constructor.name]);}})})();g.drawBadgeVertical(w)(L)(la)(T)();
return(L+la|0)+r.customize.marginWidth|0}}}}}})(PS);
(function(a){a["Draw.Vocal"]=a["Draw.Vocal"]||{};var b=a["Control.Applicative"],c=a["Control.Category"],h=a["Data.Boolean"],e=a["Data.Either"],k=a["Data.Eq"],d=a["Data.Foldable"],m=a["Data.Functor"],q=a["Data.Int"],p=a["Data.List"],C=a["Data.List.Types"],t=a["Data.Map.Internal"],v=a["Data.Maybe"],G=a["Data.Ord"],D=a["Data.Semigroup"],n=a["Data.String.Regex"],y=a["Data.String.Regex.Flags"],K=a["Data.Time.Duration"],g=a["Data.Tuple"],U=a["Data.Unit"],H=a["Draw.Common"],z=a.Effect,F=a["Effect.Exception.Unsafe"],
N=a["Graphics.Canvas"],r=a.OnyxMap,J=a.Song,ba=a.Style;a["Draw.Vocal"].drawVocal=function(u){return function(Q){return function(R){return function(w){return function(){var L=m.map(z.functorEffect)(q.round)(N.getCanvasWidth(w.canvas))(),T=function(B){return w.secsToPxHoriz(D.append(K.semigroupSeconds)(B)(K.negateDuration(K.durationSeconds)(w.time)))},Z=T(w.time),la=function(B){return D.append(K.semigroupSeconds)(w.pxToSecsHoriz(B))(w.time)},aa=la(-100),X=la(L+100|0),pa=function(B){return H.zoomAscDoPadding(K.ordSeconds)(B)(aa)(X)};
la=function(B){return H.zoomDescDoPadding(K.ordSeconds)(B)(aa)(X)};H.setFillStyle(ba.customize.vocalNoteArea)(w)();H.fillRect({x:0,y:R+25,width:L,height:130})(w)();H.setFillStyle(ba.customize.lyricLaneBottom)(w)();H.fillRect({x:0,y:R+155,width:L,height:25})(w)();H.setFillStyle(ba.customize.lyricLaneTop)(w)();H.fillRect({x:0,y:R,width:L,height:25})(w)();var ea=function(){var B=t.lookupLE(K.ordSeconds)(w.time)(u.ranges);if(B instanceof v.Nothing)return{min:36,max:84};if(B instanceof v.Just&&B.value0.value instanceof
J.VocalRange)return{min:B.value0.value.value0,max:B.value0.value.value1};if(B instanceof v.Just&&B.value0.value instanceof J.VocalRangeShift){var A=t.lookupGT(K.ordSeconds)(w.time)(u.ranges);if(A instanceof v.Just&&A.value0.value instanceof J.VocalRange){var M=t.lookupLT(K.ordSeconds)(B.value0.key)(u.ranges);if(M instanceof v.Just&&M.value0.value instanceof J.VocalRange)return{min:H.slide(H.secToNum(B.value0.key))(H.secToNum(A.value0.key))(H.secToNum(w.time))(M.value0.value.value0)(A.value0.value.value0),
max:H.slide(H.secToNum(B.value0.key))(H.secToNum(A.value0.key))(H.secToNum(w.time))(M.value0.value.value1)(A.value0.value.value1)}}return F.unsafeThrow("not a valid range shift")}throw Error("Draw.Vocal (48:19-59:7): "+[B.constructor.name]);}(),I=function(B){return R+H.slide(ea.min)(ea.max)(B)(143)(37)};L=[{part:u.harm2,line:ba.customize.harm2Pitch,talky:ba.customize.harm2Talky,width:6},{part:u.harm3,line:ba.customize.harm3Pitch,talky:ba.customize.harm3Talky,width:5},{part:u.harm1,line:ba.customize.harm1Pitch,
talky:ba.customize.harm1Talky,width:4}];var ma=function(B){return function(A){if(B instanceof v.Just&&A instanceof C.Cons&&A.value0.value1 instanceof J.VocalStart&&A.value0.value1.value1 instanceof v.Just&&("+"===A.value0.value1.value0||"+$"===A.value0.value1.value0))return function(){H.onContext(function(M){return N.moveTo(M)(q.toNumber(T(B.value0.value0)))(I(B.value0.value1))})(w)();H.onContext(function(M){return N.lineTo(M)(q.toNumber(T(A.value0.value0)))(I(A.value0.value1.value1.value0))})(w)();
return ma(v.Nothing.value)(A)()};if(B instanceof v.Just)return ma(v.Nothing.value)(A);if(B instanceof v.Nothing&&A instanceof C.Cons&&A.value0.value1 instanceof J.VocalStart&&A.value0.value1.value1 instanceof v.Just&&A.value1 instanceof C.Cons&&A.value1.value0.value1 instanceof J.VocalEnd)return function(){H.onContext(function(M){return N.moveTo(M)(q.toNumber(T(A.value0.value0)))(I(A.value0.value1.value1.value0))})(w)();H.onContext(function(M){return N.lineTo(M)(q.toNumber(T(A.value1.value0.value0)))(I(A.value0.value1.value1.value0))})(w)();
return ma(new v.Just(new g.Tuple(A.value1.value0.value0,A.value0.value1.value1.value0)))(A.value1.value1)()};if(B instanceof v.Nothing&&A instanceof C.Cons&&A.value0.value1 instanceof J.VocalStart&&A.value0.value1.value1 instanceof v.Just&&A.value1 instanceof C.Cons&&A.value1.value0.value1 instanceof J.VocalStart)return function(){H.onContext(function(M){return N.moveTo(M)(q.toNumber(T(A.value0.value0)))(I(A.value0.value1.value1.value0))})(w)();H.onContext(function(M){return N.lineTo(M)(q.toNumber(T(A.value1.value0.value0)))(I(A.value0.value1.value1.value0))})(w)();
return ma(new v.Just(new g.Tuple(A.value1.value0.value0,A.value0.value1.value1.value0)))(A.value1)()};if(B instanceof v.Nothing&&A instanceof C.Cons&&A.value0.value1 instanceof J.VocalStart&&A.value0.value1.value1 instanceof v.Nothing&&A.value1 instanceof C.Cons&&A.value1.value0.value1 instanceof J.VocalEnd)return function(){H.fillRect({x:q.toNumber(T(A.value0.value0)),y:R+25,width:q.toNumber(T(A.value1.value0.value0)-T(A.value0.value0)|0),height:130})(w)();return ma(v.Nothing.value)(A.value1.value1)()};
if(B instanceof v.Nothing&&A instanceof C.Cons&&A.value0.value1 instanceof J.VocalStart&&A.value0.value1.value1 instanceof v.Nothing&&A.value1 instanceof C.Cons&&A.value1.value0.value1 instanceof J.VocalStart)return function(){H.fillRect({x:q.toNumber(T(A.value0.value0)),y:R+25,width:q.toNumber(T(A.value1.value0.value0)-T(A.value0.value0)|0),height:130})(w)();return ma(v.Nothing.value)(A.value1)()};if(B instanceof v.Nothing&&A instanceof C.Cons&&A.value0.value1 instanceof J.VocalStart&&A.value1 instanceof
C.Nil||A instanceof C.Nil)return b.pure(z.applicativeEffect)(U.unit);if(B instanceof v.Nothing&&A instanceof C.Cons&&A.value0.value1 instanceof J.VocalEnd)return ma(v.Nothing.value)(A.value1);throw Error("Draw.Vocal (60:7-60:96): "+[B.constructor.name,A.constructor.name]);}};H.onContext(function(B){return N.setLineCap(B)(N.Round.value)})(w)();d.for_(z.applicativeEffect)(d.foldableArray)(L)(function(B){return function(){H.onContext(N.beginPath)(w)();H.onContext(function(A){return N.setStrokeStyle(A)(B.line)})(w)();
H.onContext(function(A){return N.setLineWidth(A)(B.width)})(w)();H.onContext(function(A){return N.setFillStyle(A)(B.talky)})(w)();ma(v.Nothing.value)(p.fromFoldable(d.foldableArray)(r.doTupleArray(function(A){return pa(A)(B.part)})))();H.onContext(N.stroke)(w)();return H.onContext(N.closePath)(w)()}})();var va=function(B){return function(A){return function(M){if(A instanceof C.Nil)return M;if(M instanceof C.Nil)return A;if(A instanceof C.Cons&&M instanceof C.Cons)return G.lessThanOrEq(B)(A.value0.time)(M.value0.time)?
C.Cons.create(A.value0)(va(B)(A.value1)(M)):C.Cons.create(M.value0)(va(B)(A)(M.value1));throw Error("Draw.Vocal (163:7-167:34): "+[A.constructor.name,M.constructor.name]);}}},fa=function(B){return function(A){var M=p.uncons(A);if(M instanceof v.Nothing)return C.Nil.value;if(M instanceof v.Just){A=function(){if(M.value0.head.value1 instanceof J.VocalEnd)return v.Nothing.value;if(M.value0.head.value1 instanceof J.VocalStart){var da;if(!(da="+"===M.value0.head.value1.value0||n.test(e.either(F.unsafeThrow)(c.identity(c.categoryFn))(n.regex("\\$$")(y.noFlags)))(M.value0.head.value1.value0))&&
(da=B)){da=k.eq(v.eqMaybe(k.eqString));var O=M.value0.head.value0;O=t.lookup(K.ordSeconds)(O)(u.harm2);if(O instanceof v.Nothing||O instanceof v.Just&&O.value0 instanceof J.VocalEnd)O=v.Nothing.value;else if(O instanceof v.Just&&O.value0 instanceof J.VocalStart)O=new v.Just(O.value0.value0);else throw Error("Draw.Vocal (110:22-113:48): "+[O.constructor.name]);da=da(O)(new v.Just(M.value0.head.value1.value0))}if(da)return v.Nothing.value;if(h.otherwise){da=v.Just;O=M.value0.head.value0;var Y=p.uncons(M.value0.tail);
if(Y instanceof v.Nothing)Y=D.append(K.semigroupSeconds)(M.value0.head.value0)(100);else if(Y instanceof v.Just)Y=g.fst(Y.value0.head);else throw Error("Draw.Vocal (131:24-134:40): "+[Y.constructor.name]);return new da({time:O,end:Y,lyric:n.replace(e.either(F.unsafeThrow)(c.identity(c.categoryFn))(n.regex("=$")(y.noFlags)))("-")(M.value0.head.value1.value0),isTalky:v.isNothing(M.value0.head.value1.value1)})}}throw Error("Draw.Vocal (123:23-137:18): "+[M.value0.head.value1.constructor.name]);}();if(A instanceof
v.Nothing)return fa(B)(M.value0.tail);if(A instanceof v.Just)return C.Cons.create(A.value0)(fa(B)(M.value0.tail));throw Error("Draw.Vocal (138:14-140:60): "+[A.constructor.name]);}throw Error("Draw.Vocal (119:31-140:60): "+[M.constructor.name]);}},ua=function(B){return function(A){return function(M){if(M instanceof C.Nil)return b.pure(z.applicativeEffect)(U.unit);if(M instanceof C.Cons){var da=G.max(G.ordNumber)(B)(q.toNumber(T(M.value0.time)));return function(){H.onContext(function(Y){Y=N.setFont(Y);
var P=M.value0.isTalky?ba.customize.lyricFontTalky:ba.customize.lyricFont;return Y(P)})(w)();H.setFillStyle(function(){if(G.lessThanOrEq(K.ordSeconds)(M.value0.time)(w.time)&&G.lessThanOrEq(K.ordSeconds)(w.time)(M.value0.end))return ba.customize.lyricColorActive;var Y=t.lookupLE(K.ordSeconds)(M.value0.time)(u.energy);if(Y instanceof v.Nothing)return ba.customize.lyricColor;if(Y instanceof v.Just)return Y.value0.value?ba.customize.lyricColorEnergy:ba.customize.lyricColor;throw Error("Draw.Vocal (155:16-158:84): "+
[Y.constructor.name]);}())(w)();var O=H.measureText(M.value0.lyric)(w)();H.onContext(function(Y){return N.fillText(Y)(M.value0.lyric)(da)(A)})(w)();return ua(da+O.width+5)(A)(M.value1)()}}throw Error("Draw.Vocal (141:7-145:23): "+[B.constructor.name,A.constructor.name,M.constructor.name]);}}};H.onContext(function(B){return N.setTextAlign(B)(N.AlignLeft.value)})(w)();ua(-999)(R+174)(fa(!1)(p.fromFoldable(d.foldableArray)(r.doTupleArray(function(B){return pa(B)(u.harm1)}))))();ua(-999)(R+20)(va(K.ordSeconds)(fa(!1)(p.fromFoldable(d.foldableArray)(r.doTupleArray(function(B){return pa(B)(u.harm2)}))))(fa(!0)(p.fromFoldable(d.foldableArray)(r.doTupleArray(function(B){return pa(B)(u.harm3)})))))();
la(z.monadEffect)(u.percussion)(function(B){return function(A){if(G.greaterThan(K.ordSeconds)(B)(w.time)&&w.app.settings.autoplay)return function(){H.setFillStyle(ba.customize.percussionOuter)(w)();H.fillCircle({x:q.toNumber(T(B)),y:R+90,r:11})(w)();H.setFillStyle(ba.customize.percussionInner)(w)();return H.fillCircle({x:q.toNumber(T(B)),y:R+90,r:9})(w)()};var M=(H.secToNum(D.append(K.semigroupSeconds)(B)(K.negateDuration(K.durationSeconds)(w.time)))+.1)/.05;return b.when(z.applicativeEffect)(0<M)(function(){H.setFillStyle(ba.customize.percussionHit(M))(w)();
return H.fillCircle({x:q.toNumber(T(w.time)),y:R+90,r:11})(w)()})}})();H.setFillStyle(ba.customize.vocalPhraseEnd)(w)();la(z.monadEffect)(u.phrases1)(function(B){return function(A){return H.fillRect({x:q.toNumber(T(B))-1,y:R+25,width:3,height:130})(w)}})();H.setFillStyle(ba.customize.vocalTargetLine)(w)();H.fillRect({x:Z-1,y:R+25,width:3,height:130})(w)();H.drawBadgeHorizontal(Q)(R)(180)(w)();return(R+180|0)+ba.customize.marginWidth|0}}}}}})(PS);
(function(a){function b(e){if(null===e||"object"!==typeof e||"isActiveClone"in e)return e;var k=e instanceof Date?new e.constructor:e.constructor(),d;for(d in e)Object.prototype.hasOwnProperty.call(e,d)&&(e.isActiveClone=null,k[d]=b(e[d]),delete e.isActiveClone);return k}a.onyxSong=window.onyxSong;a.onPoint=function(e){return function(){var k=!1;window.addEventListener("touchstart",function(d){k=!0;var m=d.touches[0];e({x:m.clientX,y:m.clientY})();d.stopPropagation();d.preventDefault()});window.addEventListener("click",
function(d){k||e({x:d.clientX,y:d.clientY})()})}};a.displayError=function(e){return function(){document.getElementById("the-error-message").innerHTML=e;document.getElementById("the-canvas").style.display="none"}};a.setTitle=function(e){return function(){document.title=e}};a.openMenu=function(){document.getElementById("the-side-menu").classList.add("menu-open")};a.closeMenu=function(){document.getElementById("the-side-menu").classList.remove("menu-open")};var c=null,h=null;a.fillMenu=function(e){return function(k){return function(){function d(q,
p,C){p=document.createElement(p);C&&C(p);q.appendChild(p)}h=b(k);c=b(h);var m=document.getElementById("the-side-menu");d(m,"h1",function(q){q.innerHTML=e.title});d(m,"h2",function(q){q.innerHTML=e.artist});e.author.match(/\S/)&&d(m,"h4",function(q){q.innerHTML="Author: "+e.author});d(m,"div",function(q){function p(C,t){d(q,"p",function(v){d(v,"label",function(G){d(G,"input",function(D){D.type="checkbox";D.checked=h[C];D.addEventListener("change",function(n){h[C]=n.target.checked;c=b(h)})});G.insertAdjacentHTML("beforeend",
" "+t)})})}q.className="switches";p("autoplay","Enable Bots");p("leftyFlip","Lefty Flip");p("staticVert","Static Instruments")});h.parts.forEach(function(q){d(m,"div",function(p){d(p,"h3",function(C){C.innerHTML=q.partName});d(p,"form",function(C){q.flexParts.forEach(function(t){d(C,"p",function(v){d(v,"img",function(G){G.className="instrument-icon";G.src=t.typeIconURL;G.alt=t.typeName;G.title=t.typeName});t.difficulties.forEach(function(G){d(v,"label",function(D){d(D,"input",function(n){n.type="checkbox";
n.checked=G.enabled;n.addEventListener("change",function(y){G.enabled=y.target.checked;c=b(h)})});D.insertAdjacentHTML("beforeend"," "+G.diffName)})})})})})})});d(m,"p",function(q){q.className="onyx-link";q.innerHTML='<a target="_blank" href="https://github.com/mtolly/onyxite-customs">Onyx Music Game Toolkit</a>'});m.addEventListener("click",function(q){q.stopPropagation()});m.addEventListener("touchstart",function(q){q.stopPropagation()})}}};a.readMenu=function(){return c};a.performanceNow=function(){return performance.now()}})(PS.Main=
PS.Main||{});(function(a){var b=null;a.requestAnimationFrame_=function(c){return function(h){b||(b=function(){return c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||function(e){c.setTimeout(e,1E3/60)}}());return function(){return b(h)}}}})(PS.RequestAnimationFrame=PS.RequestAnimationFrame||{});(function(a){a.window=function(){return window}})(PS["Web.HTML"]=PS["Web.HTML"]||{});(function(a){a["Web.HTML"]=a["Web.HTML"]||{};a["Web.HTML"].window=a["Web.HTML"].window})(PS);
(function(a){a.RequestAnimationFrame=a.RequestAnimationFrame||{};var b=a.RequestAnimationFrame,c=a["Web.HTML"];a.RequestAnimationFrame.requestAnimationFrame=function(h){return function(){var e=c.window();return b.requestAnimationFrame_(e)(h)()}}})(PS);
(function(a){a.Main=a.Main||{};var b=a.Main,c=a.Main,h=a.Audio,e=a["Control.Applicative"],k=a["Control.Apply"],d=a["Control.Monad.Except"],m=a["Data.Array"],q=a["Data.Boolean"],p=a["Data.Either"],C=a["Data.Eq"],t=a["Data.Function"],v=a["Data.Functor"],G=a["Data.Int"],D=a["Data.List.Types"],n=a["Data.Maybe"],y=a["Data.Ord"],K=a["Data.Semigroup"],g=a["Data.Show"],U=a["Data.Symbol"],H=a["Data.Time.Duration"],z=a["Data.Tuple"],F=a.Draw,N=a["Draw.Amplitude"],r=a["Draw.Common"],J=a["Draw.Dance"],ba=a["Draw.Drums"],
u=a["Draw.Five"],Q=a["Draw.ProKeys"],R=a["Draw.Protar"],w=a["Draw.Six"],L=a["Draw.Vocal"],T=a.Effect,Z=a["Effect.Exception"],la=a["Effect.Ref"],aa=a.Foreign,X=a["Graphics.Canvas"],pa=a.Images,ea=a.RequestAnimationFrame,I=a.Song,ma=a.Style,va=function(fa){return function(){var ua=X.getContext2D(fa)(),B=F.getWindowDims(),A=X.getCanvasDimensions(fa)();e.when(T.applicativeEffect)(C.notEq(C.eqRec()(C.eqRowCons(C.eqRowCons(C.eqRowNil)()(new U.IsSymbol(function(){return"width"}))(C.eqNumber))()(new U.IsSymbol(function(){return"height"}))(C.eqNumber)))(A)(B))(X.setCanvasDimensions(fa)(B))();
v["void"](T.functorEffect)(X.setFillStyle(ua)(ma.customize.loadingBackground))();v["void"](T.functorEffect)(X.fillRect(ua)({x:0,y:0,width:B.width,height:B.height}))();A=c.performanceNow();var M=function(ca){return function(V){return v["void"](T.functorEffect)(X.fillRect(ua)({x:ca,y:V,width:ma.customize.loadingSmallSquareSize,height:ma.customize.loadingSmallSquareSize}))}},da=ma.customize.loadingLoopTime_ms/8,O=F.numMod(A)(ma.customize.loadingLoopTime_ms),Y=B.height/2-ma.customize.loadingSmallSquareSize,
P=B.width/2-ma.customize.loadingSmallSquareSize;B=2*ma.customize.loadingSmallSquareSize;v["void"](T.functorEffect)(X.setFillStyle(ua)(ma.customize.loadingBigSquare))();v["void"](T.functorEffect)(X.fillRect(ua)({x:P,y:Y,width:B,height:B}))();v["void"](T.functorEffect)(X.setFillStyle(ua)(ma.customize.loadingSmallSquares))();return function(){if(O<da)return function(){M(P)(Y)();return M(P+ma.customize.loadingSmallSquareSize)(Y+ma.customize.loadingSmallSquareSize)()};if(O<4*da){var ca=(O-da)/(3*da)*ma.customize.loadingSmallSquareSize;
return function(){M(P+ca)(Y)();return M(P+ma.customize.loadingSmallSquareSize-ca)(Y+ma.customize.loadingSmallSquareSize)()}}if(O<5*da)return function(){M(P+ma.customize.loadingSmallSquareSize)(Y)();return M(P)(Y+ma.customize.loadingSmallSquareSize)()};if(q.otherwise)return ca=(O-5*da)/(3*da)*ma.customize.loadingSmallSquareSize,function(){M(P)(Y+ma.customize.loadingSmallSquareSize-ca)();return M(P+ma.customize.loadingSmallSquareSize)(Y+ca)()};throw Error("Main (79:7-93:54): ");}()()}};a=Z.catchException(function(fa){return k.applySecond(T.applyEffect)(c.displayError(g.show(Z.showError)(fa)))(Z.throwException(fa))})(function(){var fa=
function(){var ca=X.getCanvasElementById("the-canvas")();if(ca instanceof n.Just)return ca.value0;if(ca instanceof n.Nothing)return Z.throwException(Z.error("Canvas element not found"))();throw Error("Main (98:60-101:3): "+[ca.constructor.name]);}(),ua=X.getContext2D(fa)(),B=la["new"]([])();c.onPoint(function(ca){return la.modify_(function(V){return m.cons(ca)(V)})(B)})();var A=function(){var ca=d.runExcept(I.isForeignSong(c.onyxSong));if(ca instanceof p.Left)return Z.throwException(Z.error(aa.isUndefined(c.onyxSong)?
"No song data was found. Is there a song.js present?":g.show(D.showNonEmptyList(aa.showForeignError))(ca.value0)))();if(ca instanceof p.Right)return R.eachChordsWidth(ua)(ca.value0)();throw Error("Main (104:11-108:43): "+[ca.constructor.name]);}();c.setTitle(A.title+(" ("+(A.artist+") Onyx Web Player")))();var M=la["new"](n.Nothing.value)();pa.withImages(function(ca){return la.write(new n.Just(ca))(M)})();var da=la["new"](n.Nothing.value)();h.loadAudio(function(ca){return la.write(new n.Just(ca))(da)})();
var O={parts:v.map(v.functorArray)(function(ca){return{partName:"vocal"===ca.value0?"vocals":"global"===ca.value0?"\u2026":ca.value0,flexParts:function(){var V=m.concat([function(){if(ca.value1.five instanceof n.Nothing)return[];if(ca.value1.five instanceof n.Just)return e.pure(e.applicativeArray)({typeName:"5-Fret",typeIcon:"bass"===ca.value0?pa.image_icon_bass:"keys"===ca.value0?pa.image_icon_keys:pa.image_icon_guitar,typeVertical:!0,diffs:v.map(v.functorArray)(v.map(z.functorTuple)(u.drawFiveFast))(ca.value1.five.value0),
count:1});throw Error("Main (131:19-142:22): "+[ca.value1.five.constructor.name]);}(),function(){if(ca.value1.six instanceof n.Nothing)return[];if(ca.value1.six instanceof n.Just)return e.pure(e.applicativeArray)({typeName:"6-Fret (GHL)",typeIcon:pa.image_icon_ghl,typeVertical:!0,diffs:v.map(v.functorArray)(v.map(z.functorTuple)(w.drawSix))(ca.value1.six.value0),count:1});throw Error("Main (143:19-151:22): "+[ca.value1.six.constructor.name]);}(),t.flip(m.concatMap)(ca.value1.drums)(function(ha){var x=
function(){var ja=m.uncons(ha);if(ja instanceof n.Nothing)return I.Drums4.value;if(ja instanceof n.Just)return z.snd(ja.value0.head).mode;throw Error("Main (153:27-156:40): "+[ja.constructor.name]);}(),l={typeName:function(){if(x instanceof I.Drums4)return"Drums (4)";if(x instanceof I.Drums5)return"Drums (5)";if(x instanceof I.DrumsPro)return"Pro Drums";if(x instanceof I.DrumsReal)return"Real Drums";throw Error("Main (158:33-163:21): "+[x.constructor.name]);}(),typeIcon:x instanceof I.DrumsPro?pa.image_icon_pro_drums:
x instanceof I.DrumsReal?pa.image_icon_real_drums:pa.image_icon_drums,typeVertical:!0,diffs:v.map(v.functorArray)(v.map(z.functorTuple)(ba.drawDrums))(ha),count:1};if(x instanceof I.DrumsPro){var W=v.map(v.functorArray)(v.map(z.functorTuple)(I.drumsProTo4))(ha);W={typeName:"Drums (4)",typeIcon:pa.image_icon_drums,typeVertical:!0,diffs:v.map(v.functorArray)(v.map(z.functorTuple)(ba.drawDrums))(W),count:1};return[l,W]}return[l]}),function(){if(ca.value1.prokeys instanceof n.Nothing)return[];if(ca.value1.prokeys instanceof
n.Just)return e.pure(e.applicativeArray)({typeName:"Pro Keys",typeIcon:pa.image_icon_pro_keys,typeVertical:!0,diffs:v.map(v.functorArray)(v.map(z.functorTuple)(Q.drawProKeysFast))(ca.value1.prokeys.value0),count:1});throw Error("Main (183:19-191:22): "+[ca.value1.prokeys.constructor.name]);}(),function(){if(ca.value1.protar instanceof n.Nothing)return[];if(ca.value1.protar instanceof n.Just){var ha=e.pure(e.applicativeArray);var x="bass"===ca.value0?"Pro Bass":"Pro Guitar";var l="bass"===ca.value0?
pa.image_icon_pro_bass:pa.image_icon_pro_guitar;return ha({typeName:x,typeIcon:l,typeVertical:!0,diffs:v.map(v.functorArray)(v.map(z.functorTuple)(R.drawProtar))(ca.value1.protar.value0),count:1})}throw Error("Main (192:19-204:22): "+[ca.value1.protar.constructor.name]);}(),function(){if(ca.value1.dance instanceof n.Nothing)return[];if(ca.value1.dance instanceof n.Just)return e.pure(e.applicativeArray)({typeName:"Dance",typeIcon:pa.image_icon_dance,typeVertical:!0,diffs:v.map(v.functorArray)(v.map(z.functorTuple)(J.drawDance))(ca.value1.dance.value0),
count:1});throw Error("Main (205:19-213:22): "+[ca.value1.dance.constructor.name]);}(),function(){if(ca.value1.amplitude instanceof n.Nothing)return[];if(ca.value1.amplitude instanceof n.Just)return e.pure(e.applicativeArray)({typeName:"Amplitude",typeIcon:pa.image_icon_amplitude,typeVertical:!0,diffs:v.map(v.functorArray)(v.map(z.functorTuple)(N.drawAmplitude))(ca.value1.amplitude.value0),count:1});throw Error("Main (214:19-222:22): "+[ca.value1.amplitude.constructor.name]);}(),function(){if(ca.value1.vocal instanceof
n.Nothing)return[];if(ca.value1.vocal instanceof n.Just){var ha=e.pure(e.applicativeArray),x=I.vocalCount(ca.value1.vocal.value0);return ha({typeName:"Vocals",typeIcon:3===x?pa.image_icon_vocal_3:2===x?pa.image_icon_vocal_2:pa.image_icon_vocal_1,typeVertical:!1,diffs:v.map(v.functorArray)(v.map(z.functorTuple)(L.drawVocal))(ca.value1.vocal.value0),count:I.vocalCount(ca.value1.vocal.value0)})}throw Error("Main (223:19-234:22): "+[ca.value1.vocal.constructor.name]);}()]),S=function(ha){return function(x){var l=
function(W){return function(ja){return{enabled:W,diffName:z.fst(ja),draw:r.Drawer(z.snd(ja))}}};return{typeName:x.typeName,typeIcon:x.typeIcon,typeIconURL:pa.imageURL(x.typeIcon),typeVertical:x.typeVertical,difficulties:K.append(K.semigroupArray)(v.map(v.functorArray)(l(ha))(m.take(1)(x.diffs)))(v.map(v.functorArray)(l(!1))(m.drop(1)(x.diffs)))}}};return K.append(K.semigroupArray)(v.map(v.functorArray)(S(!0))(m.take(1)(V)))(v.map(v.functorArray)(S(!1))(m.drop(1)(V)))}()}})(A.parts),autoplay:!0,leftyFlip:!1,
staticVert:!1};c.fillMenu(A)(O)();var Y=function(ca){return function(V){var S=function(ha){return function(){var x=v.map(T.functorEffect)(H.Milliseconds)(c.performanceNow)();if(ha.time instanceof r.Paused)var l=ha.time.value0.pausedSongTime;else if(ha.time instanceof r.Playing)l=K.append(H.semigroupSeconds)(ha.time.value0.startedSongTime)(K.append(H.semigroupSeconds)(H.convertDuration(H.durationMilliseconds)(H.durationSeconds)(x))(H.negateDuration(H.durationSeconds)(ha.time.value0.startedPageTime)));
else throw Error("Main (256:27-259:105): "+[ha.time.constructor.name]);x=c.readMenu();return function(W){return function(){var ja=F.getWindowDims(),oa=G.round(ja.height);F.draw({time:l,app:W,song:A,getImage:ca,canvas:fa,context:ua,pxToSecsVert:function(Aa){return H.Seconds((Aa-ma.customize.targetPositionVert|0)/ma.customize.trackSpeed)},secsToPxVert:function(Aa){return G.round(Aa*ma.customize.trackSpeed)+ma.customize.targetPositionVert|0},pxToSecsHoriz:function(Aa){return H.Seconds((Aa-ma.customize.targetPositionHoriz|
0)/ma.customize.trackSpeed)},secsToPxHoriz:function(Aa){return G.round(Aa*ma.customize.trackSpeed)+ma.customize.targetPositionHoriz|0},minY:0,maxY:oa})();ja=la["modify'"](function(Aa){return{state:[],value:Aa}})(B)();var xa=function(Aa){return function(sa){var wa=m.uncons(Aa);if(wa instanceof n.Nothing)return ea.requestAnimationFrame(S(sa));if(wa instanceof n.Just){if(sa.menuOpen)return function(){c.closeMenu();return xa(wa.value0.tail)({menuOpen:!1,time:sa.time,settings:sa.settings})()};if(F._M<=
wa.value0.head.x&&wa.value0.head.x<=(F._M+F._B|0)){if(((oa-(2*F._M|0)|0)-(2*F._B|0)|0)<=wa.value0.head.y&&wa.value0.head.y<=((oa-(2*F._M|0)|0)-F._B|0)){if(sa.time instanceof r.Paused)return function(){var Ea=v.map(T.functorEffect)(H.Milliseconds)(c.performanceNow)();return h.playFrom(V)(l)(xa(wa.value0.tail)({menuOpen:sa.menuOpen,time:new r.Playing({startedPageTime:H.convertDuration(H.durationMilliseconds)(H.durationSeconds)(Ea),startedSongTime:l}),settings:sa.settings}))()};if(sa.time instanceof
r.Playing)return function(){h.stop(V)();return xa(wa.value0.tail)({menuOpen:sa.menuOpen,time:new r.Paused({pausedSongTime:l}),settings:sa.settings})()};throw Error("Main (288:36-304:38): "+[sa.time.constructor.name]);}if(((oa-F._M|0)-F._B|0)<=wa.value0.head.y&&wa.value0.head.y<=(oa-F._M|0))return function(){c.openMenu();return xa(wa.value0.tail)({menuOpen:!0,time:sa.time,settings:sa.settings})()};if(F._M<=wa.value0.head.y&&wa.value0.head.y<=((oa-(3*F._M|0)|0)-(2*F._B|0)|0)){var Fa=1-(wa.value0.head.y-
F._M|0)/G.toNumber((oa-(4*F._M|0)|0)-(2*F._B|0)|0),Ca=H.Seconds(Fa*A.end);if(sa.time instanceof r.Paused)return xa(wa.value0.tail)({menuOpen:sa.menuOpen,time:new r.Paused({pausedSongTime:Ca}),settings:sa.settings});if(sa.time instanceof r.Playing)return function(){var Ea=v.map(T.functorEffect)(H.Milliseconds)(c.performanceNow)();h.stop(V)();return h.playFrom(V)(Ca)(xa(wa.value0.tail)({menuOpen:sa.menuOpen,time:new r.Playing({startedPageTime:H.convertDuration(H.durationMilliseconds)(H.durationSeconds)(Ea),
startedSongTime:Ca}),settings:sa.settings}))()};throw Error("Main (313:40-328:46): "+[sa.time.constructor.name]);}}return xa(wa.value0.tail)(sa)}throw Error("Main (279:38-330:48): "+[wa.constructor.name]);}};return W.time instanceof r.Playing&&y.greaterThanOrEq(H.ordSeconds)(l)(A.end)?(h.stop(V)(),xa(ja)({menuOpen:W.menuOpen,time:new r.Paused({pausedSongTime:A.end}),settings:W.settings})()):xa(ja)(W)()}}({time:ha.time,menuOpen:ha.menuOpen,settings:x})()}};return S({settings:O,time:new r.Paused({pausedSongTime:0}),
menuOpen:!1})}},P=function(){va(fa)();var ca=la.read(M)(),V=la.read(da)();if(ca instanceof n.Just){if(V instanceof n.Just)return ea.requestAnimationFrame(Y(ca.value0)(V.value0))();if(V instanceof n.Nothing)return ea.requestAnimationFrame(P)();throw Error("Main (249:31-251:61): "+[V.constructor.name]);}if(ca instanceof n.Nothing)return ea.requestAnimationFrame(P)();throw Error("Main (248:9-252:59): "+[ca.constructor.name]);};return P()});b.drawLoading=va;b.main=a;b.onyxSong=c.onyxSong;b.onPoint=c.onPoint;
b.displayError=c.displayError;b.setTitle=c.setTitle;b.openMenu=c.openMenu;b.closeMenu=c.closeMenu;b.fillMenu=c.fillMenu;b.readMenu=c.readMenu;b.performanceNow=c.performanceNow})(PS);PS.Main.main();
