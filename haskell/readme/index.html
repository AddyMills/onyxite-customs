<!DOCTYPE html>
<html lang="en">
<head>
<title>Onyx Music Game Toolkit</title>
<style type="text/css">

body {
  background-color: #ede;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: row;
  align-items: stretch;
  max-height: 100vh;
}

nav {
  background-color: #979;
  font-family: sans-serif;
  overflow: scroll;
}

nav ul {
  padding-left: 25px;
}

nav li {
  margin: 5px;
}

nav a {
  background-color: #eee;
  color: black;
  padding: 3px;
  display: inline-block;
  border-radius: 3px;
  text-decoration: none;
}

@media screen and (max-width: 1000px) {
  nav {
    display: none;
  }
}

.readme-box {
  flex: 1;
  display: flex;
  flex-direction: row;
  justify-content: center;
  overflow: scroll;
  align-items: flex-start;
}

.readme {
  max-width: 1000px;
  margin-top: 30px;
  background-color: #434;
  color: white;
  font-family: sans-serif;
  border-top-left-radius: 10px;
  border-top-right-radius: 10px;
  padding: 15px;
  line-height: 1.5;
}

.readme h1, h2, h3 {
  text-align: center;
}

.readme h2 {
  background-color: #757;
  padding: 5px;
  border-radius: 10px;
  margin-top: 50px;
}

.readme a {
  background-color: #eee;
  color: black;
  padding: 3px;
  display: inline-block;
  border-radius: 3px;
}

.readme code {
  background-color: #222;
  padding: 5px;
  border-radius: 5px;
  display: inline-block;
  font-weight: bold;
}

.onyx-icon {
  text-align: center;
}

.onyx-icon img {
  width: 128px;
  height: 128px;
  box-shadow: 0px 0px 15px #fff;
  border-radius: 64px;
}

.gui-button {
  color: black;
  border: 1px solid black;
  padding: 3px 8px 3px 8px;
  border-radius: 5px;
  display: inline-block;
}

.gui-button-load {
  background-color: rgb(186,229,181);
}

.gui-button-task {
  background-color: rgb(179,221,187);
}

.gui-button-batch {
  background-color: rgb(237,173,193);
}

.gui-button-gray {
  background-color: rgb(192,192,192);
}

</style>
</head>
<body>

<nav class="table-of-contents">

<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#setup-instructions">Setup Instructions</a></li>
<ul>
<li><a href="#instructions-for-macos">Instructions for macOS</a></li>
</ul>
<li><a href="#supported-input-formats">Supported Input Formats</a></li>
<li><a href="#basic-usage">Basic Usage</a></li>
<ul>
<li><a href="#single-song-mode">Single Song Mode</a></li>
<li><a href="#batch-mode">Batch Mode</a></li>
</ul>
<li><a href="#game-specific-info">Game-Specific Info</a></li>
<ul>
<li><a href="#rock-band-3">Rock Band 3</a></li>
<li><a href="#rock-band-2">Rock Band 2</a></li>
<li><a href="#clone-hero-phase-shift">Clone Hero & Phase Shift</a></li>
<li><a href="#guitar-hero-guitar-hero-ii">Guitar Hero & Guitar Hero II</a></li>
<li><a href="#guitar-hero-iii">Guitar Hero III</a></li>
<li><a href="#guitar-hero-warriors-of-rock">Guitar Hero: Warriors of Rock</a></li>
</ul>
<li><a href="#preview-tools">Preview Tools</a></li>
<ul>
<li><a href="#3d-preview">3D Preview</a></li>
<li><a href="#web-preview">Web Preview</a></li>
</ul>
<li><a href="#quick-convert">Quick Convert</a></li>
<li><a href="#other-tools">Other Tools</a></li>
<ul>
<li><a href="#stars-calculator">Stars Calculator</a></li>
<li><a href="#midi-chart-functions">MIDI/.chart Functions</a></li>
<li><a href="#mogg-vgs-fsb-creator">MOGG/VGS/FSB Creator</a></li>
<li><a href="#lipsync-generation">Lipsync Generation</a></li>
<li><a href="#lipsync-dry-vocals">Lipsync Dry Vocals</a></li>
<li><a href="#milo-unpack-repack">.milo Unpack/Repack</a></li>
<li><a href="#rb3-song-cache-id-application">RB3 Song Cache ID Application</a></li>
<li><a href="#gh-song-cache-generation">GH Song Cache Generation</a></li>
</ul>
</ul>


</nav>

<div class="readme-box">
<div class="readme">

<p class="onyx-icon">
  <img src="../icon/icon.png" alt="">
</p>

<h1>Onyx Music Game Toolkit (version <em>ONYXVERSION</em>)</h1>
<p>By Michael Tolly <a href="mailto:onyxite@gmail.com" class="email">onyxite@gmail.com</a></p>
<p>Onyx is a multipurpose build tool for rhythm games, particularly ones similar to the Guitar Hero and Rock Band series. It can import and export a wide variety of formats, move parts around, change song speed, fill in missing details, and assist with song authoring.</p>
<p>Many people have contributed code, research, and more to Onyx; see CREDITS.txt.</p>
<p>New versions and source at: <a href="https://github.com/mtolly/onyxite-customs/releases" class="uri">https://github.com/mtolly/onyxite-customs/releases</a></p>
<p>Onyx is free software via the GNU General Public License v3; see LICENSE.txt or <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">https://www.gnu.org/licenses/gpl-3.0.en.html</a></p>
<p>All original non-code assets such as graphics are licensed under Creative Commons Attribution-ShareAlike: <a href="https://creativecommons.org/licenses/by-sa/4.0/">https://creativecommons.org/licenses/by-sa/4.0/</a></p>


<h2 id="requirements">Requirements</h2>
<p>Onyx is currently compiled on:</p>
<ul>
<li>Windows 10</li>
<li>macOS Monterey</li>
<li>Linux kernel 4.4 (Ubuntu 16.04)</li>
</ul>
<p>It may work on previous versions (such as Windows 7) but this is not certain.</p>
<p>By default, an embedded copy of Magma v2 is used to generate RB3 or RB2 files. This requires the Visual C++ runtime, and if on Mac or Linux, Wine.</p>
<ul>
<li><p>On Mac, you can use the official installer, or you can use Homebrew (<code>brew install wine</code>).</p>
<p>However, macOS Catalina (10.15) does not support running Magma in Wine due to its lack of support for 32-bit programs. To produce Rock Band files on this OS you’ll need to turn Magma compilation off.</p></li>
<li><p>To bypass Magma compilation, go to <code>Edit &gt; Preferences</code> in the top menu, and change the Magma selection to an option other than “Magma required”. Please make sure and test any resulting files! If you’re on Windows I recommend leaving it on “Magma optional”, so you can see any error messages; they’ll be converted to warnings and you’ll still get the resulting song file.</p></li>
<li><p>Wine is also required to produce Guitar Hero: Warriors of Rock files on Mac and Linux at the moment, due to the audio encoding process. This may be fixed in the future.</p></li>
</ul>
<p>The Linux build is produced via an Ubuntu 16.04 Docker container, and should work on most any modern distribution. Older distributions might require additional installations:</p>
<ul>
<li>On CentOS 7, <code>yum install mesa-libGL fontconfig</code> is required.</li>
</ul>


<h2 id="setup-instructions">Setup Instructions</h2>
<ul>
<li><p>On Windows, run the installer, then run <code>onyx.exe</code> (or the installed shortcut). Windows may label the program as untrustworthy due to not being signed/verified; hopefully there is a way to work around this.</p></li>
<li><p>On Mac, see instructions below.</p></li>
<li><p>On Linux, make the <code>.AppImage</code> executable, place it wherever you like, and run it. Your system may also offer to install desktop integration.</p></li>
</ul>
<h3 id="instructions-for-macos">Instructions for macOS</h3>
<p>Follow these instructions to allow Onyx to run correctly on macOS.</p>
<ol type="1">
<li><p>Extract the contents of the zip file, and move the Onyx app to the Applications folder, or wherever else you want to keep it.</p></li>
<li><p>Run the following command in Terminal (replace the location if you moved it somewhere other than Applications)</p>
<pre><code>xattr -r -d com.apple.quarantine /Applications/Onyx.app</code></pre></li>
<li><p>The app should now run, but may have problems loading files due to permissions errors. To fix this, take a song file that is in a location such as your Downloads folder, and drag and drop it onto the “Load a song” button. This seems to tell macOS to give the app normal permissions to your user folders, so after that you should then also be able to use the open file dialog and batch mode to load songs.</p></li>
</ol>


<h2 id="supported-input-formats">Supported Input Formats</h2>
<p>Onyx can import the following song formats:</p>
<ul>
<li><p>Rock Band (1, 2, 3, Beatles) Xbox 360 STFS (CON or LIVE) files</p>
<ul>
<li>Both single-song files and packs are supported.</li>
</ul></li>
<li><p>Rock Band (1, 2, 3, Beatles) PlayStation 3 .pkg files</p>
<ul>
<li>Official DLC whose .mid.edat are encrypted with RAP files are supported. Copy RAP files to <code>onyx-resources/raps/CONTENTID.RAP</code>.</li>
</ul></li>
<li><p>Rock Band (1, 2, 3, Beatles) .ARK files for Xbox 360, PlayStation 3, and PlayStation 2</p>
<ul>
<li>Import from <code>MAIN.HDR</code>, <code>main_xbox.hdr</code>, or <code>main_ps3.hdr</code>.</li>
<li>Xbox 360 and PS2 <code>.iso</code> files can also be imported directly. If extracting a PS2 disc yourself, use something like Apache3 to get the 2nd layer of the dual layer discs, as most programs do not support this.</li>
</ul></li>
<li><p>Rock Band 4 PlayStation 4 extracted files (tentative support, may not work for everything)</p></li>
<li><p>Magma (v1 or v2) RBA files</p></li>
<li><p>Frets on Fire / Phase Shift / Clone Hero formats</p>
<ul>
<li>Both <code>notes.mid</code> and <code>notes.chart</code> are supported.</li>
<li>Ogg Vorbis, MP3, Opus, and WAV audio are supported.</li>
<li><code>song.ini</code> can be absent if using <code>notes.chart</code>.</li>
<li>Audio files must be named according to PS/CH conventions.</li>
</ul></li>
<li><p>Magma (v1 or v2) projects (.rbproj)</p></li>
<li><p>Guitar Hero, Guitar Hero II, or Guitar Hero Encore: Rocks the 80s (PS2)</p>
<ul>
<li>Import directly from the <code>.iso</code>, or extract and import from <code>MAIN.HDR</code>.</li>
<li>The hidden songs Trippolette and Graveyard Shift can be imported from GH1.</li>
</ul></li>
<li><p>Guitar Hero II (Xbox 360) DLC (LIVE files)</p></li>
<li><p>Guitar Hero III disc (Xbox 360, PS2) and DLC (Xbox 360, PS3), Guitar Hero: Aerosmith disc (Xbox 360)</p>
<ul>
<li>Both Xbox 360 and PS2 discs can be imported directly from <code>.iso</code>, or from <code>default.xex</code> (360) or <code>DATAP.HED</code> (PS2).</li>
</ul></li>
<li><p>Guitar Hero 5 and Guitar Hero: Warriors of Rock DLC (Xbox 360 LIVE files or PlayStation 3 .pkg files)</p></li>
<li><p>DTXMania (DrumMania / GuitarFreaks) simfiles (.dtx/.gda)</p>
<ul>
<li>XG features (5-fret guitar/bass, extra drum pads) are supported.</li>
<li>Drums are translated to Pro Drums as well as Phase Shift Real Drums. (Real Drums display in the web player but aren’t yet in PS output.)</li>
<li>Keysounded audio is rendered to stem files.</li>
<li>Currently only each instrument’s highest difficulty from a <code>set.def</code> is imported as Expert, and difficulties below this are autogenerated. To import a specific difficulty directly, import its <code>.dtx</code> file.</li>
</ul></li>
<li><p>Power Gig: Rise of the SixString (Xbox 360, PS3)</p>
<ul>
<li>Import disc data from the Xbox 360 <code>.iso</code>, or <code>Data.hdr.e.2</code>.</li>
<li>Xbox 360 DLC is also supported.</li>
</ul></li>
<li><p>Rock Revolution (Xbox 360)</p>
<ul>
<li>Import disc data from the <code>.iso</code> or <code>default.xex</code>.</li>
<li>Xbox 360 DLC is also supported.</li>
</ul></li>
<li><p>Freetar <code>.sng</code> files</p>
<ul>
<li>Not extensively tested, some songs may not work.</li>
</ul></li>
</ul>



<h2 id="basic-usage">Basic Usage</h2>
<p>Onyx's core function is to &ldquo;import&rdquo; from one song format, and then &ldquo;export&rdquo; to another one. There are two methods you can use to do this:</p>
<ul>
  <li>Load a <em>single song</em> into an editor window, and export it to a new file, with full control of metadata and instrument assignment</li>
  <li><em>Batch process</em>, where you can queue up a list of songs, and perform a similar import + export process on all of them</li>
</ul>

<h3 id="single-song-mode">Single Song Mode</h3>
<p>To load a single song, click <span class="gui-button gui-button-load">Load a song</span> on the main console window, and select a file from the dialog box.</p>
<p>(screenshot here)</p>
<p>Note that folder-based formats may require particular files to be selected; for example, Clone Hero / Phase Shift songs can be imported by selecting the <code>song.ini</code> file, or <code>notes.chart</code> if there is no <code>song.ini</code>.</p>
<p>But, you can also simply <em>drag and drop</em> any file or folder onto the <span class="gui-button gui-button-load">Load a song</span> button. If given a folder, this will scan the contents for any recognized songs. If more than one song is found, a window will pop up letting you select which songs you want to import.</p>
<p>(screenshot here)</p>
<p>Once a song is open, you can make changes to metadata and instrument settings.</p>
<ul>
<li><p>The <em>Metadata</em> tab displays loaded metadata from the source song. You can edit data here to have it reflected in any converted output.</p></li>
<li><p>The <em>Instruments</em> tab shows all the gameplay modes Onyx found in the song. Modes are sorted first by logical instrument, and then the specific controllers that instrument supports.</p>
<p>Deselecting an instrument mode checkbox will hide it from any output files.</p>
<p>In addition to difficulty selections, some controller modes have other specific options, such as drum freestyle sounds, vocalist gender, etc.</p></li>
</ul>
<p>Then, use one of the target game tabs to start a conversion. Each tab has options specific to that game, as well as "slots" that correspond to the instruments supported by that game. For example, Rock Band 2 has four slots, for guitar, bass, drums, and vocals:</p>
<p>(screenshot here)</p>
<p>Depending on what instruments were present in the file you imported, you can reassign them to different slots in the new file you create. The selection from each dropdown refers to an instrument from the original imported file, which will be assigned to that slot when converting.</p>
<p>Finally, use one of the <span class="gui-button gui-button-task">Create &hellip;</span> buttons to start a conversion. Most game targets support a few different output formats. Most of these will ask you where to save a new file or folder; an exception is Guitar Hero 1 and 2, which have <span class="gui-button gui-button-task">Add to PS2 ARK as Bonus Song</span>. This will ask you for the location of a <code>MAIN.HDR</code> file, and then <code>MAIN.HDR</code> and <code>MAIN.ARK</code> will be directly modified with the new song files.</p>

<h3 id="batch-mode">Batch Mode</h3>
<p>To run a batch conversion, first click <span class="gui-button gui-button-batch">Batch process</span> on the main console window. Then in the new window, select <span class="gui-button gui-button-gray">Add Song</span>, and select a file from the dialog box. Or, just <em>drag and drop</em> files or folders into the empty panel.</p>
<p>(screenshot here)</p>
<p>Individual songs can be deleted by selecting a song and pressing the Delete key. They can also be moved up/down in the list with <code>Ctrl + Up</code> and <code>Ctrl + Down</code> (or <code>Command + Up</code> and <code>Command + Down</code> on Mac).</p>
<p>At the bottom of the panel are toggles for whether specific instruments should be imported. These can be helpful if unwanted instrument parts are causing compilation errors.</p>
<p>Then, switch to a target game tab. Some game-specific options are available, followed by <span class="gui-button gui-button-task">Create &hellip;</span> buttons. Each button has an associated <em>Template</em> box, which determines how newly created files and folders will be named. You can hover over one of these to see a list of supported <code>%templates%</code>. The folder button to the right allows you to select a folder, which will overwrite the folder part of the current template (so all created files will be in that folder). The farthest right button will reset the template to its default value.</p>
<p>(screenshot here)</p>


<h2 id="game-specific-info">Game-Specific Info</h2>

<h3 id="rock-band-3">Rock Band 3</h3>
<p>Supports creating a CON (Xbox 360), PKG (PS3), or Magma v2 project.</p>
<ul>
<li><p>By default, tempos are modified to attempt to stay within Magma's range of legal tempos, which is 40 to 300 beats per minute. This may produce odd results sometimes, and is more restrictive than what appears to work in the games. This behavior can be disabled in Preferences.</p></li>
<li><p>Overdrive phrases must follow various rules; they may be modified if they produce invalid unison phrases, have no notes under them on any difficulty, or have no notes between two adjacent phrases on any difficulty.</p></li>
<li><p>If the “automatic tom markers” option is turned on, an FoF song that doesn’t have any tom markers and that does not have <code>pro_drums = True</code> in the song.ini will have tom markers added over the whole drum part, under the assumption that Pro Drums have not been authored for the chart.</p></li>
<li><p>Open notes from a PS or CH song will be translated to green notes. Sequences of notes adjacent to open notes will be moved up one fret if necessary to preserve motion.</p></li>
<li><p>The song speed can be modified to produce sped up or slowed down songs. This will modify both the audio and MIDI, and add <code>(X% Speed)</code> to the title. For CON inputs this only works with unencrypted MOGG files. Different speed versions may not pass Magma in all cases, if certain events become too close together or too far apart. If this happens, you can produce a Magma project and make any needed changes, then give the project back to Onyx to compile.</p></li>
<li><p>In batch mode, a few settings are available for moving/copying Guitar/Bass/Keys parts, as well as converting drums parts into guitar for an interesting challenge. When moving Keys parts to Guitar/Bass, force notes will be applied so charts keep their correct strum/HOPO notes according to the RB3 keytar algorithm. Note that in some cases (when the input and output both use MOGG audio) the output may assign multiple instruments to the same audio channel indexes, which works in game but will cut out the audio if either player misses.</p></li>
<li><p>By default, an input format like Phase Shift that can contain both 1x and 2x Bass Pedal drums charts will generate two separate songs. If you are interested in only 1x or only 2x, select the appropriate Bass Pedal option. Songs that are detected as 2x Bass Pedal versions can also produce an automatic 1x version, using an algorithm to remove certain kick notes.</p></li>
<li><p>When creating a Magma project, a REAPER project will also be generated so any remaining problems can be quickly edited and re-exported to MIDI. This avoids a few bugs in REAPER’s own MIDI import function. It also applies most of the C3 template to the MIDI tracks, so you get note names, colored tracks, and RBN preview windows. Because this must generate WAV audio files to give to Magma, encrypted MOGG files in input rb3cons are unsupported.</p></li>
<ul>
<li><p>Tip: to process a song with a C3-encrypted MOGG, one option is to use the Phase Shift converter in C3 CON Tools which mixes the audio down to a single file, and then just supply the Phase Shift song to Onyx.</p></li>
</ul>
</ul>

<h3 id="rock-band-2">Rock Band 2</h3>
<p>Supports creating a CON (Xbox 360) or PKG (PS3). Most options are similar to Rock Band 3.</p>
<ul>
<li><p>Songs will attempt to be validated through Magma v1, but this is not required to succeed.</p></li>
<li><p>Overdrive rules are more restrictive than Rock Band 3; if guitar/bass/drums are all present, unison phrases must include all three of them. 2-instrument unisons will be dropped on one of their instruments.</p></li>
<li><p>RB3-format <code>VENUE</code> tracks are converted to RB2 format. Note that due to how RB2 compilation is currently implemented, a source file with an existing RB2-format venue track may not be preserved correctly; this will be fixed in a future release.</p></li>
<li><p>Due to Magma v1's requirements for lower difficulties, they may be modified to use all frets present on higher difficulties.</p></li>
</ul>

<h3 id="clone-hero-phase-shift">Clone Hero & Phase Shift</h3>
<p>Generates a song folder (or zip file containing one) in the descended <em>Frets on Fire</em> format (<code>song.ini</code>, <code>notes.mid</code>, Ogg Vorbis audio). These should more-or-less work in the latest version of Clone Hero, the latest free version of Phase Shift, and the Steam version of Phase Shift. Songs may also work in Frets on Fire X, but this is not tested.</p>
<p>Due to how the conversion is implemented, some non-RB features such as Dance mode, Real Drums, and Real Keys may not survive a PS-to-PS conversion. However other 5-fret charts such as <code>PART RHYTHM</code>, as well as Clone Hero 6-fret tracks, should remain.</p>

<h3 id="guitar-hero-guitar-hero-ii">Guitar Hero & Guitar Hero II</h3>
<p>Supports a few different formats for the Harmonix GH games on PS2 and Xbox 360:</p>
<ul>
<li><p>Add a new bonus song to a PS2 GH1/GH2/GH80s ARK file. GH2 360 ARKs are not supported yet.</p></li>
<li><p>Create a folder of files ready to add manually to an ARK. This is also PS2-only currently.</p></li>
<li><p>Create a DLC LIVE file for GH2 for Xbox 360. This requires a jailbroken (RGH or JTAG) console to load.</p>
<p>NOTE: GH2 in some configurations appears to have a limit of 16 individual DLC package files. Trying to load more than 16 can not only fail to load the ones past 16, but the game may corrupt your save data when saving. To avoid this, please use the “Make a pack (360)” tool in the Quick Convert window to combine songs before playing.</p></li>
</ul>
<p>PS2 songs have been tested with standard GH1/GH2, as well as Guitar Hero II Deluxe. Several extra features are also supported for Guitar Hero II Deluxe:</p>
<ul>
  <li>Drum charts</li>
  <li>Extra metadata used by the upgraded song list</li>
  <li>Solo markers</li>
</ul>
<p>For PS2 GH2 output, practice mode audio generation can be toggled on/off. Disabling it saves some space, and a significant amount of conversion time. If disabled, practice mode will still work, just with no audio. If enabled, songs with no instrument stems will use the full track as their practice audio.</p>
<p>In batch mode, lead and coop parts are assigned automatically based on what parts are present.</p>
<ul>
<li>Lead will be assigned to the first of [guitar, rhythm, keys, bass]</li>
<li>Coop will be assigned to the first of [rhythm, bass, keys] which is not already used for Lead</li>
</ul>
<p>To customize part assignment, use the “Load a song” mode.</p>

<h3 id="guitar-hero-iii">Guitar Hero III</h3>
<p>Creates custom DLC files for Guitar Hero III, for use on a jailbroken Xbox 360 (RGH or JTAG) or PlayStation 3.</p>
<ul>
<li><p>Supports lead + rhythm/bass charts, automatic HOPO forcing, star power, face off sections, practice sections, and basic drum animations (translated from Rock Band drum animation notes, or generated from a drum chart).</p></li>
<li><p>After creating DLC files, you <em>must</em> take all your custom songs, plus any official DLC you want to load, and create a “Song Cache” from them. See the Other Tools section for information. This is required to load your songs!</p></li>
<li><p>Normally GH3 will end a song shortly after the last playable note, which would often be too soon. However it seems the game checks both lead and rhythm tracks on your current difficulty to find the last note, so as a hack for now, a dummy note is added to each difficulty on the rhythm/bass track to extend the song length.</p></li>
<li><p>Generated charts use MP3 audio, even on Xbox 360 where official content uses the native XMA format. MP3 is much faster/easier to generate and does not waste significant space in GH3 (unlike later GH games).</p></li>
<li><p>On stock GH3, it is possible to load roughly 70-80 songs in the Download setlist, though this number can decrease as you add scores to songs.</p></li>
<li><p><strong>IMPORTANT</strong>: While testing loading setlists of custom songs on the Xbox 360 version, it has been observed that the save data can get into a state where it will no longer save, possibly due to a conflict with attempting to save the high scores for customs. This does not appear to be a permanent issue, as removing the custom songs should allow saving again. But, it is still recommended that you back up any save data you care about before loading any custom songs.</p></li>
</ul>

<h3 id="guitar-hero-warriors-of-rock">Guitar Hero: Warriors of Rock</h3>
<p>Creates DLC files for Guitar Hero: Warriors of Rock, for use on a jailbroken Xbox 360 (RGH or JTAG) or PlayStation 3.</p>
<ul>
<li><p>There appears to be a limit of slightly over 700 songs’ metadata in one file; any more causes a crash on game launch.</p>
<p><strong>IMPORTANT</strong>: In addition, it may be possible to corrupt a save somewhat by loading too many new songs over multiple sessions. When this happens, loading any more new songs will crash the game. So, it is recommended you back up any save data you care about before loading custom songs, in case this happens, until the issue can be researched in more detail.</p></li>
<li><p>After creating DLC files, you <em>must</em> take all your custom songs, plus any official WoR DLC you want to load (pre-WoR DLC is not required to be included), and create a “Song Cache” from them. See the Other Tools section for information. This is required to load your songs!</p></li>
<li><p>Guitar and bass support some of the Clone Hero feature set, with caveats.</p>
<ul>
<li>Extended sustains can only move upward (hold a lower note and play higher notes). Ones that move downward will be trimmed back.</li>
<li>Tap notes only support single fretted notes, for compatibility with the <em>Guitar Hero: World Tour</em> slider control. Open notes and chords will become HOPOs.</li>
<li>Open notes work on both guitar and bass, but HOPO open notes only work on bass. On guitar, they will become strums.</li>
</ul></li>
<li><p>Drums can be created from 4-lane, 5-lane, Pro Drums, or Real Drums inputs.</p>
<ul>
<li>Pro/Real can be converted to 5-lane, or simply copied as 4-lane. Select the appropriate option on the WoR conversion tabs.</li>
<li>Pro to 5-lane conversion works as follows:
<ul>
<li>Yellow cymbal becomes yellow</li>
<li>Green cymbal becomes orange</li>
<li>Blue cymbal becomes orange, or yellow if there’s already an orange</li>
<li>Toms work the same, targeting blue and green</li>
</ul></li>
<li>Drum sustains are not supported yet. In the future, these should be generated from Rock Band style drum lanes.</li>
<li>Freestyle sections during chart gaps are not added yet due to some technical difficulties.</li>
<li>Velocity (accent and ghost) is supported if the Clone Hero dynamics event is present, and 2x Bass Pedal charts are translated to Expert+. Ghost notes are only present in Expert+; in the future, an option may be added to instead discard ghost information and include those notes on Expert as well.</li>
</ul></li>
<li><p>Vocals work basically the same as Rock Band, translating phrases, talkies, and slides. Phrases are encoded in a slightly different way; longer stretches of empty space are broken up into multiple empty phrases, and short gaps between phrases are appended to the following phrase.</p></li>
<li><p>Band animations and lighting/camera are not controlled yet, so a generic camera cut rotation is used, and the drummer and singer do not have animations.</p></li>
<li><p>In batch mode, guitar and bass will be selected automatically from the available tracks. If there is no suitable track for bass, guitar will be copied to bass due to the lack of open pulloff support on guitar.</p></li>
<li><p>Stems are not yet supported; all audio goes to the backing track. This will be fixed in a future release.</p>
<p>Currently, MP3 audio is used on both Xbox 360 and PS3. Official content (and previous Onyx output) for Xbox 360 used its own XMA format, which has some advantages, but is more difficult to generate without Microsoft tools.</p>
<p>The stemless audio may behave oddly in multiplayer. It appears the backing track is moved towards the center (mono), while the instrument tracks are positioned in space to match their highway position. More research is needed into whether this behavior can be disabled.</p></li>
<li><p>Song titles and artists may sometimes get a prefix added in front; this is to prevent a game crash when sorting by title or artist caused by non-ASCII characters (even those that are supported by the game fonts).</p></li>
</ul>


<h2 id="preview-tools">Preview Tools</h2>
<h3 id="3d-preview">3D Preview</h3>
<p>(screenshot here)</p>
<p>The <em>Preview</em> tab of a single-song window lets you view and listen to supported gameplay tracks in a full 3D graphical display. Currently 5-fret guitar/bass/keys (including tap/open notes) and 4-lane drums (including cymbals) are supported, with more to come. Background images and videos from certain input formats are also supported.</p>
<p>You can configure MSAA and FXAA antialiasing in <code>Edit &gt; Preferences</code>.</p>
<p>Gem models and textures created by Inventor211. Most textures, models, and shaders are customizable, inside the <code>onyx-resources</code> folder.</p>
<ul>
<li>Windows: <code>C:\Program Files\OnyxToolkit\onyx-resources</code> or wherever you installed it</li>
<li>Mac: View contents of <code>Onyx.app</code>, then <code>Contents/MacOS/onyx-resources</code></li>
<li>Linux: Extract <code>.AppImage</code>, then <code>usr/bin/onyx-resources</code></li>
</ul>
<p>The file <code>3d-config.yml</code> contains settings you may also want to edit.</p>
<h3 id="web-preview">Web Preview</h3>
<p>(screenshot here)</p>
<p>This is an older preview method which generates a JavaScript (Canvas) chart preview app for web browsers. The resulting webpage can play the audio and display tracks in 2D “Beatmania” style.</p>
<p>Supports all Rock Band 3 instrument tracks, including Pro Guitar/Bass/Keys, as well as Clone Hero’s 6-fret (GHL) mode, 5-lane Drums, and PS Real Drums.</p>
<p>A player folder will appear next to each song; open <code>index.html</code> to run. It can be run locally via <code>file://</code>, or hosted on a web server.</p>
<p>Colors used for drawing the display can be tweaked by editing the file <code>customize.js</code>. Images can be edited in the <code>images</code> folder, but many sizes are currently hardcoded, so only limited changes are possible.</p>


<h2 id="quick-convert">Quick Convert</h2>
<p>(screenshot here)</p>
<p>Quick Convert is an alternate tool that can perform several different kinds of processing/conversion on existing Rock Band format songs, without doing the normal import + export process. Some things it can do:</p>
<ul>
<li>Convert between Xbox 360 and PS3 formats, as well as to Dolphin/Wii</li>
<li>Encrypt or decrypt <code>.mid.edat</code> files in PS3 format</li>
<li>Combine songs into packs</li>
<li>Extract individual songs from packs</li>
<li>Various MIDI transformations useful for gameplay or preview recording:
<ul>
<li>Replace <code>VENUE</code> track with a mostly blacked-out background</li>
<li>Remove overdrive, trill/tremolo lanes, drum activation fills</li>
<li>Remove the Mustang version of Pro Guitar/Bass tracks, ensuring the Squier version will always be played</li>
<li>Unmute muted Pro Guitar/Bass notes over fret 22, which allows you to include such notes when compiling under Magma, and then unmute for recording a preview video</li>
</ul></li>
</ul>
<p>The following formats are supported as inputs:</p>
<ul>
<li>Xbox 360 STFS (CON or LIVE)</li>
<li>PS3 .pkg</li>
<li>Extracted contents of 360 or PS3 format songs</li>
<li>Magma (v1 or v2) RBA</li>
</ul>
<p>And these are supported as outputs (depending on mode selection):</p>
<ul>
<li>Xbox 360 STFS (CON or LIVE)</li>
<li>PS3 .pkg</li>
<li>Dolphin/Wii .app files</li>
</ul>
<p>Drag supported input files in, and they should show up if songs are properly recognized. Then select an output mode, MIDI/milo transformation settings on the right-hand side, and use the output controls to begin processing.</p>
<p>Other tabs under the Quick Convert window:</p>
<ul>
<li><p><em>GH2 Pack Creator</em></p>
<p>Combines Guitar Hero II (360) CON/LIVE files into packages containing multiple songs. (This also works with Rock Band songs, but Quick Convert is now recommended to make Rock Band packs.)</p>
<p>For GH2 (at least in some configurations), packs are required due to a limit of 16 total package files.</p>
<p>To use, drag in the existing files to be combined, give the package a name to identify it, and click the appropriate button below. GH2 requires LIVE-format packages.</p>
<p>All files from the inputs are combined into one tree for the package. If more than one input contains the same file:</p>
<ul>
<li>If the file ends in <code>.dta</code>, the contents are combined into one file.</li>
<li>If the file is <code>spa.bin</code> (seen in GH2 360 files), it is ignored.</li>
<li>Otherwise, the pack will fail to create.</li>
</ul>
<p>The game information (name, title ID, thumbnail) are taken from the first input package in the list.</p></li>
<li><p><em>Direct CON-&gt;PKG</em></p>
<p>This is an older method of converting Xbox 360 (CON/LIVE) files directly to PS3 .pkg files. This can usually be done by the main Quick Convert window with more options; this tool is preserved because it can also work on things that are not valid standalone songs, such as Pro Guitar/Bass upgrades.</p></li>
</ul>


<h2 id="other-tools">Other Tools</h2>

<h3 id="stars-calculator">Stars Calculator</h3>
<p>The <em>Stars</em> tab on a single-song-view contains score cutoff calculators for Rock Band 3, Guitar Hero (1), and Guitar Hero 2 / 80s, with more games planned to come. Select the tracks you want to include, and star cutoffs will be computed.</p>

<h3 id="midi-chart-functions">MIDI/.chart Functions</h3>
<ul>
<li><p>Fill in automatic lower difficulties</p>
<p>Generates CAT-like automatic reductions for empty difficulties in a MIDI. Quality is not guaranteed, but they should pass Magma.</p>
<p>To use, ensure that there are no notes or events authored for a difficulty you want to be filled in. (For Pro Keys, remove the <code>PART REAL_KEYS_?</code> track entirely.)</p>
<p>If a drum track with no animations is present, drum animations will also be generated. These are of somewhat higher quality than the ones Magma can generate, as they will always handle tom markers correctly, and have more of a preference for double strokes rather than crossing hands.</p></li>
<li><p>Find hanging Pro Keys notes</p>
<p>Looks for cases in a Pro Keys track where a range shift occurs less than 1 second before a note that is not visible in the previous range.</p></li>
<li><p>Make Reaper project with RB template</p>
<p>Imports a MIDI file into a REAPER project. It avoids a few bugs in REAPER’s own MIDI import function, and applies track names and note colors similar to the RBN or C3 project templates.</p></li>
<li><p>.chart to MIDI conversion</p>
<p>Converts a .chart file to a corresponding MIDI with as little changes as possible. Almost all supported data should be preserved; one exception is open note extended "sustains", which will be trimmed due to the limits of the Phase Shift open note format.</p></li>
</ul>

<h3 id="mogg-vgs-fsb-creator">MOGG/VGS/FSB Creator</h3>
<p>Generates an unencrypted game audio file from a set of input audio files. Created MOGG files should work on Rock Band games, Guitar Hero II for Xbox 360, and newer games such as Audica, with a proper seek header. Created VGS files should work on the PS2 games GH1, GH2, and GH80s; I have not tested with PS2 Rock Band games.</p>
<p>The channels of all the input files, which can be WAV, OGG, MP3, or FLAC, will be merged into one multichannel file. As with the batch load screen, you can select a song row, and press Delete to remove it, Ctrl+Up to move it up in the list, or Ctrl+Down to move it down.</p>
<p>VGS files can be created with inputs of differing sample rates, but it is recommended that all your rates be multiples of a large common factor so that channels are interleaved in a regular pattern. MOGG files must have the same sample rate among all input files.</p>
<p>As a special case, if you provide a single OGG file and convert to MOGG, it will not be reencoded, but will go straight into the MOGG.</p>
<p>FSB3 files are used in Guitar Hero III and Rock Revolution, while FSB4 files are used in Guitar Hero World Tour and later games. Note that Guitar Hero FSB files also need to be encrypted in game-specific ways. FSB3 files have multiple stereo streams which are stored as separate files, while FSB4 merges all channels together into one multitrack stream.</p>

<h3 id="lipsync-generation">Lipsync Generation</h3>
<p>Use simple phonetic analysis to convert from a vocals chart to a lipsync file. Uses a dictionary to look up English lyrics, or spelling-based rules for German or Spanish lyrics. English supports these phonetic features at the moment:</p>
<ul>
<li>RB3: simple vowels, vowel diphthongs, consonants</li>
<li>TBRB: simple vowels, vowel diphthongs</li>
<li>GH2: simple vowels</li>
</ul>
<p>Supports generating <code>.voc</code> files (used in GH2), as well as <code>.milo_*</code> files for later RB games.</p>
<p>There is also a MIDI track format for encoding lipsync information, which lets you make manual edits before converting the rest of the way to the animation files. The workflow is as follows:</p>
<ol type="1">
<li><p>Turn vocal tracks into LIPSYNC* tracks for either RB3 or TBRB.</p></li>
<li><p>Edit the text events to modify the animations. The meaning of text events is as follows:</p>
<ul>
<li><p><code>[viseme_name N]</code> moves linearly from weight N to this viseme’s next event</p></li>
<li><p><code>[viseme_name N hold]</code> continues weight N until this viseme’s next event</p></li>
<li><p><code>[viseme_name N ease]</code> moves from weight N to this viseme’s next event, using an “easeInExpo” transition function</p></li>
</ul></li>
<li><p>For TBRB, rename the tracks from LIPSYNC1, LIPSYNC2, etc. to one of LIPSYNC_JOHN, LIPSYNC_PAUL, LIPSYNC_GEORGE, or LIPSYNC_RINGO.</p></li>
<li><p>Make or update a .milo_* file, and it will use the LIPSYNC tracks as input.</p></li>
</ol>

<h3 id="lipsync-dry-vocals">Lipsync Dry Vocals</h3>
<p>Two options for generating audio files to give to Magma’s vocal animation generator.</p>
<ul>
<li><p>Sine wave dryvox: the pitches from the vocal track become simple pitch tones. This is used by Onyx for Magma v1 (RB2) which is picky about matching the charted vocal pitches to the dry vocal file, and can error if it thinks they do not match.</p>
<p>Currently slides are not yet supported.</p></li>
<li><p>Clipped dryvox: an input audio file, either a mixed song file or an isolated vocal file, is clipped so audio is only present during the vocal notes. This is used by Onyx when exporting Magma v2 projects.</p></li>
</ul>

<h3 id="milo-unpack-repack"><code>.milo</code> Unpack/Repack</h3>
<p>Allows editing files inside the <code>.milo</code> archive format seen in more recent RB song files, which can contain lipsync, venue information (RB3 onward), and tweaks to character animation + vocal assignment.</p>
<p>Only the <code>ObjectDir</code> format (used in song files) is supported; other milos found on game discs will likely not work.</p>

<h3 id="rb3-song-cache-id-application">RB3 Song Cache ID Application</h3>
<p>When a Rock Band custom song contains a symbol rather than a number in the <code>song_id</code> field, a random number is generated by the game, and saved in the song cache file. This ID is used for associating songs with scores. If you regenerate the song cache file, new IDs will be assigned, and the scores will be disconnected.</p>
<p>This tool allows you to hardcode the random IDs back into the song files, replacing the symbol IDs that they originally had. Then, even if the song cache is regenerated from scratch, all scores will still be associated with their songs.</p>

<h3 id="gh-song-cache-generation">GH Song Cache Generation</h3>
<p>This is a required step to load more than one custom song into Neversoft Guitar Hero games. The games load song metadata by finding the highest ID DLC package, and getting all metadata from that. Neversoft used this to avoid a lengthy song scan process that some of the Rock Band games had, by including all previous DLC information in each new DLC package that was released.</p>
<p>So, to load customs, we create a “cache” file which is just a DLC package containing only metadata and no songs. This cache package will have a higher ID than any custom or DLC (the cache ID is set to 2 billion, and customs will be between 1 and 2 billion). You must provide all custom songs as well as any official DLC (for WoR, including GH5 DLC is not necessary). Then, simply place this cache package next to your DLC on your storage device.</p>
<p>You can also use previous cache files as an input to create new ones, so you don’t have to keep around already-processed customs on your computer.</p>
<p>To create a cache using official DLC for PlayStation 3, you’ll need to place the appropriate <code>.RAP</code> files in the <code>onyx-resources/raps</code> folder so the contents can be decrypted.</p>

</div>
</div>

</body>
</html>
